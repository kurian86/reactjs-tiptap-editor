"use strict";var Er=Object.defineProperty;var Rr=(e,r,i)=>r in e?Er(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i;var Ee=(e,r,i)=>Rr(e,typeof r!="symbol"?r+"":r,i);const t=require("react/jsx-runtime"),a=require("react"),R=require("./tiptap-hKw8I_IX.cjs"),S=require("./index--SObEjL1.cjs"),Pr=require("@radix-ui/react-separator"),_=require("./vendor-CYVo2bGp.cjs"),zr=require("@radix-ui/react-toast"),j=require("lucide-react"),_r=require("@radix-ui/react-tooltip"),W=require("easydrawer"),Wt=require("@radix-ui/react-slot"),Hr=require("@radix-ui/react-toggle"),Re=require("@radix-ui/react-icons"),Or=require("@radix-ui/react-dialog"),Dr=require("@radix-ui/react-popover"),Br=require("@radix-ui/react-label"),$r=require("re-resizable"),lt=require("katex"),Ve=require("mermaid"),qt=require("tippy.js"),Vr=require("react-colorful"),Fr=require("@radix-ui/react-switch"),Wr=require("@radix-ui/react-tabs"),qr=require("react-image-crop"),Gr=require("@radix-ui/react-checkbox"),Ur=require("@radix-ui/react-dropdown-menu");function Q(e){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const i in e)if(i!=="default"){const n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:()=>e[i]})}}return r.default=e,Object.freeze(r)}const V=Q(a),Gt=Q(Pr),K=Q(zr),Me=Q(_r),Ut=Q(Hr),J=Q(Or),Ce=Q(Dr),Xt=Q(Br),et=Q(Fr),ue=Q(Wr),tt=Q(Gr),G=Q(Ur);function L(...e){return _.twMerge(_.clsx(e))}let Ze;function Ke(){return Ze===void 0&&(Ze=navigator.platform.includes("Mac")),Ze}function Zt(e){return`${e}`.toLowerCase()==="mod"?Ke()?"⌘":"Ctrl":`${e}`.toLowerCase()==="alt"?Ke()?"⌥":"Alt":`${e}`.toLowerCase()==="shift"?Ke()?"⇧":"Shift":e}function Kt(e){return e.map(Zt).join(" ")}const O=a.forwardRef((e,r)=>{const{icon:i=void 0,tooltip:n=void 0,disabled:s=!1,customClass:o="",loading:c=void 0,shortcutKeys:d=void 0,tooltipOptions:l={},action:h=void 0,isActive:u=void 0,children:x,asChild:m=!1,upload:f=!1,...w}=e,p=pt[i],g=m?Wt.Slot:mt;return t.jsxs(ft,{children:[t.jsx(gt,{asChild:!0,children:t.jsxs(g,{"data-state":u!=null&&u()?"on":"off",onClick:h,ref:r,size:"sm",className:L("richtext-w-[32px] richtext-h-[32px]",o),disabled:s,...w,children:[p&&t.jsx(p,{className:"richtext-size-4"}),x]})}),n&&t.jsx(Ue,{...l,children:t.jsxs("div",{className:"richtext-flex richtext-max-w-24 richtext-flex-col richtext-items-center richtext-text-center",children:[t.jsx("div",{children:n}),!!(d!=null&&d.length)&&t.jsx("span",{children:Kt(d)})]})})]})});function qe(e){function r(){const o=a.useRef(e),c=a.useCallback(()=>o.current,[]),d=a.useRef(new Set),l=a.useCallback(u=>{o.current={...o.current,...u},d.current.forEach(x=>x())},[]),h=a.useCallback(u=>(d.current.add(u),()=>d.current.delete(u)),[]);return{get:c,set:l,subscribe:h}}const i=a.createContext(null);function n({children:o}){return t.jsx(i.Provider,{value:r(),children:o})}function s(o){const c=a.useContext(i);if(!c)throw new Error("Store not found");return[a.useSyncExternalStore(c.subscribe,()=>o(c.get()),()=>o(e)),c.set]}return{Provider:n,useStore:s}}qe({value:!1});qe({value:!1});const{Provider:Xr,useStore:Yt}=qe({value:!1}),{Provider:Zr,useStore:Jt}=qe({value:"light"});_.d("0");function ye(e,r){return window.addEventListener(e,r),()=>{window.removeEventListener(e,r)}}function Ge(e,r){window.dispatchEvent(new CustomEvent(e,{detail:r}))}const se={UPLOAD_IMAGE:e=>`UPLOAD_IMAGE-${e}`,UPLOAD_VIDEO:e=>`UPLOAD_VIDEO-${e}`,EDIT:e=>`EDIT-${e}`,UPDATE_THEME:e=>`UPDATE_THEME-${e}`,SEARCH_REPLCE:"SEARCH_REPLACE"};function Qt(){const[e]=Yt(r=>r.value);return e}const Kr={setDisable:(e,r)=>{Ge(se.EDIT(e),r)}};function ke(e,r){const{state:i}=r,n=i.selection.$anchor;let s=!1;if(n.depth)for(let o=n.depth;o>0;o--)n.node(o).type.name===e&&(r.dispatchTransaction&&r.dispatchTransaction(i.tr.delete(n.before(o),n.after(o)).scrollIntoView()),s=!0);else{const o=i.selection.node;o&&o.type.name===e&&(r.chain().deleteSelection().run(),s=!0)}if(!s){const o=n.pos;if(o){const c=i.tr.doc.nodeAt(o);c&&c.type.name===e&&(r.dispatchTransaction&&r.dispatchTransaction(i.tr.delete(o,o+c.nodeSize)),s=!0)}}return s}function er(e,r,i){return e<r?r:e>i?i:e}const Yr=e=>typeof e=="number",Jr=e=>typeof e=="string",Qr=e=>typeof e=="function";function ei(e,r="px"){if(!e)return e;const i=Yr(e)?String(e):e,n=Number.parseFloat(i),s=i.match(/[%a-z]+$/i),o=s?s[0]:r;return Number.isNaN(n)?e:n+o}function tr(e,r){if(!e)return!1;const{extensions:i=[]}=(e==null?void 0:e.extensionManager)??{};return!!i.find(s=>s.name===r)}function ti(e){return e.map(r=>Jr(r)?{value:r,name:r}:r)}const ri=_.cva("richtext-inline-flex richtext-items-center richtext-justify-center richtext-whitespace-nowrap richtext-rounded-md richtext-text-sm richtext-font-medium richtext-ring-offset-background richtext-transition-colors focus-visible:richtext-outline-none focus-visible:richtext-ring-2 focus-visible:richtext-ring-ring focus-visible:richtext-ring-offset-2 disabled:richtext-pointer-events-none disabled:richtext-opacity-50",{variants:{variant:{default:"!richtext-bg-primary !richtext-text-primary-foreground hover:!richtext-bg-primary/90",destructive:"richtext-bg-destructive richtext-text-destructive-foreground hover:richtext-bg-destructive/90",outline:"richtext-border richtext-border-input richtext-bg-background hover:richtext-bg-accent hover:richtext-text-accent-foreground",secondary:"richtext-bg-secondary richtext-text-secondary-foreground hover:richtext-bg-secondary/80",ghost:"hover:richtext-bg-accent hover:richtext-text-accent-foreground",link:"richtext-text-primary richtext-underline-offset-4 hover:richtext-underline"},size:{default:"richtext-h-10 richtext-px-4 richtext-py-2",sm:"richtext-h-9 richtext-rounded-md richtext-px-3",lg:"richtext-h-11 richtext-rounded-md richtext-px-8",icon:"richtext-h-10 richtext-w-10"}},defaultVariants:{variant:"default",size:"default"}}),q=V.forwardRef(({className:e,variant:r,size:i,asChild:n=!1,...s},o)=>{const c=n?Wt.Slot:"button";return t.jsx(c,{className:L(ri({variant:r,size:i,className:e})),ref:o,...s})});q.displayName="Button";const rr=G.Root,ir=G.Trigger,kt=G.Portal,At=G.Sub,rt=V.forwardRef(({className:e,inset:r,children:i,...n},s)=>t.jsxs(G.SubTrigger,{ref:s,className:L("richtext-flex richtext-cursor-default richtext-select-none richtext-items-center richtext-rounded-sm richtext-px-2 richtext-py-1.5 richtext-text-sm richtext-outline-none focus:richtext-bg-accent data-[state=open]:richtext-bg-accent",r&&"richtext-pl-8",e),...n,children:[i,t.jsx(j.ChevronRight,{className:"richtext-ml-auto richtext-h-4 richtext-w-4"})]}));rt.displayName=G.SubTrigger.displayName;const it=V.forwardRef(({className:e,...r},i)=>t.jsx(G.SubContent,{ref:i,className:L("richtext-z-50 richtext-min-w-[8rem] richtext-overflow-hidden richtext-rounded-md !richtext-border richtext-bg-popover richtext-p-1 richtext-text-popover-foreground richtext-shadow-lg data-[state=open]:richtext-animate-in data-[state=closed]:richtext-animate-out data-[state=closed]:richtext-fade-out-0 data-[state=open]:richtext-fade-in-0 data-[state=closed]:richtext-zoom-out-95 data-[state=open]:richtext-zoom-in-95 data-[side=bottom]:richtext-slide-in-from-top-2 data-[side=left]:richtext-slide-in-from-right-2 data-[side=right]:richtext-slide-in-from-left-2 data-[side=top]:richtext-slide-in-from-bottom-2",e),...r}));it.displayName=G.SubContent.displayName;const dt=V.forwardRef(({className:e,sideOffset:r=4,...i},n)=>t.jsx(G.Portal,{children:t.jsx(G.Content,{ref:n,sideOffset:r,className:L("richtext-z-50 richtext-min-w-[8rem] richtext-overflow-hidden richtext-rounded-md !richtext-border richtext-bg-popover richtext-p-1 richtext-text-popover-foreground richtext-shadow-md data-[state=open]:richtext-animate-in data-[state=closed]:richtext-animate-out data-[state=closed]:richtext-fade-out-0 data-[state=open]:richtext-fade-in-0 data-[state=closed]:richtext-zoom-out-95 data-[state=open]:richtext-zoom-in-95 data-[side=bottom]:richtext-slide-in-from-top-2 data-[side=left]:richtext-slide-in-from-right-2 data-[side=right]:richtext-slide-in-from-left-2 data-[side=top]:richtext-slide-in-from-bottom-2",e),...i})}));dt.displayName=G.Content.displayName;const re=V.forwardRef(({className:e,inset:r,...i},n)=>t.jsx(G.Item,{ref:n,className:L("richtext-relative richtext-flex richtext-cursor-default richtext-select-none richtext-items-center richtext-rounded-sm richtext-px-2 richtext-py-1.5 richtext-text-sm richtext-outline-none richtext-transition-colors focus:richtext-bg-accent focus:richtext-text-accent-foreground data-[disabled]:richtext-pointer-events-none data-[disabled]:richtext-opacity-50",r&&"richtext-pl-8",e),...i}));re.displayName=G.Item.displayName;const nr=V.forwardRef(({className:e,children:r,checked:i,...n},s)=>t.jsxs(G.CheckboxItem,{ref:s,className:L("richtext-relative richtext-flex richtext-cursor-default richtext-select-none richtext-items-center richtext-rounded-sm richtext-py-1.5 richtext-pl-8 richtext-pr-2 richtext-text-sm richtext-outline-none richtext-transition-colors focus:richtext-bg-accent focus:richtext-text-accent-foreground data-[disabled]:richtext-pointer-events-none data-[disabled]:richtext-opacity-50",e),checked:i,...n,children:[t.jsx("span",{className:"richtext-absolute richtext-left-2 richtext-flex richtext-h-3.5 richtext-w-3.5 richtext-items-center richtext-justify-center",children:t.jsx(G.ItemIndicator,{children:t.jsx(j.Check,{className:"richtext-h-4 richtext-w-4"})})}),r]}));nr.displayName=G.CheckboxItem.displayName;const ii=V.forwardRef(({className:e,children:r,...i},n)=>t.jsxs(G.RadioItem,{ref:n,className:L("richtext-relative richtext-flex richtext-cursor-default richtext-select-none richtext-items-center richtext-rounded-sm richtext-py-1.5 richtext-pl-8 richtext-pr-2 richtext-text-sm richtext-outline-none richtext-transition-colors focus:richtext-bg-accent focus:richtext-text-accent-foreground data-[disabled]:richtext-pointer-events-none data-[disabled]:richtext-opacity-50",e),...i,children:[t.jsx("span",{className:"richtext-absolute richtext-left-2 richtext-flex richtext-h-3.5 richtext-w-3.5 richtext-items-center richtext-justify-center",children:t.jsx(G.ItemIndicator,{children:t.jsx(j.Circle,{className:"richtext-h-2 richtext-w-2 richtext-fill-current"})})}),r]}));ii.displayName=G.RadioItem.displayName;const ni=V.forwardRef(({className:e,inset:r,...i},n)=>t.jsx(G.Label,{ref:n,className:L("richtext-px-2 richtext-py-1.5 richtext-text-sm richtext-font-semibold",r&&"richtext-pl-8",e),...i}));ni.displayName=G.Label.displayName;const ht=V.forwardRef(({className:e,...r},i)=>t.jsx(G.Separator,{ref:i,className:L("richtext--mx-1 richtext-my-1 richtext-h-px richtext-bg-muted",e),...r}));ht.displayName=G.Separator.displayName;function or({className:e,...r}){return t.jsx("span",{className:L("richtext-ml-auto richtext-text-xs richtext-tracking-widest richtext-opacity-60",e),...r})}or.displayName="DropdownMenuShortcut";const Z=V.forwardRef(({className:e,type:r,...i},n)=>t.jsx("input",{type:r,className:L("richtext-flex richtext-h-10 richtext-w-full richtext-rounded-md !richtext-border richtext-border-input richtext-bg-background richtext-px-3 richtext-py-2 richtext-text-sm richtext-ring-offset-background file:richtext-border-0 file:richtext-bg-transparent file:richtext-text-sm file:richtext-font-medium placeholder:richtext-text-muted-foreground focus-visible:richtext-outline-none  disabled:richtext-cursor-not-allowed disabled:richtext-opacity-50",e),ref:n,...i}));Z.displayName="Input";const oi=_.cva("richtext-text-sm richtext-font-medium richtext-leading-none peer-disabled:richtext-cursor-not-allowed peer-disabled:richtext-opacity-70"),ee=V.forwardRef(({className:e,...r},i)=>t.jsx(Xt.Root,{ref:i,className:L(oi(),e),...r}));ee.displayName=Xt.Root.displayName;const xe=Ce.Root,me=Ce.Trigger,ce=V.forwardRef(({className:e,align:r="center",sideOffset:i=4,...n},s)=>t.jsx(Ce.Portal,{children:t.jsx(Ce.Content,{ref:s,align:r,sideOffset:i,className:L("richtext-z-50 richtext-w-72 richtext-rounded-md !richtext-border richtext-bg-popover richtext-p-4 richtext-text-popover-foreground richtext-shadow-md richtext-outline-none data-[state=open]:richtext-animate-in data-[state=closed]:richtext-animate-out data-[state=closed]:richtext-fade-out-0 data-[state=open]:richtext-fade-in-0 data-[state=closed]:richtext-zoom-out-95 data-[state=open]:richtext-zoom-in-95 data-[side=bottom]:richtext-slide-in-from-top-2 data-[side=left]:richtext-slide-in-from-right-2 data-[side=right]:richtext-slide-in-from-left-2 data-[side=top]:richtext-slide-in-from-bottom-2",e),...n})}));ce.displayName=Ce.Content.displayName;const Y=V.forwardRef(({className:e,orientation:r="horizontal",decorative:i=!0,...n},s)=>t.jsx(Gt.Root,{ref:s,decorative:i,orientation:r,className:L("richtext-shrink-0 richtext-bg-border",r==="horizontal"?"richtext-h-[1px] richtext-w-full":"richtext-h-full richtext-w-[1px]",e),...n}));Y.displayName=Gt.Root.displayName;const ut=V.forwardRef(({className:e,...r},i)=>t.jsx(et.Root,{className:L("richtext-peer richtext-inline-flex richtext-h-6 richtext-w-11 richtext-shrink-0 richtext-cursor-pointer richtext-items-center richtext-rounded-full richtext-border-2 richtext-border-transparent richtext-transition-colors focus-visible:richtext-outline-none focus-visible:richtext-ring-2 focus-visible:richtext-ring-ring focus-visible:richtext-ring-offset-2 focus-visible:richtext-ring-offset-background disabled:richtext-cursor-not-allowed disabled:richtext-opacity-50 data-[state=checked]:richtext-bg-primary data-[state=unchecked]:richtext-bg-input",e),...r,ref:i,children:t.jsx(et.Thumb,{className:L("richtext-pointer-events-none richtext-block richtext-h-5 richtext-w-5 richtext-rounded-full richtext-bg-background richtext-shadow-lg richtext-ring-0 richtext-transition-transform data-[state=checked]:richtext-translate-x-5 data-[state=unchecked]:richtext-translate-x-0")})}));ut.displayName=et.Root.displayName;const sr=ue.Root,xt=V.forwardRef(({className:e,...r},i)=>t.jsx(ue.List,{ref:i,className:L("richtext-inline-flex richtext-h-10 richtext-items-center richtext-justify-center richtext-rounded-md richtext-bg-muted richtext-p-1 richtext-text-muted-foreground",e),...r}));xt.displayName=ue.List.displayName;const Te=V.forwardRef(({className:e,...r},i)=>t.jsx(ue.Trigger,{ref:i,className:L("richtext-inline-flex richtext-items-center richtext-justify-center richtext-whitespace-nowrap richtext-rounded-sm richtext-px-3 richtext-py-1.5 richtext-text-sm richtext-font-medium richtext-ring-offset-background richtext-transition-all focus-visible:richtext-outline-none focus-visible:richtext-ring-2 focus-visible:richtext-ring-ring focus-visible:richtext-ring-offset-2 disabled:richtext-pointer-events-none disabled:richtext-opacity-50 data-[state=active]:richtext-bg-background data-[state=active]:richtext-text-foreground data-[state=active]:richtext-shadow-sm",e),...r}));Te.displayName=ue.Trigger.displayName;const Ne=V.forwardRef(({className:e,...r},i)=>t.jsx(ue.Content,{ref:i,className:L("richtext-mt-2 richtext-ring-offset-background focus-visible:richtext-outline-none focus-visible:richtext-ring-2 focus-visible:richtext-ring-ring focus-visible:richtext-ring-offset-2",e),...r}));Ne.displayName=ue.Content.displayName;const si=K.Provider,cr=V.forwardRef(({className:e,...r},i)=>t.jsx(K.Viewport,{ref:i,className:L("richtext-fixed richtext-top-0 richtext-z-[100] richtext-flex richtext-max-h-screen richtext-w-full richtext-flex-col-reverse richtext-p-4 sm:richtext-bottom-0 sm:richtext-right-0 sm:richtext-top-auto sm:richtext-flex-col md:richtext-max-w-[420px]",e),...r}));cr.displayName=K.Viewport.displayName;const ci=_.cva("richtext-group richtext-pointer-events-auto richtext-relative richtext-flex richtext-w-full richtext-items-center richtext-justify-between richtext-space-x-4 richtext-overflow-hidden richtext-rounded-md !richtext-border richtext-p-6 richtext-pr-8 richtext-shadow-lg richtext-transition-all data-[swipe=cancel]:richtext-translate-x-0 data-[swipe=end]:richtext-translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:richtext-translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:richtext-transition-none data-[state=open]:richtext-animate-in data-[state=closed]:richtext-animate-out data-[swipe=end]:richtext-animate-out data-[state=closed]:richtext-fade-out-80 data-[state=closed]:richtext-slide-out-to-right-full data-[state=open]:richtext-slide-in-from-top-full data-[state=open]:sm:richtext-slide-in-from-bottom-full",{variants:{variant:{default:"richtext-border richtext-bg-background richtext-text-foreground",destructive:"richtext-destructive richtext-group richtext-border-destructive richtext-bg-destructive richtext-text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ar=V.forwardRef(({className:e,variant:r,...i},n)=>t.jsx(K.Root,{ref:n,className:L(ci({variant:r}),e),...i}));ar.displayName=K.Root.displayName;const ai=V.forwardRef(({className:e,...r},i)=>t.jsx(K.Action,{ref:i,className:L("richtext-inline-flex richtext-h-8 richtext-shrink-0 richtext-items-center richtext-justify-center richtext-rounded-md !richtext-border richtext-bg-transparent richtext-px-3 richtext-text-sm richtext-font-medium richtext-ring-offset-background richtext-transition-colors hover:richtext-bg-secondary focus:richtext-outline-none focus:richtext-ring-2 focus:richtext-ring-ring focus:richtext-ring-offset-2 disabled:richtext-pointer-events-none disabled:richtext-opacity-50 group-[.destructive]:richtext-border-muted/40 group-[.destructive]:hover:richtext-border-destructive/30 group-[.destructive]:hover:richtext-bg-destructive group-[.destructive]:hover:richtext-text-destructive-foreground group-[.destructive]:focus:richtext-ring-destructive",e),...r}));ai.displayName=K.Action.displayName;const lr=V.forwardRef(({className:e,...r},i)=>t.jsx(K.Close,{ref:i,className:L("richtext-absolute richtext-right-2 richtext-top-2 richtext-rounded-md richtext-p-1 richtext-text-foreground/50 richtext-opacity-0 richtext-transition-opacity hover:richtext-text-foreground focus:richtext-opacity-100 focus:richtext-outline-none focus:richtext-ring-2 group-hover:richtext-opacity-100 group-[.destructive]:richtext-text-red-300 group-[.destructive]:hover:richtext-text-red-50 group-[.destructive]:focus:richtext-ring-red-400 group-[.destructive]:focus:richtext-ring-offset-red-600",e),"toast-close":"",...r,children:t.jsx(j.X,{className:"richtext-h-4 richtext-w-4"})}));lr.displayName=K.Close.displayName;const dr=V.forwardRef(({className:e,...r},i)=>t.jsx(K.Title,{ref:i,className:L("richtext-text-sm richtext-font-semibold",e),...r}));dr.displayName=K.Title.displayName;const hr=V.forwardRef(({className:e,...r},i)=>t.jsx(K.Description,{ref:i,className:L("richtext-text-sm richtext-opacity-90",e),...r}));hr.displayName=K.Description.displayName;const li=_.cva("richtext-inline-flex richtext-items-center richtext-justify-center richtext-rounded-md richtext-text-sm richtext-font-medium richtext-ring-offset-background richtext-transition-colors hover:richtext-bg-muted hover:richtext-text-muted-foreground focus-visible:richtext-outline-none focus-visible:richtext-ring-2 focus-visible:richtext-ring-ring focus-visible:richtext-ring-offset-2 disabled:richtext-pointer-events-none disabled:richtext-opacity-50 data-[state=on]:richtext-bg-accent data-[state=on]:richtext-text-accent-foreground",{variants:{variant:{default:"richtext-bg-transparent",outline:"richtext-border richtext-border-input richtext-bg-transparent hover:richtext-bg-accent hover:richtext-text-accent-foreground"},size:{default:"richtext-h-10 richtext-px-3",sm:"richtext-h-9 richtext-px-2",lg:"richtext-h-11 richtext-px-5"}},defaultVariants:{variant:"default",size:"default"}}),mt=V.forwardRef(({className:e,variant:r,size:i,...n},s)=>t.jsx(Ut.Root,{ref:s,className:L(li({variant:r,size:i,className:e})),...n}));mt.displayName=Ut.Root.displayName;const di=Me.Provider,ft=Me.Root,gt=Me.Trigger,Ue=V.forwardRef(({className:e,sideOffset:r=4,...i},n)=>t.jsx(Me.Content,{ref:n,sideOffset:r,className:L("richtext-z-50 richtext-overflow-hidden richtext-rounded-md !richtext-border richtext-bg-popover richtext-px-3 richtext-py-1.5 richtext-text-sm richtext-text-popover-foreground richtext-shadow-md richtext-animate-in richtext-fade-in-0 richtext-zoom-in-95 data-[side=bottom]:richtext-slide-in-from-top-2 data-[side=left]:richtext-slide-in-from-right-2 data-[side=right]:richtext-slide-in-from-left-2 data-[side=top]:richtext-slide-in-from-bottom-2",e),...i}));Ue.displayName=Me.Content.displayName;const hi=1,ui=1e6;let Ye=0;function xi(){return Ye=(Ye+1)%Number.MAX_SAFE_INTEGER,Ye.toString()}const Je=new Map;function It(e){if(Je.has(e))return;const r=setTimeout(()=>{Je.delete(e),je({type:"REMOVE_TOAST",toastId:e})},ui);Je.set(e,r)}function mi(e,r){switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,hi)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(i=>i.id===r.toast.id?{...i,...r.toast}:i)};case"DISMISS_TOAST":{const{toastId:i}=r;return i?It(i):e.toasts.forEach(n=>{It(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===i||i===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==r.toastId)}}}const De=[];let Be={toasts:[]};function je(e){Be=mi(Be,e),De.forEach(r=>{r(Be)})}function fi({...e}){const r=xi(),i=s=>je({type:"UPDATE_TOAST",toast:{...s,id:r}}),n=()=>je({type:"DISMISS_TOAST",toastId:r});return je({type:"ADD_TOAST",toast:{...e,id:r,open:!0,onOpenChange:s=>{s||n()}}}),{id:r,dismiss:n,update:i}}function ur(){const[e,r]=V.useState(Be);return V.useEffect(()=>(De.push(r),()=>{const i=De.indexOf(r);i>-1&&De.splice(i,1)}),[e]),{...e,toast:fi,dismiss:i=>je({type:"DISMISS_TOAST",toastId:i})}}const xr=V.forwardRef(({className:e,...r},i)=>t.jsx(tt.Root,{ref:i,className:L("!richtext-peer !richtext-h-4 !richtext-w-4 !richtext-p-0 !richtext-shrink-0 !richtext-rounded-sm !richtext-border !richtext-border-primary !richtext-ring-offset-background focus-visible:!richtext-outline-none focus-visible:!richtext-ring-2 focus-visible:!richtext-ring-ring focus-visible:!richtext-ring-offset-2 disabled:!richtext-cursor-not-allowed disabled:!richtext-opacity-50 data-[state=checked]:!richtext-bg-primary data-[state=checked]:!richtext-text-primary-foreground",e),...r,children:t.jsx(tt.Indicator,{className:L("!richtext-flex !richtext-p-0 !richtext-items-center !richtext-justify-center !richtext-text-current"),children:t.jsx(j.Check,{className:"!richtext-h-4 !richtext-w-4"})})}));xr.displayName=tt.Root.displayName;function gi(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:t.jsx("path",{fill:"currentColor",d:"M19 12h-2v3h-3v2h5zM7 9h3V7H5v5h2zm14-6H3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2m0 16H3V5h18z"})})}function pi(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:t.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 15h15m0 4H6m9-8h6m0-4h-6M9 9h1a1 1 0 1 1-1 1V7.5a2 2 0 0 1 2-2M3 9h1a1 1 0 1 1-1 1V7.5a2 2 0 0 1 2-2"})})}function wi(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",className:"richtext-w-4 richtext-h-4",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M5.5 3c1.404 0 2.107 0 2.611.38c.219.164.406.375.552.62C9 4.568 9 5.358 9 6.938v10.125c0 1.58 0 2.37-.337 2.937a2.1 2.1 0 0 1-.552.621c-.504.38-1.207.38-2.611.38s-2.107 0-2.611-.38a2.1 2.1 0 0 1-.552-.62C2 19.432 2 18.642 2 17.062V6.938c0-1.58 0-2.37.337-2.938a2.1 2.1 0 0 1 .552-.62C3.393 3 4.096 3 5.5 3M20 11.938v5.124c0 1.58 0 2.37-.337 2.938a2.1 2.1 0 0 1-.552.62c-.504.38-1.207.38-2.611.38s-2.107 0-2.611-.38a2.1 2.1 0 0 1-.552-.62C13 19.433 13 18.642 13 17.063V6.938c0-1.58 0-2.37.337-2.938M22 9l-6-6m6 0l-6 6",color:"currentColor"})})}function vi(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",className:"richtext-w-4 richtext-h-4",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M21 18.5c0 1.404 0 2.107-.38 2.611a2.1 2.1 0 0 1-.62.552c-.567.337-1.358.337-2.937.337H6.938c-1.58 0-2.37 0-2.938-.337a2.1 2.1 0 0 1-.62-.552C3 20.607 3 19.904 3 18.5s0-2.107.38-2.611c.163-.218.374-.406.62-.552C4.567 15 5.357 15 6.938 15h10.125c1.58 0 2.37 0 2.937.337c.246.146.457.334.62.552c.38.504.38 1.207.38 2.611M12.063 4H6.937C5.358 4 4.568 4 4 4.337a2.1 2.1 0 0 0-.62.552C3 5.393 3 6.096 3 7.5s0 2.107.38 2.611c.163.218.374.406.62.552C4.567 11 5.357 11 6.938 11h10.125c1.58 0 2.37 0 2.937-.337M21 8l-6-6m6 0l-6 6",color:"currentColor"})})}function bi(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:t.jsx("path",{fill:"currentColor",d:"M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-.65-10l-2.1 9h-1.4l-1.8-6.79l-1.8 6.79h-1.4l-2.2-9h1.5l1.4 6.81l1.8-6.81h1.3l1.8 6.81l1.4-6.81z"})})}function U(e){const r=pt[e.name];return r?t.jsx(r,{onClick:e==null?void 0:e.onClick,className:`richtext-w-4 richtext-h-4 ${(e==null?void 0:e.className)||""}`}):null}function ji(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:t.jsx("path",{fill:"currentColor",d:"M21 22H3v-2h18zm0-18H3V2h18zm-11 9.7h4l-2-5.4zM11.2 6h1.7l4.7 12h-2l-.9-2.6H9.4L8.5 18h-2z"})})}function mr(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 48 48",...e,children:t.jsx("path",{fill:"currentColor",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:4,d:"M36 19L24 31L12 19z"})})}function Ci(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:t.jsx("path",{fill:"currentColor",d:"M9 7v10h6v-2h-4V7z"})})}function yi(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:t.jsx("path",{fill:"currentColor",d:"M9 7c-1.1 0-2 .9-2 2v8h2V9h2v7h2V9h2v8h2V9a2 2 0 0 0-2-2z"})})}function Ti(e){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...e,children:t.jsx("path",{fill:"currentColor",d:"M11 7c-1.1 0-2 .9-2 2v2a2 2 0 0 0 2 2h2v2H9v2h4c1.11 0 2-.89 2-2v-2a2 2 0 0 0-2-2h-2V9h4V7z"})})}function Ni(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14 4h4a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1m-9 8h4m-2-2v4"})})}function Si(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 4h4a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1m9 8h4m-2-2v4"})})}function Mi(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 21v-4m0-4V9m0-4V3m-2 18h4M8 5v4h11l2-2l-2-2zm6 8v4H6l-2-2l2-2z"})})}function fr(){return t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",children:[t.jsx("path",{fill:"currentColor",d:"M30 18v-2h-6v10h2v-4h3v-2h-3v-2zm-11 8h-4V16h4a3.003 3.003 0 0 1 3 3v4a3.003 3.003 0 0 1-3 3m-2-2h2a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-2zm-6-8H6v10h2v-3h3a2.003 2.003 0 0 0 2-2v-3a2 2 0 0 0-2-2m-3 5v-3h3l.001 3z"}),t.jsx("path",{fill:"currentColor",d:"M22 14v-4a.91.91 0 0 0-.3-.7l-7-7A.9.9 0 0 0 14 2H4a2.006 2.006 0 0 0-2 2v24a2 2 0 0 0 2 2h16v-2H4V4h8v6a2.006 2.006 0 0 0 2 2h6v2Zm-8-4V4.4l5.6 5.6Z"})]})}function gr(){return t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",className:"icon",viewBox:"0 0 1024 1024",children:[t.jsx("path",{fill:"currentColor",d:"M679.253 402.364 618.77 561.015l-60.348-158.651a30.04 30.04 0 0 0-30.447-18.637 29.76 29.76 0 0 0-30.447 18.637l-60.416 158.651-60.416-158.651a30.515 30.515 0 0 0-38.843-17.272 28.945 28.945 0 0 0-17.954 37.547l88.815 233.267c4.369 11.469 15.7 19.115 28.398 19.115a30.31 30.31 0 0 0 28.468-19.115l62.395-163.908 62.396 163.84c4.437 11.605 15.701 19.183 28.4 19.183a30.31 30.31 0 0 0 28.466-19.115l88.747-233.267a28.945 28.945 0 0 0-17.886-37.547 30.447 30.447 0 0 0-38.912 17.272zm219.478 395.605-51.883-29.218c-28.672-16.18-52.224-3.072-52.224 29.082v.273H643.209a29.833 29.833 0 0 0-30.31 29.354c0 16.18 13.584 29.218 30.31 29.218h151.825c1.092 30.516 24.03 43.077 52.224 27.648l51.063-27.989c29.013-15.906 29.15-42.189.41-58.368"}),t.jsx("path",{fill:"currentColor",d:"m810.667 913.135-.478.068H201.796c-19.865 0-36.727-11.673-36.727-25.6v-618.36h154.965c51.268 0 92.911-39.39 92.911-87.858v-87.86H810.19c19.797 0 36.522 11.742 36.522 25.669V739.26h61.987V119.262c0-46.421-44.169-84.241-98.51-84.241H328.364l-225.28 194.56v658.09c0 46.285 44.236 84.105 98.713 84.105H810.19c43.759 0 80.554-24.713 93.32-58.573h-92.842zM350.89 94.89v86.562c0 16.11-13.858 29.286-30.925 29.286H216.815L350.959 94.891z"})]})}function ki(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",color:"currentColor",children:[t.jsx("path",{d:"M14.86 22h-4.312c-3.291 0-4.937 0-6.08-.798a4.2 4.2 0 0 1-.863-.805c-.855-1.066-.855-2.6-.855-5.67v-2.545c0-2.963 0-4.445.473-5.628c.761-1.903 2.37-3.403 4.41-4.113C8.9 2 10.49 2 13.667 2c1.816 0 2.723 0 3.448.252c1.166.406 2.085 1.263 2.52 2.35c.27.676.27 1.523.27 3.216V10"}),t.jsx("path",{d:"M2.75 12c0-1.84 1.506-3.333 3.364-3.333c.672 0 1.464.116 2.117-.057a1.67 1.67 0 0 0 1.19-1.179c.174-.647.057-1.432.057-2.098C9.478 3.493 10.984 2 12.84 2m.002 16h2.523m-4.949-4.15c-.126-.8-.281-.801-1.61-.85h-1.01c-.557 0-1.009.448-1.009 1v3c0 .552.452 1 1.01 1h1.816c.39 0 .803-.313.803-.7v-1.1c0-.11-.113-.304-.224-.304H9.068M12.842 13h1.261m0 0h1.262m-1.262 0v4.875M21.251 13h-2.523c-.557 0-1.009.448-1.009 1v1.5m0 0V18m0-2.5h2.523"})]})})}function Ai(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20",children:t.jsx("path",{fill:"currentColor",d:"M6.5 3a.75.75 0 0 1 .697.471l3 7.5a.75.75 0 0 1-1.393.557L7.992 9.5H5.008l-.811 2.028a.75.75 0 0 1-1.393-.556l3-7.5A.75.75 0 0 1 6.5 3m0 2.77L5.608 8h1.784zm8.28-1.55a.75.75 0 1 0-1.06 1.06l.72.72h-3.69a.75.75 0 0 0 0 1.5h3.69l-.72.72a.75.75 0 0 0 1.06 1.06l2-2a.75.75 0 0 0 0-1.06zm0 7.5a.75.75 0 1 0-1.06 1.06l.72.72H3.75a.75.75 0 0 0 0 1.5h10.69l-.72.72a.75.75 0 1 0 1.06 1.06l2-2a.75.75 0 0 0 0-1.06z"})})}function Ii(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 48 48",children:t.jsxs("g",{fill:"none",stroke:"currentColor",strokeWidth:"4",children:[t.jsx("circle",{cx:"10",cy:"24",r:"4"}),t.jsx("circle",{cx:"38",cy:"10",r:"4"}),t.jsx("circle",{cx:"38",cy:"24",r:"4"}),t.jsx("circle",{cx:"38",cy:"38",r:"4"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M34 38H22V10h12M14 24h20"})]})})}function Li(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20",children:t.jsx("path",{fill:"currentColor",d:"M13.5 3a.75.75 0 0 0-.697.471l-3 7.5a.75.75 0 0 0 1.393.557l.812-2.028h2.984l.811 2.028a.75.75 0 0 0 1.393-.556l-3-7.5A.75.75 0 0 0 13.5 3m0 2.77L14.392 8h-1.784zM5.22 4.22a.75.75 0 0 1 1.06 1.06L5.56 6h3.69a.75.75 0 0 1 0 1.5H5.56l.72.72a.75.75 0 0 1-1.06 1.06l-2-2a.75.75 0 0 1 0-1.06zm0 7.5a.75.75 0 0 1 1.06 1.06l-.72.72h10.69a.75.75 0 0 1 0 1.5H5.56l.72.72a.75.75 0 1 1-1.06 1.06l-2-2a.75.75 0 0 1 0-1.06z"})})}function Ei(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"m3 21l7.548-7.548M21 3l-7.548 7.548m0 0L8 3H3l7.548 10.452m2.904-2.904L21 21h-5l-5.452-7.548",color:"currentColor"})})}function Ri(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"currentColor",d:"M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-.65-10l-2.1 9h-1.4l-1.8-6.79l-1.8 6.79h-1.4l-2.2-9h1.5l1.4 6.81l1.8-6.81h1.3l1.8 6.81l1.4-6.81z"})})}const pt={Bold:j.Bold,LoaderCircle:j.LoaderCircle,Italic:j.Italic,Underline:j.Underline,Quote:j.Quote,TextQuote:pi,Strikethrough:j.Strikethrough,Minus:j.Minus,Eraser:j.Eraser,PaintRoller:j.PaintRoller,Redo2:j.Redo2,Undo2:j.Undo2,AlignCenter:Re.TextAlignCenterIcon,AlignJustify:Re.TextAlignJustifyIcon,AlignLeft:Re.TextAlignLeftIcon,AlignRight:Re.TextAlignRightIcon,ChevronDown:j.ChevronDown,Subscript:j.Subscript,Superscript:j.Superscript,Code:j.Code,Code2:j.CodeXml,Type:j.Type,IndentIncrease:j.IndentIncrease,IndentDecrease:j.IndentDecrease,List:j.List,ListOrdered:j.ListOrdered,ListTodo:j.ListTodo,Link:j.Link,ImageUp:j.ImageUp,Video:j.Video,Maximize:j.Maximize,Minimize:j.Minimize,Table:j.Table,Sparkles:j.Sparkles,Pencil:j.Pencil,Unlink:j.Unlink,BetweenHorizonalEnd:j.BetweenHorizonalEnd,BetweenHorizonalStart:j.BetweenHorizonalStart,BetweenVerticalStart:j.BetweenVerticalStart,BetweenVerticalEnd:j.BetweenVerticalEnd,TableCellsMerge:j.TableCellsMerge,TableCellsSplit:j.TableCellsSplit,Trash2:j.Trash2,Trash:j.Trash,Replace:j.Replace,ChevronsUpDown:j.ChevronsUpDown,LineHeight:ji,Word:bi,Heading1:j.Heading1,Heading2:j.Heading2,Heading3:j.Heading3,Heading4:j.Heading4,Heading5:j.Heading5,Heading6:j.Heading6,Columns2:j.Columns2,Columns3:j.Columns3,Columns4:j.Columns4,Plus:j.Plus,Grip:j.GripVertical,Copy:j.Copy,Clipboard:j.Clipboard,PanelLeft:j.PanelLeft,PanelRight:j.PanelRight,Columns:j.Columns2,Iframe:j.Frame,MenuDown:mr,SizeS:Ti,SizeM:yi,SizeL:Ci,AspectRatio:gi,Emoji:j.SmilePlus,DeleteColumn:wi,DeleteRow:vi,SearchAndReplace:j.Replace,EmojiIcon:j.SmilePlusIcon,KatexIcon:j.Sigma,ExportPdf:fr,ExportWord:gr,ImportWord:Ri,ColumnAddLeft:Ni,ColumnAddRight:Si,BookMarked:j.BookMarked,ZoomIn:j.ZoomIn,ZoomOut:j.ZoomOut,Settings:j.Settings,Eye:j.Eye,TextDirection:Mi,LeftToRight:Ai,RightToLeft:Li,Attachment:j.Paperclip,GifIcon:ki,ChevronUp:j.ChevronUp,Crop:j.CropIcon,Mermaid:Ii,Twitter:Ei,FlipX:j.FlipVertical,FlipY:j.FlipHorizontal,PencilRuler:j.PencilRuler,WrapText:j.WrapText};function Pi({fill:e}){return t.jsx("svg",{width:"18px",height:"18px",viewBox:"0 0 256 256",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("g",{id:"icon/填充色",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",children:t.jsxs("g",{id:"icon/背景颜色",children:[t.jsx("g",{id:"编组",fill:"currentColor",children:t.jsxs("g",{transform:"translate(119.502295, 137.878331) rotate(-135.000000) translate(-119.502295, -137.878331) translate(48.002295, 31.757731)",id:"矩形",children:[t.jsx("path",{d:"M100.946943,60.8084699 L43.7469427,60.8084699 C37.2852111,60.8084699 32.0469427,66.0467383 32.0469427,72.5084699 L32.0469427,118.70847 C32.0469427,125.170201 37.2852111,130.40847 43.7469427,130.40847 L100.946943,130.40847 C107.408674,130.40847 112.646943,125.170201 112.646943,118.70847 L112.646943,72.5084699 C112.646943,66.0467383 107.408674,60.8084699 100.946943,60.8084699 Z M93.646,79.808 L93.646,111.408 L51.046,111.408 L51.046,79.808 L93.646,79.808 Z",fillRule:"nonzero"}),t.jsx("path",{d:"M87.9366521,16.90916 L87.9194966,68.2000001 C87.9183543,69.4147389 86.9334998,70.399264 85.7187607,70.4 L56.9423078,70.4 C55.7272813,70.4 54.7423078,69.4150264 54.7423078,68.2 L54.7423078,39.4621057 C54.7423078,37.2523513 55.5736632,35.1234748 57.0711706,33.4985176 L76.4832996,12.4342613 C78.9534987,9.75382857 83.1289108,9.5834005 85.8093436,12.0535996 C87.1658473,13.303709 87.9372691,15.0644715 87.9366521,16.90916 Z",fillRule:"evenodd"}),t.jsx("path",{d:"M131.3,111.241199 L11.7,111.241199 C5.23826843,111.241199 0,116.479467 0,122.941199 L0,200.541199 C0,207.002931 5.23826843,212.241199 11.7,212.241199 L131.3,212.241199 C137.761732,212.241199 143,207.002931 143,200.541199 L143,122.941199 C143,116.479467 137.761732,111.241199 131.3,111.241199 Z M124,130.241 L124,193.241 L19,193.241 L19,130.241 L124,130.241 Z",fillRule:"nonzero"})]})}),t.jsx("path",{d:"M51,218 L205,218 C211.075132,218 216,222.924868 216,229 C216,235.075132 211.075132,240 205,240 L51,240 C44.9248678,240 40,235.075132 40,229 C40,222.924868 44.9248678,218 51,218 Z",id:"矩形",fill:e||"#FBDE28"})]})})})}function pr(e){const[r,i]=a.useState(void 0);function n(c){var d;(d=e.action)==null||d.call(e,c)}function s(){var c;(c=e.action)==null||c.call(e,r)}const o=a.useCallback(_.debounce(c=>{i(c)},350),[]);return t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-h-[32px]",children:[t.jsx(O,{tooltip:e==null?void 0:e.tooltip,disabled:e==null?void 0:e.disabled,action:s,tooltipOptions:e==null?void 0:e.tooltipOptions,shortcutKeys:e==null?void 0:e.shortcutKeys,children:t.jsx("span",{className:"richtext-flex richtext-items-center richtext-justify-center richtext-text-sm",children:t.jsx(Pi,{fill:r})})}),t.jsx(Nr,{selectedColor:r,setSelectedColor:o,onChange:n,highlight:!0,disabled:e==null?void 0:e.disabled,children:t.jsx(q,{variant:"ghost",size:"icon",className:"!richtext-w-3 !richtext-h-[32px]",disabled:e==null?void 0:e.disabled,children:t.jsx(U,{className:"!richtext-w-3 !richtext-h-3 richtext-text-zinc-500",name:"MenuDown"})})})]})}function wr(e){const{t:r}=S.useLocale(),[i,n]=a.useState({text:"",link:""}),[s,o]=a.useState(!1);a.useEffect(()=>{var d;if(e!=null&&e.editor){const{href:l,target:h}=(d=e.editor)==null?void 0:d.getAttributes("link"),{from:u,to:x}=e.editor.state.selection,m=e.editor.state.doc.textBetween(u,x," ");n({link:l,text:m}),o(h==="_blank")}},[e==null?void 0:e.editor]);function c(d){d.preventDefault(),d.stopPropagation(),e==null||e.onSetLink(i.link,i.text,s)}return t.jsx("div",{className:"border-neutral-200 richtext-rounded-lg !richtext-border richtext-bg-white richtext-p-2 richtext-shadow-sm dark:richtext-border-neutral-800 dark:richtext-bg-black",children:t.jsxs("form",{className:"richtext-flex richtext-flex-col richtext-gap-2",onSubmit:c,children:[t.jsx(ee,{className:"mb-[6px]",children:r("editor.link.dialog.text")}),t.jsx("div",{className:"richtext-mb-[10px] richtext-flex richtext-w-full richtext-max-w-sm richtext-items-center richtext-gap-1.5",children:t.jsx("div",{className:"richtext-relative richtext-w-full richtext-max-w-sm richtext-items-center",children:t.jsx(Z,{className:"richtext-w-80",onChange:d=>n({...i,text:d.target.value}),placeholder:"Text",required:!0,type:"text",value:i.text})})}),t.jsx(ee,{className:"mb-[6px]",children:r("editor.link.dialog.link")}),t.jsx("div",{className:"richtext-flex richtext-w-full richtext-max-w-sm richtext-items-center richtext-gap-1.5",children:t.jsxs("div",{className:"richtext-relative richtext-w-full richtext-max-w-sm richtext-items-center",children:[t.jsx(Z,{className:"richtext-pl-10",onChange:d=>n({...i,link:d.target.value}),required:!0,type:"url",value:i.link}),t.jsx("span",{className:"richtext-absolute richtext-inset-y-0 richtext-start-0 richtext-flex richtext-items-center richtext-justify-center richtext-px-2",children:t.jsx(U,{className:"richtext-size-5 richtext-text-muted-foreground",name:"Link"})})]})}),t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-space-x-2",children:[t.jsx(ee,{children:r("editor.link.dialog.openInNewTab")}),t.jsx(ut,{checked:s,onCheckedChange:d=>{o(d)}})]}),t.jsx(q,{className:"richtext-mt-2 richtext-self-end",type:"submit",children:r("editor.link.dialog.button.apply")})]})})}function zi(e,r,i=null){return i?e.createChecked({index:r},i):e.createAndFill({index:r})}function _i(e){if(e.cached.columnsNodeTypes)return e.cached.columnsNodeTypes;const r={columns:e.nodes.columns,column:e.nodes.column};return e.cached.columnsNodeTypes=r,r}function Hi(e,r,i=null){const n=_i(e),s=[];for(let o=0;o<r;o+=1){const c=zi(n.column,o,i);c&&s.push(c)}return n.columns.createChecked({cols:r},s)}function Qe({state:e,dispatch:r,type:i}){const n=R.findParentNode(o=>o.type.name===Se.name)(e.selection),s=R.findParentNode(o=>o.type.name===wt.name)(e.selection);if(r&&n&&s){const o=n.node,c=s.node.attrs.index,d=o.toJSON();let l=c;i==="delete"?(l=c-1,d.content.splice(c,1)):(l=i==="addBefore"?c:c+1,d.content.splice(l,0,{type:"column",attrs:{index:c},content:[{type:"paragraph"}]})),d.attrs.cols=d.content.length,d.content.forEach((m,f)=>{m.attrs.index=f});const h=_.Node.fromJSON(e.schema,d);let u=n.pos;h.content.forEach((m,f,w)=>{w<l&&(u+=m.nodeSize)});const x=e.tr.setTime(Date.now());x.replaceWith(n.pos,n.pos+n.node.nodeSize,h).setSelection(_.TextSelection.near(x.doc.resolve(u))),r(x)}return!0}function Lt({state:e,dispatch:r,type:i}){const n=R.findParentNode(o=>o.type.name===Se.name)(e.selection),s=R.findParentNode(o=>o.type.name===wt.name)(e.selection);if(r&&n&&s){const o=n.node,c=s.node.attrs.index;let d=0;i==="before"?d=(c-1+o.attrs.cols)%o.attrs.cols:d=(c+1)%o.attrs.cols;let l=n.pos;o.content.forEach((u,x,m)=>{m<d&&(l+=u.nodeSize)});const h=e.tr.setTime(Date.now());return h.setSelection(_.TextSelection.near(h.doc.resolve(l))),r(h),!0}return!1}const Oi=200,Se=R.Node.create({name:"columns",group:"block",defining:!0,isolating:!0,allowGapCursor:!1,content:"column{1,}",priority:Oi,addOptions(){return{HTMLAttributes:{class:"columns"}}},addAttributes(){return{cols:{default:2,parseHTML:e=>e.getAttribute("cols")}}},parseHTML(){return[{tag:"div[class=grid]"}]},renderHTML({HTMLAttributes:e}){return["div",R.mergeAttributes(this.options.HTMLAttributes,e),0]},addCommands(){return{insertColumns:e=>({tr:r,dispatch:i,editor:n})=>{const s=Hi(n.schema,e&&e.cols||3);if(i){const o=r.selection.anchor+1;r.replaceSelectionWith(s).scrollIntoView().setSelection(_.TextSelection.near(r.doc.resolve(o)))}return!0},addColBefore:()=>({dispatch:e,state:r})=>Qe({dispatch:e,state:r,type:"addBefore"}),addColAfter:()=>({dispatch:e,state:r})=>Qe({dispatch:e,state:r,type:"addAfter"}),deleteCol:()=>({dispatch:e,state:r})=>Qe({dispatch:e,state:r,type:"delete"})}},addKeyboardShortcuts(){return{"Mod-Alt-G":()=>this.editor.commands.insertColumns(),Tab:()=>Lt({state:this.editor.state,dispatch:this.editor.view.dispatch,type:"after"}),"Shift-Tab":()=>Lt({state:this.editor.state,dispatch:this.editor.view.dispatch,type:"before"})}}}),wt=R.Node.create({name:"column",content:"block+",isolating:!0,addOptions(){return{HTMLAttributes:{class:"column"}}},addAttributes(){return{index:{default:0,parseHTML:e=>e.getAttribute("index")}}},parseHTML(){return[{tag:"div[class=column]"}]},renderHTML({HTMLAttributes:e}){return["div",R.mergeAttributes(this.options.HTMLAttributes,e),0]}});var Fe=(e=>(e[e.max=7]="max",e[e.min=0]="min",e[e.more=1]="more",e[e.less=-1]="less",e))(Fe||{});function Di(e,r,i){return e<r?r:e>i?i:e}function Bi(e,r,i,n){const{doc:s,selection:o}=e;if(!s||!o||!(o instanceof _.TextSelection||o instanceof _.AllSelection))return e;const{from:c,to:d}=o;return s.nodesBetween(c,d,(l,h)=>{const u=l.type;return i.includes(u.name)?(e=nt(e,h,r),!1):!R.isList(l.type.name,n.extensionManager.extensions)}),e}function nt(e,r,i){if(!e.doc)return e;const n=e.doc.nodeAt(r);if(!n)return e;const c=Di((n.attrs.indent||0)+i,0,7);if(c===n.attrs.indent)return e;const d={...n.attrs,indent:c};return e.setNodeMarkup(r,n.type,d,n.marks)}function $i({delta:e,types:r}){return({state:i,dispatch:n,editor:s})=>{const{selection:o}=i;let{tr:c}=i;return c=c.setSelection(o),c=Bi(c,e,r,s),c.docChanged?(n&&n(c),!0):!1}}const vr={setOpen:(e,r)=>{Ge(se.UPLOAD_IMAGE(e),r)}},ae=J.Root,le=J.Trigger,Vi=J.Portal,br=V.forwardRef(({className:e,...r},i)=>t.jsx(J.Overlay,{ref:i,className:L("richtext-fixed richtext-inset-0 richtext-z-50 richtext-bg-black/80 richtext- data-[state=open]:richtext-animate-in data-[state=closed]:richtext-animate-out data-[state=closed]:richtext-fade-out-0 data-[state=open]:richtext-fade-in-0",e),...r}));br.displayName=J.Overlay.displayName;const ne=V.forwardRef(({className:e,children:r,...i},n)=>t.jsxs(Vi,{children:[t.jsx(br,{}),t.jsxs(J.Content,{ref:n,className:L("richtext-dialog-content richtext-fixed richtext-left-[50%] richtext-top-[50%] richtext-z-50 richtext-grid richtext-w-full richtext-max-w-lg richtext-translate-x-[-50%] richtext-translate-y-[-50%] richtext-gap-4 richtext-border richtext-bg-background richtext-p-6 richtext-shadow-lg richtext-duration-200 data-[state=open]:richtext-animate-in data-[state=closed]:richtext-animate-out data-[state=closed]:richtext-fade-out-0 data-[state=open]:richtext-fade-in-0 data-[state=closed]:richtext-zoom-out-95 data-[state=open]:richtext-zoom-in-95 data-[state=closed]:richtext-slide-out-to-left-1/2 data-[state=closed]:richtext-slide-out-to-top-[48%] data-[state=open]:richtext-slide-in-from-left-1/2 data-[state=open]:richtext-slide-in-from-top-[48%] sm:richtext-rounded-lg",e),...i,children:[r,t.jsxs(J.Close,{className:"richtext-absolute richtext-right-4 richtext-top-4 richtext-rounded-sm richtext-opacity-70 richtext-ring-offset-background richtext-transition-opacity hover:richtext-opacity-100 focus:richtext-outline-none focus:richtext-ring-2 focus:richtext-ring-ring focus:richtext-ring-offset-2 disabled:richtext-pointer-events-none data-[state=open]:richtext-bg-accent data-[state=open]:richtext-text-muted-foreground",children:[t.jsx(j.X,{className:"richtext-h-4 richtext-w-4"}),t.jsx("span",{className:"richtext-sr-only",children:"Close"})]})]})]}));ne.displayName=J.Content.displayName;function jr({className:e,...r}){return t.jsx("div",{className:L("richtext-flex richtext-flex-col richtext-space-y-1.5 richtext-text-center sm:richtext-text-left",e),...r})}jr.displayName="DialogHeader";function fe({className:e,...r}){return t.jsx("div",{className:L("richtext-flex richtext-flex-col-reverse sm:richtext-flex-row sm:richtext-justify-end sm:richtext-space-x-2",e),...r})}fe.displayName="DialogFooter";const oe=V.forwardRef(({className:e,...r},i)=>t.jsx(J.Title,{ref:i,className:L("richtext-text-lg richtext-font-semibold richtext-leading-none richtext-tracking-tight",e),...r}));oe.displayName=J.Title.displayName;const Fi=V.forwardRef(({className:e,...r},i)=>t.jsx(J.Description,{ref:i,className:L("richtext-text-sm richtext-text-muted-foreground",e),...r}));Fi.displayName=J.Description.displayName;function Wi(e){return e.replace(/^.*\/|\..+$/g,"")}function qi(e){return e.split(".").pop()}function Gi(e){return e<1024?`${e} Byte`:e<1024*1024?`${(e/1024).toFixed(2)} KB`:`${(e/1024/1024).toFixed(2)} MB`}function Ui(e){return e?e==="application/pdf"?"pdf":e.startsWith("application/")&&[".document","word"].some(r=>e.includes(r))?"word":e.startsWith("application/")&&["presentation"].some(r=>e.includes(r))?"excel":e.startsWith("application/")&&["sheet"].some(r=>e.includes(r))?"ppt":e.startsWith("image")?"image":e.startsWith("audio")?"audio":e.startsWith("video")?"video":"file":"file"}function Xi(e){return new Promise(r=>{const i=new FileReader;i.addEventListener("load",()=>{r({alt:e.name,src:i.result})},!1),i.readAsDataURL(e)})}function Ae(e,r){const i=e.split(","),n=i[0].match(/:(.*?);/)[1],s=atob(i[i.length-1]);let o=s.length;const c=new Uint8Array(o);for(;o--;)c[o]=s.charCodeAt(o);return new File([c],r,{type:n})}function Zi({editor:e,imageInline:r,onClose:i}){const{t:n}=S.useLocale(),[s,o]=a.useState(!1),c=a.useRef(null),[d,l]=a.useState(),[h,u]=a.useState(""),x=a.useRef(null),[m,f]=a.useState({src:"",file:null});function w(C){if(c.current&&C.width&&C.height){const b=p(c.current,C);u(b)}}function p(C,b){const k=document.createElement("canvas"),P=C.naturalWidth/C.width,I=C.naturalHeight/C.height;k.width=b.width*P,k.height=b.height*I;const y=k.getContext("2d");return y&&(y.imageSmoothingEnabled=!1,y.drawImage(C,b.x*P,b.y*I,b.width*P,b.height*I,0,0,b.width*P,b.height*I)),k.toDataURL("image/png",1)}async function g(){var C,b;try{const k=Ae(h,((C=m==null?void 0:m.file)==null?void 0:C.name)||"image.png"),P=(b=e.extensionManager.extensions.find(y=>y.name===we.name))==null?void 0:b.options;let I="";P.upload?I=await P.upload(k):I=URL.createObjectURL(k),e.chain().focus().setImageInline({src:I,inline:r}).run(),o(!1),f({src:"",file:null}),i()}catch(k){console.log("Error cropping image",k)}}function H(C){var b;C.preventDefault(),(b=x.current)==null||b.click()}const N=async C=>{var I;const b=(I=C==null?void 0:C.target)==null?void 0:I.files;if(!e||e.isDestroyed||b.length===0)return;const k=b[0],P=await Xi(k);o(!0),f({src:P.src,file:k})};return t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"richtext-mt-1 richtext-w-full",onClick:H,size:"sm",children:n("editor.image.dialog.tab.uploadCrop")}),t.jsxs(ae,{open:s,children:[t.jsx(le,{}),t.jsxs(ne,{children:[t.jsx(oe,{children:n("editor.image.dialog.tab.uploadCrop")}),t.jsx("div",{children:m.src&&t.jsx(qr,{className:"richtext-w-full",crop:d,onChange:C=>l(C),onComplete:C=>w(C),children:t.jsx("img",{alt:"Crop me",ref:c,src:m.src})})}),t.jsxs(fe,{children:[t.jsxs(q,{onClick:()=>{o(!1),f({src:"",file:null})},children:[n("editor.imageUpload.cancel"),t.jsx(U,{className:"richtext-ml-[4px]",name:"Trash2"})]}),t.jsxs(q,{className:"richtext-w-fit",onClick:g,children:[n("editor.imageUpload.crop"),t.jsx(U,{className:"richtext-ml-[4px]",name:"Crop"})]})]})]})]}),t.jsx("input",{accept:"image/*",multiple:!0,onChange:N,ref:x,type:"file",style:{display:"none"}})]})}function Ki(e){var w;const{t:r}=S.useLocale(),[i,n]=a.useState(!1),s=p=>{n(p.detail)},[o,c]=a.useState(""),d=a.useRef(null),[l,h]=a.useState(((w=e.editor.extensionManager.extensions.find(p=>p.name===we.name))==null?void 0:w.options.defaultInline)||!1),u=a.useMemo(()=>{var g;return(g=e.editor.extensionManager.extensions.find(H=>H.name===we.name))==null?void 0:g.options},[e.editor]);a.useEffect(()=>{const p=ye(se.UPLOAD_IMAGE(e.editor.id),s);return()=>{p()}},[]);async function x(p){var C;const g=(C=p==null?void 0:p.target)==null?void 0:C.files;if(!e.editor||e.editor.isDestroyed||g.length===0)return;const H=g[0];let N="";u.upload?N=await u.upload(H):N=URL.createObjectURL(H),e.editor.chain().focus().setImageInline({src:N,inline:l}).run(),n(!1),h(!1)}function m(p){p.preventDefault(),p.stopPropagation(),e.editor.chain().focus().setImageInline({src:o,inline:l}).run(),n(!1),h(!1),c("")}function f(p){var g;p.preventDefault(),(g=d.current)==null||g.click()}return t.jsxs(ae,{onOpenChange:n,open:i,children:[t.jsx(le,{asChild:!0,children:t.jsx(O,{action:()=>n(!0),icon:e.icon,tooltip:e.tooltip})}),t.jsxs(ne,{children:[t.jsx(oe,{children:r("editor.image.dialog.title")}),t.jsxs(sr,{activationMode:"manual",defaultValue:u.resourceImage==="both"||u.resourceImage==="upload"?"upload":"link",children:[t.jsxs(xt,{className:"richtext-grid richtext-w-full richtext-grid-cols-2",children:[u.resourceImage==="both"||u.resourceImage==="upload"?t.jsx(Te,{value:"upload",children:r("editor.image.dialog.tab.upload")}):t.jsx(t.Fragment,{}),u.resourceImage==="both"||u.resourceImage==="link"?t.jsx(Te,{value:"link",children:r("editor.image.dialog.tab.url")}):t.jsx(t.Fragment,{})]}),t.jsxs("div",{className:"richtext-my-[10px] richtext-flex richtext-items-center richtext-gap-[4px]",children:[t.jsx(xr,{checked:l,onCheckedChange:p=>{h(p)}}),t.jsx(ee,{children:r("editor.link.dialog.inline")})]}),t.jsxs(Ne,{value:"upload",children:[t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-gap-[10px]",children:[t.jsx(q,{className:"richtext-mt-1 richtext-w-full",onClick:f,size:"sm",children:r("editor.image.dialog.tab.upload")}),t.jsx(Zi,{editor:e.editor,imageInline:l,onClose:()=>vr.setOpen(e.editor.id,!1)})]}),t.jsx("input",{accept:"image/*",multiple:!0,onChange:x,ref:d,type:"file",style:{display:"none"}})]}),t.jsx(Ne,{value:"link",children:t.jsx("form",{onSubmit:m,children:t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-gap-2",children:[t.jsx(Z,{autoFocus:!0,onChange:p=>c(p.target.value),placeholder:r("editor.image.dialog.placeholder"),required:!0,type:"url",value:o}),t.jsx(q,{type:"submit",children:r("editor.image.dialog.button.apply")})]})})})]})]})]})}const Pe={TOP_LEFT:"tl",TOP_RIGHT:"tr",BOTTOM_LEFT:"bl",BOTTOM_RIGHT:"br"};function Yi(e){var I,y;const[r,i]=a.useState({width:S.IMAGE_MAX_SIZE,height:S.IMAGE_MAX_SIZE}),[n,s]=a.useState({width:0,height:0}),[o]=a.useState([Pe.TOP_LEFT,Pe.TOP_RIGHT,Pe.BOTTOM_LEFT,Pe.BOTTOM_RIGHT]),[c,d]=a.useState(!1),[l,h]=a.useState({x:0,y:0,w:0,h:0,dir:""}),{align:u,inline:x}=(I=e==null?void 0:e.node)==null?void 0:I.attrs,m=a.useMemo(()=>{var te;const{src:A,alt:v,width:T,height:B,flipX:D,flipY:z}=(te=e==null?void 0:e.node)==null?void 0:te.attrs,M=_.isNumber(T)?`${T}px`:T,$=_.isNumber(B)?`${B}px`:B,F=[];D&&F.push("rotateX(180deg)"),z&&F.push("rotateY(180deg)");const X=F.join(" ");return{src:A||void 0,alt:v||void 0,style:{width:M||void 0,height:$||void 0,transform:X||"none"}}},[(y=e==null?void 0:e.node)==null?void 0:y.attrs]),f=a.useMemo(()=>{const{style:{width:A}}=m;return{width:A==="100%"?A:void 0}},[m]);function w(A){s({width:A.target.width,height:A.target.height})}function p(){const{editor:A,getPos:v}=e;A.commands.setNodeSelection(v())}const g=a.useCallback(_.throttle(()=>{const{editor:A}=e,{width:v}=getComputedStyle(A.view.dom);i(T=>({...T,width:Number.parseInt(v,10)}))},S.IMAGE_THROTTLE_WAIT_TIME),[e==null?void 0:e.editor]);function H(A,v){A.preventDefault(),A.stopPropagation();const T=n.width,B=n.height,D=T/B;let z=Number(e.node.attrs.width),M=Number(e.node.attrs.height);const $=r.width;z&&!M?(z=z>$?$:z,M=Math.round(z/D)):M&&!z?(z=Math.round(M*D),z=z>$?$:z):!z&&!M?(z=T>$?$:T,M=Math.round(z/D)):z=z>$?$:z,d(!0),h({x:A.clientX,y:A.clientY,w:z,h:M,dir:v})}const N=a.useCallback(_.throttle(A=>{if(A.preventDefault(),A.stopPropagation(),!c)return;const{x:v,w:T,dir:B}=l,D=(A.clientX-v)*(/l/.test(B)?-1:1),z=_.clamp(T+D,S.IMAGE_MIN_SIZE,r.width);e.updateAttributes({width:z,height:null})},S.IMAGE_THROTTLE_WAIT_TIME),[c,l,r,e.updateAttributes]),C=a.useCallback(A=>{A.preventDefault(),A.stopPropagation(),c&&(h({x:0,y:0,w:0,h:0,dir:""}),d(!1),p())},[c,p]),b=a.useCallback(()=>{document==null||document.addEventListener("mousemove",N,!0),document==null||document.addEventListener("mouseup",C,!0)},[N,C]),k=a.useCallback(()=>{document==null||document.removeEventListener("mousemove",N,!0),document==null||document.removeEventListener("mouseup",C,!0)},[N,C]);a.useEffect(()=>(c?b():k(),()=>{k()}),[c,b,k]);const P=a.useMemo(()=>new ResizeObserver(()=>g()),[g]);return a.useEffect(()=>(P.observe(e.editor.view.dom),()=>{P.disconnect()}),[e.editor.view.dom,P]),t.jsx(R.NodeViewWrapper,{as:x?"span":"div",className:"image-view",style:{...f,textAlign:u,display:x?"inline":"block"},children:t.jsxs("div",{"data-drag-handle":!0,draggable:"true",style:f,className:`image-view__body ${e!=null&&e.selected?"image-view__body--focused":""} ${c?"image-view__body--resizing":""}`,children:[t.jsx("img",{alt:m.alt,className:"image-view__body__image block",height:"auto",onClick:p,onLoad:w,src:m.src,style:m.style}),(e==null?void 0:e.editor.view.editable)&&((e==null?void 0:e.selected)||c)&&t.jsx("div",{className:"image-resizer",children:o==null?void 0:o.map(A=>t.jsx("span",{className:`image-resizer__handler image-resizer__handler--${A}`,onMouseDown:v=>H(v,A)},`image-dir-${A}`))})]})})}const pe=new _.PluginKey("upload-image");function Ji(){return new _.Plugin({key:pe,state:{init(){return _.DecorationSet.empty},apply(e,r){r=r.map(e.mapping,e.doc);const i=e.getMeta(pe);if(i!=null&&i.add)for(const{id:n,pos:s,src:o}of i.add){const c=Qi(o),d=_.Decoration.widget(s,c,{id:n});r=r.add(e.doc,[d])}else if(i!=null&&i.remove)for(const n of i.remove)r=r.remove(r.find(void 0,void 0,s=>s.id===n));return r}},props:{decorations(e){return this.getState(e)}}})}function Qi(e){const r=document.createElement("div"),i=document.createElement("img");return i.setAttribute("class","opacity-50"),i.src=e,i.addEventListener("load",()=>{r.setAttribute("class","img-placeholder")}),r.append(i),r}function en(e,r){var s;const n=pe.getState(e).find(void 0,void 0,o=>o.id===r);return n.length>0?(s=n[0])==null?void 0:s.from:null}function tn({validateFn:e,onUpload:r,postUpload:i,defaultInline:n=!1}){return(s,o,c)=>{for(const d of s){if(e&&!e(d))continue;const l=Date.now().toString(),h=o.state.tr;h.selection.empty||h.deleteSelection();const u=URL.createObjectURL(d);h.setMeta(pe,{add:[{id:l,pos:c,src:u}]}),o.dispatch(h),r(d).then(async x=>{var N;i&&typeof x=="string"&&(x=await i(x));const{schema:m}=o.state;let f=en(o.state,l);if(f===null)return;const w=typeof x=="object"?u:x,p=(N=m.nodes.image)==null?void 0:N.create({src:w,inline:n});if(!p)return;const{doc:g}=o.state;f>g.content.size&&(f=g.content.size-1);const H=o.state.tr.replaceWith(f,f,p).setMeta(pe,{remove:[l]});o.dispatch(H)},()=>{const x=o.state.tr.delete(c,c).setMeta(pe,{remove:[l]});o.dispatch(x)})}}}function rn(e,r,i){var s;const n=[...((s=r.clipboardData)==null?void 0:s.files)||[]];if(n.length>0){r.preventDefault();const o=e.state.selection.from;return i(n,e,o+1),!0}return!1}function nn(e,r,i,n){var o;const s=[...((o=r.dataTransfer)==null?void 0:o.files)||[]];if(!i&&s.length>0){r.preventDefault();const c=e.posAtCoords({left:r.clientX,top:r.clientY});if(c)return n(s,e,c.pos+1),!0}return!1}const on={acceptMimes:["image/jpeg","image/gif","image/png","image/jpg"],maxSize:1024*1024*5,resourceImage:"both",defaultInline:!1},we=R.Image.extend({group:"inline",inline:!0,defining:!0,draggable:!0,selectable:!0,addOptions(){var e;return{...on,...(e=this.parent)==null?void 0:e.call(this),upload:()=>Promise.reject("Image Upload Function"),button:({editor:r,extension:i,t:n})=>{var s,o;return{component:Ki,componentProps:{action:()=>!0,upload:i.options.upload,disabled:!((o=(s=r.can()).setImage)!=null&&o.call(s,{})),icon:"ImageUp",tooltip:n("editor.image.tooltip"),editor:r}}}}},addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),flipX:{default:!1},flipY:{default:!1},width:{default:null,parseHTML:r=>{const i=r.style.width||r.getAttribute("width")||null;return i?Number.parseInt(i,10):null},renderHTML:r=>({width:r.width})},align:{default:"center",parseHTML:r=>r.getAttribute("align"),renderHTML:r=>({align:r.align})},inline:{default:!1,parseHTML:r=>!!r.getAttribute("inline"),renderHTML:r=>({inline:r.inline})}}},addNodeView(){return R.ReactNodeViewRenderer(Yi)},addCommands(){var e;return{...(e=this.parent)==null?void 0:e.call(this),setImageInline:r=>({commands:i})=>i.insertContent({type:this.name,attrs:{...r,inline:r.inline??this.options.defaultInline}}),updateImage:r=>({commands:i})=>i.updateAttributes(this.name,r),setAlignImage:r=>({commands:i})=>i.updateAttributes(this.name,{align:r})}},renderHTML({HTMLAttributes:e}){const{flipX:r,flipY:i,align:n,inline:s}=e,o=r||i?`transform: rotateX(${r?"180":"0"}deg) rotateY(${i?"180":"0"}deg);`:"",c=n?`text-align: ${n};`:"";return[s?"span":"div",{style:c,class:"image"},["img",R.mergeAttributes({height:"auto",style:o},this.options.HTMLAttributes,e)]]},parseHTML(){return[{tag:"span.image img",getAttrs:e=>{var o;const r=e==null?void 0:e.parentElement,i=e==null?void 0:e.getAttribute("width"),n=(e==null?void 0:e.getAttribute("flipx"))||!1,s=(e==null?void 0:e.getAttribute("flipy"))||!1;return{src:e==null?void 0:e.getAttribute("src"),alt:e==null?void 0:e.getAttribute("alt"),caption:e==null?void 0:e.getAttribute("caption"),width:i?Number.parseInt(i,10):null,align:(e==null?void 0:e.getAttribute("align"))||((o=r==null?void 0:r.style)==null?void 0:o.textAlign)||null,inline:(e==null?void 0:e.getAttribute("inline"))||!1,flipX:n==="true",flipY:s==="true"}}},{tag:"div[class=image]",getAttrs:e=>{const r=e.querySelector("img"),i=r==null?void 0:r.getAttribute("width"),n=(r==null?void 0:r.getAttribute("flipx"))||!1,s=(r==null?void 0:r.getAttribute("flipy"))||!1;return{src:r==null?void 0:r.getAttribute("src"),alt:r==null?void 0:r.getAttribute("alt"),caption:r==null?void 0:r.getAttribute("caption"),width:i?Number.parseInt(i,10):null,align:(r==null?void 0:r.getAttribute("align"))||e.style.textAlign||null,inline:(r==null?void 0:r.getAttribute("inline"))||!1,flipX:n==="true",flipY:s==="true"}}}]},addProseMirrorPlugins(){const r=tn({validateFn:i=>!(!this.options.acceptMimes.includes(i.type)||i.size>this.options.maxSize),onUpload:this.options.upload,defaultInline:this.options.defaultInline});return[new _.Plugin({props:{handlePaste:(i,n)=>!n.clipboardData||[...n.clipboardData.files||[]].some(o=>o.type==="text/html")?!1:rn(i,n,r),handleDrop:(i,n,s,o)=>(!(n instanceof DragEvent)||!n.dataTransfer||nn(i,n,o,r),!1)}}),Ji()]}});function sn(e){return/\.(?:mp4|webm|ogg|mov)$/i.test(e)}function cn(e){const{t:r}=S.useLocale(),[i,n]=a.useState(""),s=a.useRef(null),[o,c]=a.useState(""),[d,l]=a.useState(!1),h=w=>{l(w.detail)};a.useEffect(()=>{const w=ye(se.UPLOAD_VIDEO(e.editor.id),h);return()=>{w()}},[]);const u=a.useMemo(()=>{var p;return(p=e.editor.extensionManager.extensions.find(g=>g.name===vt.name))==null?void 0:p.options},[e.editor]);async function x(w){var N;const p=(N=w==null?void 0:w.target)==null?void 0:N.files;if(!e.editor||e.editor.isDestroyed||p.length===0)return;const g=p[0];let H="";u.upload?H=await u.upload(g):H=URL.createObjectURL(g),e.editor.chain().focus().setVideo({src:H,width:"100%"}).run(),l(!1)}function m(w){w.preventDefault(),w.stopPropagation(),i&&(e.editor.chain().focus().setVideo({src:i,width:"100%"}).run(),l(!1))}function f(w){var p;w.preventDefault(),(p=s.current)==null||p.click()}return t.jsxs(ae,{onOpenChange:l,open:d,children:[t.jsx(le,{asChild:!0,children:t.jsx(O,{action:()=>l(!0),icon:e.icon,tooltip:e.tooltip})}),t.jsxs(ne,{children:[t.jsx(oe,{children:r("editor.video.dialog.title")}),t.jsxs(sr,{activationMode:"manual",defaultValue:(u==null?void 0:u.resourceVideo)==="both"||(u==null?void 0:u.resourceVideo)==="upload"?"upload":"link",children:[t.jsxs(xt,{className:"richtext-grid richtext-w-full richtext-grid-cols-2",children:[((u==null?void 0:u.resourceVideo)==="both"||(u==null?void 0:u.resourceVideo)==="upload")&&t.jsx(Te,{value:"upload",children:r("editor.video.dialog.tab.upload")}),((u==null?void 0:u.resourceVideo)==="both"||(u==null?void 0:u.resourceVideo)==="link")&&t.jsx(Te,{value:"link",children:r("editor.video.dialog.link")})]}),t.jsxs(Ne,{value:"upload",children:[t.jsx("div",{className:"richtext-flex richtext-items-center richtext-gap-[10px]",children:t.jsx(q,{className:"richtext-mt-1 richtext-w-full",onClick:f,size:"sm",children:r("editor.video.dialog.tab.upload")})}),t.jsx("input",{accept:"video/*",multiple:!0,onChange:x,ref:s,type:"file",style:{display:"none"}})]}),t.jsxs(Ne,{value:"link",children:[t.jsx("form",{onSubmit:m,children:t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-gap-2",children:[t.jsx(Z,{autoFocus:!0,placeholder:r("editor.video.dialog.placeholder"),required:!0,type:"url",value:i,onChange:w=>{const p=w.target.value;if(!sn(p)){c("Invalid video URL"),n("");return}c(""),n(p)}}),t.jsx(q,{type:"submit",children:r("editor.video.dialog.button.apply")})]})}),o&&t.jsx("div",{className:"richtext-my-[5px] richtext-text-red-500",children:o})]})]})]})]})}function an(e){return e=e.replace("https://youtu.be/","https://www.youtube.com/watch?v=").replace("watch?v=","embed/"),e=e.replace("https://vimeo.com/","https://player.vimeo.com/video/"),/^https?:\/\/www.bilibili.com\/video\/.*/i.test(e)&&(e=e.replace(/\?.*$/,"").replace("https://www.bilibili.com/video/","https://player.bilibili.com/player.html?bvid=")),e.includes("drive.google.com")&&(e=e.replace("/view","/preview")),e}const vt=R.Node.create({name:"video",group:"block",atom:!0,draggable:!0,addOptions(){return{divider:!1,spacer:!1,allowFullscreen:!0,upload:void 0,frameborder:!1,resourceVideo:"both",width:S.VIDEO_SIZE["size-medium"],HTMLAttributes:{class:"iframe-wrapper",style:"display: flex;justify-content: center;"},button:({editor:e,t:r})=>{var i,n;return{component:cn,componentProps:{action:()=>{},isActive:()=>e.isActive("video")||!1,disabled:!((n=(i=e.can()).setVideo)!=null&&n.call(i,{})),icon:"Video",tooltip:r("editor.video.tooltip"),editor:e}}}}},addAttributes(){return{src:{default:null,renderHTML:({src:e})=>({src:e?an(e):null})},width:{default:this.options.width,renderHTML:({width:e})=>({width:ei(e)})},frameborder:{default:this.options.frameborder?1:0,parseHTML:()=>this.options.frameborder?1:0},allowfullscreen:{default:this.options.allowFullscreen,parseHTML:()=>this.options.allowFullscreen}}},parseHTML(){return[{tag:"div[data-video] iframe"}]},renderHTML({HTMLAttributes:e}){const{width:r="100%"}=e??{},i={...e,width:"100%",height:"100%"},n=`position: relative;overflow: hidden;display: flex;flex: 1;max-width: ${r};`,s=`flex: 1;padding-bottom: ${9/16*100}%;`,d=["div",{style:n},["div",{style:s}],["iframe",i]];return["div",{...this.options.HTMLAttributes,"data-video":""},d]},addCommands(){return{setVideo:e=>({commands:r})=>r.insertContent({type:this.name,attrs:e}),updateVideo:e=>({commands:r})=>r.updateAttributes(this.name,e)}}}),ln="_wrap_5y04w_1",dn="_innerWrap_5y04w_15",Et={wrap:ln,innerWrap:dn};function hn({editor:e,node:r,updateAttributes:i}){const n=Qt(),{url:s,width:o,height:c}=r.attrs,[d,l]=a.useState("");function h(){d&&e.chain().updateAttributes(de.name,{url:d}).setNodeSelection(e.state.selection.from).focus().run()}const u=a.useCallback(x=>{i({width:x.width,height:x.height})},[i]);return t.jsxs(R.NodeViewWrapper,{children:[!s&&t.jsxs("div",{className:"richtext-mx-auto richtext-my-[12px] richtext-flex richtext-max-w-[600px] richtext-items-center richtext-justify-center richtext-gap-[10px] richtext-rounded-[12px] richtext-border richtext-border-solid richtext-border-[#ccc] richtext-p-[10px]",children:[t.jsx(Z,{autoFocus:!0,className:"richtext-flex-1",onInput:x=>l(x.target.value),placeholder:"Enter link",type:"url",value:d}),t.jsx(q,{className:"richtext-w-[60px]",onClick:h,children:"OK"})]}),s&&t.jsx($r.Resizable,{size:{width:Number.parseInt(o),height:Number.parseInt(c)},onResizeStop:(x,m,f,w)=>{u({width:Number.parseInt(o)+w.width,height:Number.parseInt(c)+w.height})},children:t.jsx("div",{className:_.clsx(Et.wrap,"render-wrapper"),children:t.jsx("div",{className:Et.innerWrap,style:{pointerEvents:n?"none":"auto"},children:t.jsx("iframe",{className:"richtext-my-[12px] ",src:s})})})})]})}function $e(e,r=!1){return i=>{const n=e.startsWith("data-")?e:`data-${e}`;let s=decodeURIComponent(i.getAttribute(n));if(s==null||typeof s=="string"&&s==="null")try{const d=i.outerHTML.match(/([\S\s])+?="([\S\s])+?"/g);d&&d.length>0&&(s=(d.map(h=>h.trim()).reduce((h,u)=>{const x=u.indexOf("="),m=[u.slice(0,x),u.slice(x+1).slice(1,-1)];return h[m[0]]=m[1],h},{})[e.toLowerCase()]||"").replaceAll("&quot;",'"'))}catch(c){console.error("Error getDatasetAttribute ",c.message,i)}if(r)try{return JSON.parse(s)}catch{return{}}if(s.includes("%")||s.includes("auto"))return s;const o=Number.parseInt(s);return o!==o?s:o}}const de=R.Node.create({name:"iframe",content:"",marks:"",group:"block",selectable:!0,atom:!0,draggable:!0,addOptions(){var e;return{...(e=this.parent)==null?void 0:e.call(this),HTMLAttributes:{class:"iframe"},button:({editor:r,extension:i,t:n})=>({component:O,componentProps:{action:s=>r.commands.setIframe(s),upload:i.options.upload,disabled:!r.can().setIframe({}),icon:"Iframe",tooltip:n("editor.iframe.tooltip")}})}},addAttributes(){return{width:{default:600,parseHTML:$e("width")},height:{default:300,parseHTML:$e("height")},url:{default:null,parseHTML:$e("url")},defaultShowPicker:{default:!1},frameborder:{default:0},allowfullscreen:{default:this.options.allowFullscreen,parseHTML:()=>this.options.allowFullscreen}}},parseHTML(){return[{tag:"iframe"}]},renderHTML({HTMLAttributes:e}){return["iframe",R.mergeAttributes(this.options.HTMLAttributes,e)]},addCommands(){return{setIframe:e=>({tr:r,commands:i,chain:n})=>{var o,c,d;if(((d=(c=(o=r.selection)==null?void 0:o.node)==null?void 0:c.type)==null?void 0:d.name)==this.name)return i.updateAttributes(this.name,e);const s=e||{url:""};return n().insertContent({type:this.name,attrs:s}).run()}}},addInputRules(){return[R.nodeInputRule({find:/^\$iframe\$$/,type:this.type,getAttributes:()=>({width:"100%"})})]},addNodeView(){return R.ReactNodeViewRenderer(hn)}}),Ie=V.forwardRef(({className:e,...r},i)=>t.jsx("textarea",{className:L("richtext-flex richtext-min-h-[80px] richtext-w-full richtext-rounded-md !richtext-border richtext-border-input richtext-bg-background richtext-px-3 richtext-py-2 richtext-text-sm richtext-ring-offset-background placeholder:richtext-text-muted-foreground focus-visible:richtext-outline-none focus-visible:richtext-ring-2 focus-visible:richtext-ring-ring focus-visible:richtext-ring-offset-2 disabled:richtext-cursor-not-allowed disabled:richtext-opacity-50",e),ref:i,...r}));Ie.displayName="Textarea";function un(e){return e}function Le(e,r,i,n){const s=un,[o,c]=a.useState(s(i)),d=a.useRef(o);return a.useEffect(()=>{const l=()=>{const h={...i,...e.getAttributes(r)};Object.keys(h).forEach(x=>{(h[x]===null||h[x]===void 0)&&(h[x]=i?i[x]:null)});const u=s(h);_.deepEqual(d.current,u)||(c(u),d.current=u)};return e.on("selectionUpdate",l),e.on("transaction",l),()=>{e.off("selectionUpdate",l),e.off("transaction",l)}},[e,i,r,s]),o}function xn({editor:e,...r}){const{t:i}=S.useLocale(),n=Le(e,he.name,{text:"",defaultShowPicker:!1}),{text:s,defaultShowPicker:o}=n,[c,d]=a.useState(""),l=a.useCallback(()=>{e.chain().focus().setKatex({text:c}).run(),d("")},[e,c]);a.useEffect(()=>{o&&e.chain().updateAttributes(he.name,{defaultShowPicker:!1}).focus().run()},[e,o]);const h=a.useMemo(()=>{try{return lt.renderToString(`${c}`)}catch{return c}},[c]),u=a.useMemo(()=>`${c}`.trim()?t.jsx("span",{contentEditable:!1,dangerouslySetInnerHTML:{__html:h||""}}):null,[c,h]);return t.jsxs(xe,{modal:!0,children:[t.jsx(me,{asChild:!0,children:t.jsx(O,{icon:r==null?void 0:r.icon,tooltip:r==null?void 0:r.tooltip})}),t.jsxs(ce,{align:"start",className:"richtext-size-full richtext-p-2",hideWhenDetached:!0,side:"bottom",children:[t.jsx(ee,{className:"richtext-mb-[6px]",children:i("editor.formula.dialog.text")}),t.jsx("div",{className:"richtext-mb-[16px] richtext-flex richtext-w-full richtext-max-w-sm richtext-items-center richtext-gap-1.5",children:t.jsx("div",{className:"richtext-relative richtext-w-full richtext-max-w-sm",children:t.jsx(Ie,{autoFocus:!0,className:"richtext-w-full",defaultValue:s,onChange:x=>d(x.target.value),placeholder:"Text",required:!0,rows:3,value:c})})}),u&&t.jsx("div",{className:"richtext-my-[10px] richtext-max-w-[286px] richtext-overflow-auto richtext-whitespace-nowrap richtext-rounded-[6px] !richtext-border richtext-p-[10px]",children:u}),t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-justify-between richtext-gap-[6px]",children:[t.jsx(q,{className:"richtext-flex-1",onClick:l,children:"Submit"}),t.jsx("a",{href:"https://katex.org/docs/supported",rel:"noreferrer noopener",target:"_blank",children:t.jsx(j.HelpCircle,{size:16})})]})]})]})}function mn(){const[e]=Jt(r=>r.value);return e}const fn={setTheme:(e,r)=>{Ge(se.UPDATE_THEME(e),r)}};function gn(e,r=1){let i=0,n=0,s=0;if(e.startsWith("rgb")){const o=e.replace(/\s/g,"").match(/rgb\((.*)\)$/)[1].split(",");i=+o[0],n=+o[1],s=+o[2]}else if(e.startsWith("#")){let o=e.replace("#","");o.length===3&&(o=`${o[0]}${o[0]}${o[1]}${o[1]}${o[2]}${o[2]}`),i=Number.parseInt(o.substring(0,2),16),n=Number.parseInt(o.substring(2,4),16),s=Number.parseInt(o.substring(4,6),16)}else return e;return r>1&&r<=100&&(r=r/100),`rgba(${i},${n},${s},${r})`}function pn({node:e}){const r=mn(),{text:i}=e.attrs,n=a.useMemo(()=>{const c="rgb(254, 242, 237)";return r==="dark"?gn(c,.75):c},[r]),s=a.useMemo(()=>{try{return lt.renderToString(`${i}`)}catch{return i}},[i]),o=a.useMemo(()=>i.trim()?t.jsx("span",{contentEditable:!1,dangerouslySetInnerHTML:{__html:s}}):t.jsx("span",{contentEditable:!1,children:"Not enter a formula"}),[i,s]);return t.jsx(R.NodeViewWrapper,{style:{display:"inline-block",backgroundColor:n},as:"span",children:o})}function wn(e){return r=>r.getAttribute(e)}const he=R.Node.create({name:"katex",group:"inline",inline:!0,defining:!0,draggable:!0,selectable:!0,addOptions(){return{HTMLAttributes:{class:"katex"},button:({editor:e,t:r})=>({component:xn,componentProps:{editor:e,action:()=>!0,isActive:()=>!1,disabled:!1,icon:"KatexIcon",tooltip:r("editor.katex.tooltip")}})}},addAttributes(){return{text:{default:"",parseHTML:wn("text")},defaultShowPicker:{default:!1}}},parseHTML(){return[{tag:"span.katex"}]},renderHTML({HTMLAttributes:e}){return["span",R.mergeAttributes(this.options&&this.options.HTMLAttributes||{},e)]},addCommands(){return{setKatex:e=>({commands:r})=>r.insertContent({type:this.name,attrs:e})}},addInputRules(){return[R.nodeInputRule({find:/^\$katex\$$/,type:this.type,getAttributes:()=>({defaultShowPicker:!0})})]},addNodeView(){return R.ReactNodeViewRenderer(pn)}});function vn({selectImage:e,giphyApiKey:r,children:i}){const[n,s]=a.useState([]),[o]=a.useState(15),c=a.useRef(null),d=(h,u="search")=>{if(!r)return;const m=`${u==="search"?`https://api.giphy.com/v1/gifs/search?q=${h}`:`https://api.giphy.com/v1/gifs/trending?q=${h}`}&limit=${o}&api_key=${r}`;fetch(m).then(f=>f.json()).then(f=>{s(f.data)}).catch(f=>{console.log(f)})};a.useEffect(()=>{d("","trend")},[]);const l=a.useCallback(_.debounce(h=>{if(!h.target.value){d("","trend");return}d(h.target.value)},350),[]);return t.jsxs(xe,{modal:!0,children:[t.jsx(me,{asChild:!0,children:i}),t.jsx(ce,{align:"start",className:"richtext-size-full richtext-p-2",hideWhenDetached:!0,side:"bottom",children:r?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"richtext-mb-[10px] richtext-w-full",children:t.jsx(Z,{onChange:l,placeholder:"Search GIF",ref:c,type:"text"})}),t.jsx("div",{className:"richtext-max-h-[280px] richtext-overflow-y-auto",children:t.jsx("div",{className:"richtext-grid richtext-grid-cols-2 richtext-gap-1 ",children:n!=null&&n.length?n==null?void 0:n.map(h=>t.jsx("img",{alt:"giphy",className:"richtext-cursor-pointer richtext-text-center",height:h.images.fixed_width_downsampled.height,onClick:()=>e(h),src:h.images.fixed_width_downsampled.url,width:h.images.fixed_width_downsampled.width},`giphy-${h.id}`)):t.jsx("p",{children:"No GIFs found"})})})]}):t.jsx("div",{children:t.jsx("p",{children:"Missing Giphy API Key"})})})]})}function bn({editor:e,icon:r,giphyApiKey:i,...n}){const s=o=>{const{url:c}=o.images.original;e.chain().focus().setImageGif({src:c}).run()};return t.jsx(vn,{giphyApiKey:i,selectImage:s,children:t.jsx(O,{icon:r,tooltip:n==null?void 0:n.tooltip})})}const ze={TOP_LEFT:"tl",TOP_RIGHT:"tr",BOTTOM_LEFT:"bl",BOTTOM_RIGHT:"br"};function jn(e){var P,I;const[r,i]=a.useState({width:S.IMAGE_MAX_SIZE,height:S.IMAGE_MAX_SIZE}),[n,s]=a.useState({width:0,height:0}),[o]=a.useState([ze.TOP_LEFT,ze.TOP_RIGHT,ze.BOTTOM_LEFT,ze.BOTTOM_RIGHT]),[c,d]=a.useState(!1),[l,h]=a.useState({x:0,y:0,w:0,h:0,dir:""}),{align:u}=(P=e==null?void 0:e.node)==null?void 0:P.attrs,x=a.useMemo(()=>{var z;const{src:y,alt:A,width:v,height:T}=(z=e==null?void 0:e.node)==null?void 0:z.attrs,B=_.isNumber(v)?`${v}px`:v,D=_.isNumber(T)?`${T}px`:T;return{src:y||void 0,alt:A||void 0,style:{width:B||void 0,height:D||void 0}}},[(I=e==null?void 0:e.node)==null?void 0:I.attrs]),m=a.useMemo(()=>{const{style:{width:y}}=x;return{width:y==="100%"?y:void 0}},[x]);function f(y){s({width:y.target.width,height:y.target.height})}function w(){const{editor:y,getPos:A}=e;y.commands.setNodeSelection(A())}const p=a.useCallback(_.throttle(()=>{const{editor:y}=e,{width:A}=getComputedStyle(y.view.dom);i(v=>({...v,width:Number.parseInt(A,10)}))},S.IMAGE_THROTTLE_WAIT_TIME),[e==null?void 0:e.editor]);function g(y,A){y.preventDefault(),y.stopPropagation();const v=n.width,T=n.height,B=v/T;let D=Number(e.node.attrs.width),z=Number(e.node.attrs.height);const M=r.width;D&&!z?(D=D>M?M:D,z=Math.round(D/B)):z&&!D?(D=Math.round(z*B),D=D>M?M:D):!D&&!z?(D=v>M?M:v,z=Math.round(D/B)):D=D>M?M:D,d(!0),h({x:y.clientX,y:y.clientY,w:D,h:z,dir:A})}const H=a.useCallback(_.throttle(y=>{if(y.preventDefault(),y.stopPropagation(),!c)return;const{x:A,w:v,dir:T}=l,B=(y.clientX-A)*(/l/.test(T)?-1:1),D=_.clamp(v+B,S.IMAGE_MIN_SIZE,r.width);e.updateAttributes({width:D,height:null})},S.IMAGE_THROTTLE_WAIT_TIME),[c,l,r,e.updateAttributes]),N=a.useCallback(y=>{y.preventDefault(),y.stopPropagation(),c&&(h({x:0,y:0,w:0,h:0,dir:""}),d(!1),w())},[c,w]),C=a.useCallback(()=>{document==null||document.addEventListener("mousemove",H,!0),document==null||document.addEventListener("mouseup",N,!0)},[H,N]),b=a.useCallback(()=>{document==null||document.removeEventListener("mousemove",H,!0),document==null||document.removeEventListener("mouseup",N,!0)},[H,N]);a.useEffect(()=>(c?C():b(),()=>{b()}),[c,C,b]);const k=a.useMemo(()=>new ResizeObserver(()=>p()),[p]);return a.useEffect(()=>(k.observe(e.editor.view.dom),()=>{k.disconnect()}),[e.editor.view.dom,k]),t.jsx(R.NodeViewWrapper,{className:"image-view",style:{...m,width:"100%",textAlign:u},children:t.jsxs("div",{"data-drag-handle":!0,draggable:"true",style:m,className:`image-view__body ${e!=null&&e.selected?"image-view__body--focused":""} ${c?"image-view__body--resizing":""}`,children:[t.jsx("img",{alt:x.alt,className:"image-view__body__image block",height:"auto",onClick:w,onLoad:f,src:x.src,style:x.style}),(e==null?void 0:e.editor.view.editable)&&((e==null?void 0:e.selected)||c)&&t.jsx("div",{className:"image-resizer",children:o==null?void 0:o.map(y=>t.jsx("span",{className:`image-resizer__handler image-resizer__handler--${y}`,onMouseDown:A=>g(A,y)},`image-dir-${y}`))})]})})}const bt=R.Image.extend({name:"imageGif",addOptions(){var e;return{...(e=this.parent)==null?void 0:e.call(this),inline:!1,content:"",marks:"",group:"block",GIPHY_API_KEY:"",draggable:!1,selectable:!0,atom:!0,button:({editor:r,extension:i,t:n})=>{var o;const s=((o=i==null?void 0:i.options)==null?void 0:o.GIPHY_API_KEY)||"";return{component:bn,componentProps:{editor:r,action:()=>{},isActive:()=>!1,disabled:!1,icon:"GifIcon",tooltip:n("editor.imageGif.tooltip"),giphyApiKey:s}}}}},addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),width:{default:null,parseHTML:r=>{const i=r.style.width||r.getAttribute("width")||"10";return i===void 0?null:Number.parseInt(`${i}`,10)},renderHTML:r=>({width:r.width})},align:{default:"center",parseHTML:r=>r.getAttribute("align"),renderHTML:r=>({align:r.align})}}},addNodeView(){return R.ReactNodeViewRenderer(jn)},addCommands(){var e;return{...(e=this.parent)==null?void 0:e.call(this),setImageGif:r=>({commands:i})=>i.insertContent({type:this.name,attrs:r}),updateImageGif:r=>({commands:i})=>i.updateAttributes(this.name,r),setAlignImageGif:r=>({commands:i})=>i.updateAttributes(this.name,{align:r})}},renderHTML({HTMLAttributes:e}){const{align:r}=e;return["div",{style:r?`text-align: ${r};`:"",class:"imageGIf"},["img",R.mergeAttributes({height:"auto"},this.options.HTMLAttributes,e)]]},parseHTML(){return[{tag:"div[class=imageGIf]",getAttrs:e=>{const r=e.querySelector("img"),i=r==null?void 0:r.getAttribute("width");return{src:r==null?void 0:r.getAttribute("src"),alt:r==null?void 0:r.getAttribute("alt"),title:r==null?void 0:r.getAttribute("title"),width:i?Number.parseInt(i,10):null,align:(r==null?void 0:r.getAttribute("align"))||e.style.textAlign||null}}}]}});function Xe(e=8){return Math.random().toString(36).substring(2,e+2)}const Rt=`graph TB
a-->b`,Cn=({editor:e,upload:r})=>{const[i,n]=a.useState(Rt),[s,o]=a.useState(""),[c,d]=a.useState(!1),l=a.useRef(null),h=async m=>{try{const{svg:f}=await Ve.render("mermaid-svg",m);o(f)}catch{o("")}},u=()=>{Ve.initialize({darkMode:!1,startOnLoad:!1,fontSize:12,theme:"base"}),h(i)};a.useEffect(()=>{c&&u()},[c]),a.useEffect(()=>{c&&h(i)},[i]);const x=async()=>{if(i!==""){if(i){const m=l.current.querySelector("svg"),{width:f,height:w}=m.getBoundingClientRect(),p=`mermaid-${Xe()}.svg`;let g=_.i(m.outerHTML);if(r){const H=Ae(g,p);g=await r(H)}e==null||e.chain().focus().setMermaid({type:"mermaid",src:g,alt:encodeURIComponent(i),width:f,height:w},!!i).run()}d(!1)}};return t.jsxs(ae,{onOpenChange:d,open:c,children:[t.jsx(le,{asChild:!0,children:t.jsx(O,{action:()=>d(!0),icon:"Mermaid",tooltip:"Mermaid"})}),t.jsxs(ne,{className:"richtext-z-[99999] !richtext-max-w-[1300px]",children:[t.jsx(oe,{children:"Mermaid"}),t.jsx("div",{style:{height:"100%",borderWidth:1},children:t.jsxs("div",{className:"richtext-flex richtext-gap-[10px] richtext-rounded-[10px] richtext-p-[10px]",children:[t.jsx(Ie,{autoFocus:!0,className:"richtext-flex-1",defaultValue:Rt,onChange:m=>n(m.target.value),placeholder:"Text",required:!0,rows:10,value:i,style:{color:"hsl(var(--richtext-foreground))"}}),t.jsx("div",{className:"richtext-flex richtext-flex-1 richtext-items-center richtext-justify-center richtext-rounded-[10px] richtext-p-[10px]",dangerouslySetInnerHTML:{__html:s},ref:l,style:{height:"100%",borderWidth:1,minHeight:500,background:"#fff"}})]})}),t.jsx(fe,{children:t.jsx(q,{onClick:x,type:"button",children:"Save changes"})})]})]})},_e={TOP_LEFT:"tl",TOP_RIGHT:"tr",BOTTOM_LEFT:"bl",BOTTOM_RIGHT:"br"};function yn({editor:e,node:r,updateAttributes:i,getPos:n,selected:s}){const[o,c]=a.useState({width:S.IMAGE_MAX_SIZE,height:S.IMAGE_MAX_SIZE}),[d,l]=a.useState({width:0,height:0}),[h]=a.useState([_e.TOP_LEFT,_e.TOP_RIGHT,_e.BOTTOM_LEFT,_e.BOTTOM_RIGHT]),[u,x]=a.useState(!1),[m,f]=a.useState({x:0,y:0,w:0,h:0,dir:""}),{align:w}=r==null?void 0:r.attrs,p=a.useMemo(()=>{const{src:v,alt:T,width:B,height:D}=r==null?void 0:r.attrs,z=R.isNumber(B)?`${B}px`:B,M=R.isNumber(D)?`${D}px`:D;return{src:v||void 0,alt:T||void 0,style:{width:z||void 0,height:M||void 0}}},[r==null?void 0:r.attrs]),g=a.useMemo(()=>{const{style:{width:v}}=p;return{width:v==="100%"?v:void 0}},[p]);function H(v){l({width:v.target.width,height:v.target.height})}function N(){e.commands.setNodeSelection(n())}const C=a.useCallback(_.throttle(()=>{const{width:v}=getComputedStyle(e.view.dom);c(T=>({...T,width:Number.parseInt(v,10)}))},S.IMAGE_THROTTLE_WAIT_TIME),[e]);function b(v,T){v.preventDefault(),v.stopPropagation();const B=d.width,D=d.height,z=B/D;let M=Number(r.attrs.width),$=Number(r.attrs.height);const F=o.width;M&&!$?(M=M>F?F:M,$=Math.round(M/z)):$&&!M?(M=Math.round($*z),M=M>F?F:M):!M&&!$?(M=B>F?F:B,$=Math.round(M/z)):M=M>F?F:M,x(!0),f({x:v.clientX,y:v.clientY,w:M,h:$,dir:T})}const k=a.useCallback(_.throttle(v=>{if(v.preventDefault(),v.stopPropagation(),!u)return;const{x:T,w:B,dir:D}=m,z=(v.clientX-T)*(/l/.test(D)?-1:1),{width:M,height:$}=r==null?void 0:r.attrs,F=M/$,X=er(B+z,S.IMAGE_MIN_SIZE,o.width),te=Math.round(X/F);i({width:X,height:te})},S.IMAGE_THROTTLE_WAIT_TIME),[u,m,o,i,r==null?void 0:r.attrs]),P=a.useCallback(v=>{v.preventDefault(),v.stopPropagation(),u&&(f({x:0,y:0,w:0,h:0,dir:""}),x(!1),N())},[u,N]),I=a.useCallback(()=>{document==null||document.addEventListener("mousemove",k,!0),document==null||document.addEventListener("mouseup",P,!0)},[k,P]),y=a.useCallback(()=>{document==null||document.removeEventListener("mousemove",k,!0),document==null||document.removeEventListener("mouseup",P,!0)},[k,P]);a.useEffect(()=>(u?I():y(),()=>{y()}),[u,I,y]);const A=a.useMemo(()=>new ResizeObserver(()=>C()),[C]);return a.useEffect(()=>(A.observe(e.view.dom),()=>{A.disconnect()}),[e.view.dom,A]),t.jsx(R.NodeViewWrapper,{className:"image-view",style:{...g,width:"100%",textAlign:w},children:t.jsxs("div",{"data-drag-handle":!0,draggable:"true",style:{...g,background:"#fff"},className:`image-view__body ${s?"image-view__body--focused":""} ${u?"image-view__body--resizing":""}`,children:[t.jsx("img",{alt:p.alt,className:"image-view__body__image block",height:"auto",onClick:N,onLoad:H,src:p.src,style:p.style}),e.view.editable&&(s||u)&&t.jsx("div",{className:"image-resizer",children:h==null?void 0:h.map(v=>t.jsx("span",{className:`image-resizer__handler image-resizer__handler--${v}`,onMouseDown:T=>b(T,v)},`image-dir-${v}`))})]})})}const ot=R.Image.extend({name:"mermaid",addOptions(){var e;return{...(e=this.parent)==null?void 0:e.call(this),inline:!1,content:"",marks:"",group:"block",draggable:!1,selectable:!0,atom:!0,HTMLAttributes:{class:"mermaid"},button:({editor:r,t:i,extension:n})=>{var s;return{component:Cn,componentProps:{action:()=>!0,isActive:()=>!1,disabled:!1,editor:r,icon:"Mermaid",tooltip:i("editor.mermaid.tooltip"),upload:(s=n==null?void 0:n.options)==null?void 0:s.upload}}}}},addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),width:{default:null,parseHTML:r=>{const i=r.querySelector("img"),n=i==null?void 0:i.getAttribute("width");return n?Number.parseInt(n,10):320},renderHTML:r=>({width:r.width})},height:{default:null,parseHTML:r=>{const i=r.querySelector("img"),n=i==null?void 0:i.getAttribute("height");return n?Number.parseInt(n,10):212},renderHTML:r=>({height:r.height})},align:{default:"center",parseHTML:r=>r.getAttribute("align"),renderHTML:r=>({align:r.align})}}},addNodeView(){return R.ReactNodeViewRenderer(yn)},addCommands(){return{setMermaid:(e,r)=>({commands:i,editor:n})=>r?i.insertContent({type:this.name,attrs:e}):i.insertContentAt(n.state.selection.anchor,{type:this.name,attrs:e}),setAlignImageMermaid:e=>({commands:r})=>r.updateAttributes(this.name,{align:e})}},renderHTML({HTMLAttributes:e}){const{align:r}=e;return["div",{style:r?`text-align: ${r};`:"",class:"imageMermaid"},["img",R.mergeAttributes(this.options.HTMLAttributes,e)]]},parseHTML(){return[{tag:"div[class=imageMermaid]",getAttrs:e=>{const r=e.querySelector("img"),i=r==null?void 0:r.getAttribute("width"),n=r==null?void 0:r.getAttribute("height");return{src:r==null?void 0:r.getAttribute("src"),alt:r==null?void 0:r.getAttribute("alt"),width:i?Number.parseInt(i,10):null,height:n?Number.parseInt(n,10):null,align:(r==null?void 0:r.getAttribute("align"))||e.style.textAlign||null}}}]}});function Tn({node:e}){var n;const r=((n=e==null?void 0:e.attrs)==null?void 0:n.src)||"",i=r==null?void 0:r.split("/").pop();return i?t.jsx(R.NodeViewWrapper,{children:t.jsx("div",{"data-twitter":"",children:t.jsx(_.Tweet,{id:i})})}):null}function Cr(e){const{t:r}=S.useLocale(),[i,n]=a.useState("");a.useEffect(()=>{var o;if(e!=null&&e.editor){const{src:c}=(o=e.editor)==null?void 0:o.getAttributes(We.name);c&&n(c)}},[e==null?void 0:e.editor]);function s(o){o.preventDefault(),o.stopPropagation(),e==null||e.onSetLink(i)}return t.jsx("div",{className:"border-neutral-200 richtext-rounded-lg !richtext-border richtext-bg-white richtext-p-2 richtext-shadow-sm dark:richtext-border-neutral-800 dark:richtext-bg-black",children:t.jsxs("form",{className:"richtext-flex richtext-flex-col richtext-gap-2",onSubmit:s,children:[t.jsx(ee,{className:"mb-[6px]",children:r("editor.link.dialog.text")}),t.jsx("div",{className:"richtext-mb-[10px] richtext-flex richtext-w-full richtext-max-w-sm richtext-items-center richtext-gap-1.5",children:t.jsx("div",{className:"richtext-relative richtext-w-full richtext-max-w-sm richtext-items-center",children:t.jsx(Z,{className:"richtext-w-80",onChange:o=>n(o.target.value),placeholder:"Text",required:!0,type:"text",value:i})})}),t.jsx(q,{className:"richtext-mt-2 richtext-self-end",type:"submit",children:r("editor.link.dialog.button.apply")})]})})}function Nn(e){function r(i){e.action&&e.action(i)}return t.jsxs(xe,{modal:!0,children:[t.jsx(me,{disabled:e==null?void 0:e.disabled,asChild:!0,children:t.jsx(O,{tooltip:e==null?void 0:e.tooltip,isActive:e==null?void 0:e.isActive,disabled:e==null?void 0:e.disabled,children:t.jsx(U,{name:e==null?void 0:e.icon})})}),t.jsx(ce,{hideWhenDetached:!0,className:"richtext-w-full",align:"start",side:"bottom",children:t.jsx(Cr,{editor:e.editor,onSetLink:r})})]})}const Sn=/(https?:\/\/)?(www\.)?x\.com\/(\w{1,15})(\/status\/(\d+))?(\/\S*)?/g,Mn=/^https?:\/\/(www\.)?x\.com\/(\w{1,15})(\/status\/(\d+))?(\/\S*)?$/;function Pt(e){return e.match(Mn)}const We=R.Node.create({name:"twitter",draggable:!0,selectable:!0,addOptions(){return{addPasteHandler:!0,HTMLAttributes:{},inline:!1,origin:"",button:({editor:e,t:r})=>({component:Nn,componentProps:{action:i=>{e.commands.setTweet({src:i})},isActive:()=>!1,disabled:!1,icon:"Twitter",tooltip:r("editor.twitter.tooltip"),editor:e}})}},addNodeView(){return R.ReactNodeViewRenderer(Tn,{attrs:this.options.HTMLAttributes})},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},addAttributes(){return{src:{default:null}}},parseHTML(){return[{tag:"div[data-twitter]"}]},addCommands(){return{setTweet:e=>({commands:r})=>Pt(e.src)?r.insertContent({type:this.name,attrs:e}):!1,updateTweet:e=>({commands:r})=>Pt(e.src)?r.updateAttributes(this.name,{src:e.src}):!1}},addPasteRules(){return this.options.addPasteHandler?[R.nodePasteRule({find:Sn,type:this.type,getAttributes:e=>({src:e.input})})]:[]},renderHTML({HTMLAttributes:e}){return["div",R.mergeAttributes({"data-twitter":""},e)]}}),kn="_wrapper_rraz2_1",An="_tool_rraz2_17",In="_active_rraz2_37",Ln="_pen_rraz2_41",En="_line_rraz2_48",Rn="_options_rraz2_56",Pn="_colorWrap_rraz2_66",zn="_color_rraz2_66",_n="_colorActive_rraz2_83",E={wrapper:kn,tool:An,active:In,pen:Ln,line:En,options:Rn,colorWrap:Pn,color:zn,colorActive:_n};function Hn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{color:"currentColor",d:"M2 9.2v3.6M12.8 2H9.2M7.5 20H9M20 7.5V9M2.133 4.699c.155-.727.415-1.274.854-1.712c.426-.426.954-.684 1.652-.84m15.228 2.552c-.155-.727-.415-1.274-.854-1.712c-.417-.417-.932-.673-1.608-.83M4.64 19.853c-.698-.156-1.226-.414-1.652-.84c-.43-.43-.69-.965-.845-1.673m11.638 3.626c-1.812.125-3.607-8.326-2.374-9.559s9.684.561 9.559 2.373c-.087 1.187-2.095 1.656-2.037 2.711c.018.309.408.59 1.188 1.154c.543.39 1.096.77 1.629 1.175a.66.66 0 0 1 .234.687a3.35 3.35 0 0 1-2.472 2.473a.66.66 0 0 1-.688-.235c-.404-.533-.784-1.086-1.175-1.628c-.563-.78-.844-1.17-1.153-1.188c-1.055-.059-1.524 1.95-2.71 2.037",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})})}function On(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M20.06 18a4 4 0 0 1-.2-.89c-.67.7-1.48 1.05-2.41 1.05c-.83 0-1.52-.24-2.05-.71c-.53-.45-.8-1.06-.8-1.79c0-.88.33-1.56 1-2.05s1.61-.73 2.83-.73h1.4v-.64q0-.735-.45-1.17c-.3-.29-.75-.43-1.33-.43c-.52 0-.95.12-1.3.36c-.35.25-.52.54-.52.89h-1.46c0-.43.15-.84.45-1.24c.28-.4.71-.71 1.22-.94c.51-.21 1.06-.35 1.69-.35c.98 0 1.74.24 2.29.73s.84 1.16.86 2.02V16c0 .8.1 1.42.3 1.88V18zm-2.4-1.12c.45 0 .88-.11 1.29-.32c.4-.21.7-.49.88-.83v-1.57H18.7c-1.77 0-2.66.47-2.66 1.41c0 .43.15.73.46.96c.3.23.68.35 1.16.35m-12.2-3.17h4.07L7.5 8.29zM6.64 6h1.72l4.71 12h-1.93l-.97-2.57H4.82L3.86 18H1.93z",fill:"currentColor"})})}function Dn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z",fill:"currentColor"})})}function Bn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 256 256",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M253.66 106.34a8 8 0 0 0-11.32 0L192 156.69L107.31 72l50.35-50.34a8 8 0 1 0-11.32-11.32L96 60.69a16 16 0 0 0-2.82 18.81L72 100.69a16 16 0 0 0 0 22.62l4.69 4.69l-58.35 58.34a8 8 0 0 0 3.13 13.25l72 24A7.9 7.9 0 0 0 96 224a8 8 0 0 0 5.66-2.34L136 187.31l4.69 4.69a16 16 0 0 0 22.62 0l21.19-21.18a16 16 0 0 0 18.81-2.82l50.35-50.34a8 8 0 0 0 0-11.32M93.84 206.85l-55-18.35L88 139.31L124.69 176ZM152 180.69L83.31 112L104 91.31L172.69 160Z",fill:"currentColor"})})}function $n(e){return t.jsxs("svg",{height:"1em",viewBox:"0 0 16 16",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:[t.jsx("path",{d:"m2.648 9.937l7.29-7.288a2.21 2.21 0 0 1 3.124 0l2.29 2.288a2.21 2.21 0 0 1 0 3.126L10.413 13H12.5a.5.5 0 0 1 0 1H4.501a2.2 2.2 0 0 1-1.563-.647l.707-.707c.227.226.535.354.856.354h4.005a1.2 1.2 0 0 0 .848-.354l1.292-1.293l-4-4l-3.29 3.291a1.21 1.21 0 0 0 0 1.712l.29.29l-.708.707l-.29-.29a2.21 2.21 0 0 1 0-3.126M8 6h6.89a1.2 1.2 0 0 0-.246-.356L14 5H9zm2-2h3l-.645-.644a1.21 1.21 0 0 0-1.71 0zm4.89 3H7.708l1 1H14l.644-.644A1.2 1.2 0 0 0 14.891 7zM9.708 9l1.646 1.646L13 9z",fill:"currentColor"}),t.jsx("path",{d:"M14 11.5a.5.5 0 1 1-1 0a.5.5 0 0 1 1 0m1.5-.5a.5.5 0 1 0 0-1a.5.5 0 0 0 0 1m-1 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z",fill:"currentColor"})]})}function Vn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M3 3h18v18H3zm2 2v14h14V5z",fill:"currentColor"})})}function Fn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M2 20V4h20v16zm2-2h16V6H4zm0 0V6z",fill:"currentColor"})})}function Wn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m0-8",fill:"currentColor"})})}function qn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M10.363 3.591L2.257 17.125a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636-2.87L13.637 3.59a1.914 1.914 0 0 0-3.274 0z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})})}function Gn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"m6.8 21l-5.2-9l5.2-9h10.4l5.2 9l-5.2 9zm1.15-2h8.1l4.025-7l-4.025-7h-8.1L3.9 12zM12 12",fill:"currentColor"})})}function Un(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsxs("g",{fill:"none",fillRule:"evenodd",children:[t.jsx("path",{d:"m12.594 23.258l-.012.002l-.071.035l-.02.004l-.014-.004l-.071-.036q-.016-.004-.024.006l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.016-.018m.264-.113l-.014.002l-.184.093l-.01.01l-.003.011l.018.43l.005.012l.008.008l.201.092q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.003-.011l.018-.43l-.003-.012l-.01-.01z"}),t.jsx("path",{d:"M10.586 2.807a2 2 0 0 1 2.828 0l7.778 7.779a2 2 0 0 1 0 2.828l-7.778 7.778a2 2 0 0 1-2.828 0l-7.778-7.778a2 2 0 0 1 0-2.828zM12 4.222L4.222 12L12 19.778L19.778 12z",fill:"currentColor"})]})})}function Xn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4z",fill:"currentColor"})})}function Zn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{clipRule:"evenodd",d:"M7.53 3.47a.75.75 0 0 1 0 1.06L5.81 6.25H15a5.75 5.75 0 0 1 0 11.5H8a.75.75 0 0 1 0-1.5h7a4.25 4.25 0 0 0 0-8.5H5.81l1.72 1.72a.75.75 0 1 1-1.06 1.06l-3-3a.75.75 0 0 1 0-1.06l3-3a.75.75 0 0 1 1.06 0",fill:"currentColor",fillRule:"evenodd"})})}function Kn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{clipRule:"evenodd",d:"M16.47 3.47a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1 0 1.06l-3 3a.75.75 0 1 1-1.06-1.06l1.72-1.72H9a4.25 4.25 0 0 0 0 8.5h7a.75.75 0 0 1 0 1.5H9a5.75 5.75 0 0 1 0-11.5h9.19l-1.72-1.72a.75.75 0 0 1 0-1.06",fill:"currentColor",fillRule:"evenodd"})})}function Yn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zm2-4h2V8H9zm4 0h2V8h-2z",fill:"currentColor"})})}function Jn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 256 256",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M211.81 83.79a28 28 0 0 1-33.12 4.83l-90.07 90.07a28 28 0 1 1-44.43-6.48a28 28 0 0 1 33.12-4.83l90.07-90.07a28 28 0 1 1 44.43 6.48",fill:"currentColor"})})}function Qn(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M12 20.325q-.35 0-.712-.125t-.638-.4l-1.725-1.575q-2.65-2.425-4.788-4.812T2 8.15Q2 5.8 3.575 4.225T7.5 2.65q1.325 0 2.5.562t2 1.538q.825-.975 2-1.537t2.5-.563q2.35 0 3.925 1.575T22 8.15q0 2.875-2.125 5.275T15.05 18.25l-1.7 1.55q-.275.275-.637.4t-.713.125M11.05 6.75q-.725-1.025-1.55-1.563t-2-.537q-1.5 0-2.5 1t-1 2.5q0 1.3.925 2.763t2.213 2.837t2.65 2.575T12 18.3q.85-.775 2.213-1.975t2.65-2.575t2.212-2.837T20 8.15q0-1.5-1-2.5t-2.5-1q-1.175 0-2 .538T12.95 6.75q-.175.25-.425.375T12 7.25t-.525-.125t-.425-.375m.95 4.725",fill:"currentColor"})})}function eo(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"m7.625 6.4l2.8-3.625q.3-.4.713-.587T12 2t.863.188t.712.587l2.8 3.625l4.25 1.425q.65.2 1.025.738t.375 1.187q0 .3-.088.6t-.287.575l-2.75 3.9l.1 4.1q.025.875-.575 1.475t-1.4.6q-.05 0-.55-.075L12 19.675l-4.475 1.25q-.125.05-.275.063T6.975 21q-.8 0-1.4-.6T5 18.925l.1-4.125l-2.725-3.875q-.2-.275-.288-.575T2 9.75q0-.625.363-1.162t1.012-.763zM8.85 8.125L4 9.725L7.1 14.2L7 18.975l5-1.375l5 1.4l-.1-4.8L20 9.775l-4.85-1.65L12 4zM12 11.5",fill:"currentColor"})})}function to(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M12.01 6c2.61 0 4.89 1.86 5.4 4.43l.3 1.5l1.52.11c1.56.11 2.78 1.41 2.78 2.96c0 1.65-1.35 3-3 3h-13c-2.21 0-4-1.79-4-4c0-2.05 1.53-3.76 3.56-3.97l1.07-.11l.5-.95A5.46 5.46 0 0 1 12.01 6m0-2C9.12 4 6.6 5.64 5.35 8.04C2.35 8.36.01 10.91.01 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.64-4.96C18.68 6.59 15.65 4 12.01 4",fill:"currentColor"})})}function ro(e){return t.jsx("svg",{height:"1em",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg",...e,children:t.jsx("path",{d:"M5.586 6.45A2 2 0 0 1 7.509 5h11.84a2 2 0 0 1 1.923 2.55l-2.858 10A2 2 0 0 1 16.491 19H4.651a2 2 0 0 1-1.923-2.55z",fill:"none",stroke:"currentColor",strokeWidth:"2"})})}const io=[W.Color4.blackHighlight,W.Color4.ofRGBA(166/255,81/255,167/255,.3),W.Color4.ofRGBA(247/255,78/255,158/255,.3),W.Color4.ofRGBA(166/255,83/255,88/255,.3),W.Color4.ofRGBA(246/255,130/255,28/255,.3),W.Color4.ofRGBA(166/255,198/255,0,.3),W.Color4.ofRGBA(98/255,186/255,70/255,.3)],zt=[W.Color4.black,W.Color4.fromHex("#007AFF"),W.Color4.fromHex("#A651A7"),W.Color4.fromHex("#F74E9E"),W.Color4.fromHex("#FF5358"),W.Color4.fromHex("#F6821C"),W.Color4.fromHex("#FFC600"),W.Color4.fromHex("#62BA46"),W.Color4.fromHex("#E6BFE8"),W.Color4.fromHex("#FEA3D2"),W.Color4.fromHex("#FFA0A3"),W.Color4.fromHex("#FBC276"),W.Color4.fromHex("#FFFB85"),W.Color4.fromHex("#AADC99")];function no({onChange:e}){const[r,i]=a.useState(W.Color4.blackHighlight);return t.jsx("div",{className:E.colorWrap,children:io.map((n,s)=>t.jsx("button",{style:{backgroundColor:n.toHexString()},className:L(E.color,{[E.colorActive]:r.toHexString()===n.toHexString()}),onClick:()=>{i(n),e(n)}},s))})}function st({onChange:e}){const[r,i]=a.useState(W.Color4.black);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:E.colorWrap,children:zt.slice(0,7).map((n,s)=>t.jsx("button",{style:{backgroundColor:n.toHexString()},className:L(E.color,{[E.colorActive]:r.toHexString()===n.toHexString()}),onClick:()=>{i(n),e(n)}},s))}),t.jsx("div",{className:E.colorWrap,children:zt.slice(7).map((n,s)=>t.jsx("button",{style:{backgroundColor:n.toHexString()},className:L(E.color,{[E.colorActive]:r.toHexString()===n.toHexString()}),onClick:()=>{i(n),e(n)}},s))})]})}function oo({setColorPen:e,setThicknessPen:r}){const[i,n]=a.useState(2);return t.jsxs("div",{className:E.options,children:[t.jsx("div",{children:t.jsx(st,{onChange:s=>e(s)})}),t.jsx("div",{className:E.line}),t.jsx("div",{children:t.jsx("input",{max:10,min:1,step:.1,type:"range",value:i,onChange:s=>{r(Number.parseFloat(s.target.value)),n(Number.parseFloat(s.target.value))}})})]})}function so({setColorHighlight:e}){return t.jsx("div",{className:E.options,children:t.jsx(no,{onChange:r=>e(r)})})}function co({changeColorShape:e,changeBorderColorShape:r,onThicknessChange:i}){return t.jsxs("div",{className:E.options,children:[t.jsx("div",{children:t.jsx(st,{onChange:n=>e(n)})}),t.jsx("div",{className:E.line}),t.jsx("div",{children:t.jsx(st,{onChange:n=>r(n)})}),t.jsx("div",{className:E.line}),t.jsx("div",{children:t.jsx("input",{defaultValue:0,max:20,min:0,step:1,type:"range",onChange:n=>{i(Number.parseFloat(n.target.value))}})})]})}function yr(e){const{setColorPen:r,refEditor:i,setThicknessPen:n,setColorHighlight:s,changeBorderColorShape:o,onUndo:c,changeColorShape:d,changeShape:l,onThicknessChange:h,onRedo:u,onClear:x}=e,[m,f]=a.useState(null),[w,p]=a.useState(0);return t.jsx(t.Fragment,{children:t.jsxs("div",{className:E.wrapper,children:[t.jsxs("div",{className:E.pen,children:[t.jsx("button",{className:L(E.tool,{[E.active]:m==="select"}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();if(m==="select"){f(null),g[0].setEnabled(!1);return}f("select"),g[0].setEnabled(!0)},children:t.jsx(Hn,{})}),t.jsx("div",{className:E.line}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="text"}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();if(i.current.toolController.setToolEnabled(g[1]),m==="text"){g[1].setEnabled(!1),f(null);return}f("text"),g[1].setEnabled(!0)},children:t.jsx(On,{})}),t.jsx("div",{className:E.line}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="pencil"}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();if(m==="pencil"){f(null),g[2].setEnabled(!1);return}f("pencil"),g[2].setEnabled(!0)},children:t.jsx(Dn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="highlighter"}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();if(m==="highlighter"){f(null),g[3].setEnabled(!1);return}f("highlighter"),g[3].setEnabled(!0)},children:t.jsx(Bn,{})}),t.jsx("div",{className:E.line}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="eraser"}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();if(m==="eraser"){f(null),g[4].setEnabled(!1);return}f("eraser"),g[4].setEnabled(!0)},children:t.jsx($n,{})}),t.jsx("div",{className:E.line}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===0}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(0),p(0)},children:t.jsx(Vn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===1}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(1),p(1)},children:t.jsx(Fn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===2}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(2),p(2)},children:t.jsx(Wn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===3}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(3),p(3)},children:t.jsx(qn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===4}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(4),p(4)},children:t.jsx(Gn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===5}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(5),p(5)},children:t.jsx(Un,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===6}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(6),p(6)},children:t.jsx(Xn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===7}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(7),p(7)},children:t.jsx(Jn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===8}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(8),p(8)},children:t.jsx(Qn,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===9}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(9),p(9)},children:t.jsx(eo,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===10}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(10),p(10)},children:t.jsx(to,{})}),t.jsx("button",{className:L(E.tool,{[E.active]:m==="shapes"&&w===11}),onClick:()=>{const g=i.current.toolController.getPrimaryTools();i.current.toolController.setToolEnabled(g[5]),f("shapes"),g[5].setEnabled(!0),l(11),p(11)},children:t.jsx(ro,{})}),t.jsx("div",{className:E.line}),t.jsx("button",{className:L(E.tool),onClick:c,children:t.jsx(Zn,{})}),t.jsx("button",{className:L(E.tool),onClick:u,children:t.jsx(Kn,{})}),t.jsx("button",{className:L(E.tool),onClick:x,children:t.jsx(Yn,{})})]}),t.jsxs("div",{className:E.optionsWrap,children:[m==="pencil"&&t.jsx(oo,{setColorPen:r,setThicknessPen:n}),m==="highlighter"&&t.jsx(so,{setColorHighlight:s}),m==="shapes"&&t.jsx(co,{changeBorderColorShape:o,changeColorShape:d,changeShape:l,onThicknessChange:h})]})]})})}let ve=!1;const ao=({editor:e,upload:r})=>{const[i,n]=a.useState(!1),s=a.useRef(null),o=a.useRef(null),c=()=>{(async()=>{const C=document.querySelector("#easydrawer");C&&(s.current=new W.Editor(C,{wheelEventsEnabled:!1,disableZoom:!0}),o.current=W.makeDropdownToolbar(s.current),o.current.addDefaultToolWidgets())})()};a.useEffect(()=>{i&&setTimeout(()=>{c()},200)},[i]);const d=async()=>{if(s.current){const N=s.current.toSVG(),C=N.outerHTML,b=`drawer-${Xe()}.svg`;let k=_.i(N.outerHTML);if(r){const P=Ae(k,b);k=await r(P)}e==null||e.chain().focus().setDrawer({type:"drawer",src:k,alt:encodeURIComponent(C),width:426,height:212},!!C).run()}n(!1)},l=N=>{const C=s.current.toolController.getPrimaryTools()[2],b=o.current.getWidgetById("pen-1");C&&b&&(C.setColor(N),b.serializeState())},h=N=>{const C=s.current.toolController.getPrimaryTools()[2],b=o.current.getWidgetById("pen-1");C&&b&&(C.setThickness(N),b.serializeState())},u=N=>{const C=s.current.toolController.getPrimaryTools()[3],b=o.current.getWidgetById("pen-2");C&&b&&(C.setColor(N),b.serializeState())},x=N=>{const C=o.current.getWidgetById("shape");C&&C.setShapeType(N)},m=N=>{const C=s.current.toolController.getPrimaryTools()[5],b=o.current.getWidgetById("shape");C&&b&&(C.setColor(N),b.serializeState())},f=N=>{const C=s.current.toolController.getPrimaryTools()[5],b=o.current.getWidgetById("shape");C&&b&&(C.setThickness(N),b.serializeState())},w=N=>{const C=s.current.toolController.getPrimaryTools()[5],b=o.current.getWidgetById("shape");C&&b&&(C.setBorderColor(N),b.serializeState())},p=()=>{if(ve){for(;s.current.history.redoStackSize>0;)s.current.history.redo();ve=!1;return}s.current.history.undo()},g=()=>{ve||s.current.history.redo()},H=()=>{if(!ve){for(;s.current.history.undoStackSize>0;)p();ve=!0}};return t.jsxs(ae,{onOpenChange:n,open:i,children:[t.jsx(le,{asChild:!0,children:t.jsx(O,{action:()=>n(!0),icon:"PencilRuler",tooltip:"Drawer"})}),t.jsxs(ne,{className:"richtext-z-[99999] !richtext-max-w-[1300px]",children:[t.jsx(oe,{children:"Drawer"}),t.jsxs("div",{style:{height:"600px",width:"100%",borderWidth:1,background:"white",position:"relative"},children:[t.jsx("div",{className:"richtext-size-full",id:"easydrawer"}),t.jsx(yr,{changeBorderColorShape:w,changeColorShape:m,changeShape:x,onClear:H,onRedo:g,onThicknessChange:f,onUndo:p,refEditor:s,setColorHighlight:u,setColorPen:l,setThicknessPen:h})]}),t.jsx(fe,{children:t.jsx(q,{onClick:d,type:"button",children:"Save changes"})})]})]})},He={TOP_LEFT:"tl",TOP_RIGHT:"tr",BOTTOM_LEFT:"bl",BOTTOM_RIGHT:"br"};function lo({editor:e,node:r,updateAttributes:i,getPos:n,selected:s}){const[o,c]=a.useState({width:S.IMAGE_MAX_SIZE,height:S.IMAGE_MAX_SIZE}),[d,l]=a.useState({width:0,height:0}),[h]=a.useState([He.TOP_LEFT,He.TOP_RIGHT,He.BOTTOM_LEFT,He.BOTTOM_RIGHT]),[u,x]=a.useState(!1),[m,f]=a.useState({x:0,y:0,w:0,h:0,dir:""}),{align:w}=r==null?void 0:r.attrs,p=a.useMemo(()=>{const{src:v,alt:T,width:B,height:D}=r==null?void 0:r.attrs,z=R.isNumber(B)?`${B}px`:B,M=R.isNumber(D)?`${D}px`:D;return{src:v||void 0,alt:T||void 0,style:{width:z||void 0,height:M||void 0}}},[r==null?void 0:r.attrs]),g=a.useMemo(()=>{const{style:{width:v}}=p;return{width:v==="100%"?v:void 0}},[p]);function H(v){l({width:v.target.width,height:v.target.height})}function N(){e.commands.setNodeSelection(n())}const C=a.useCallback(_.throttle(()=>{const{width:v}=getComputedStyle(e.view.dom);c(T=>({...T,width:Number.parseInt(v,10)}))},S.IMAGE_THROTTLE_WAIT_TIME),[e]);function b(v,T){v.preventDefault(),v.stopPropagation();const B=d.width,D=d.height,z=B/D;let M=Number(r.attrs.width),$=Number(r.attrs.height);const F=o.width;M&&!$?(M=M>F?F:M,$=Math.round(M/z)):$&&!M?(M=Math.round($*z),M=M>F?F:M):!M&&!$?(M=B>F?F:B,$=Math.round(M/z)):M=M>F?F:M,x(!0),f({x:v.clientX,y:v.clientY,w:M,h:$,dir:T})}const k=a.useCallback(_.throttle(v=>{if(v.preventDefault(),v.stopPropagation(),!u)return;const{x:T,w:B,dir:D}=m,z=(v.clientX-T)*(/l/.test(D)?-1:1),{width:M,height:$}=r==null?void 0:r.attrs,F=M/$,X=er(B+z,S.IMAGE_MIN_SIZE,o.width),te=Math.round(X/F);i({width:X,height:te})},S.IMAGE_THROTTLE_WAIT_TIME),[u,m,o,i,r==null?void 0:r.attrs]),P=a.useCallback(v=>{v.preventDefault(),v.stopPropagation(),u&&(f({x:0,y:0,w:0,h:0,dir:""}),x(!1),N())},[u,N]),I=a.useCallback(()=>{document==null||document.addEventListener("mousemove",k,!0),document==null||document.addEventListener("mouseup",P,!0)},[k,P]),y=a.useCallback(()=>{document==null||document.removeEventListener("mousemove",k,!0),document==null||document.removeEventListener("mouseup",P,!0)},[k,P]);a.useEffect(()=>(u?I():y(),()=>{y()}),[u,I,y]);const A=a.useMemo(()=>new ResizeObserver(()=>C()),[C]);return a.useEffect(()=>(A.observe(e.view.dom),()=>{A.disconnect()}),[e.view.dom,A]),t.jsx(R.NodeViewWrapper,{className:"image-view",style:{...g,width:"100%",textAlign:w},children:t.jsxs("div",{"data-drag-handle":!0,draggable:"true",style:{...g,background:"#fff"},className:`image-view__body ${s?"image-view__body--focused":""} ${u?"image-view__body--resizing":""}`,children:[t.jsx("img",{alt:p.alt,className:"image-view__body__image block",height:"auto",onClick:N,onLoad:H,src:p.src,style:p.style}),e.view.editable&&(s||u)&&t.jsx("div",{className:"image-resizer",children:h==null?void 0:h.map(v=>t.jsx("span",{className:`image-resizer__handler image-resizer__handler--${v}`,onMouseDown:T=>b(T,v)},`image-dir-${v}`))})]})})}const ct=R.Image.extend({name:"drawer",addOptions(){var e;return{...(e=this.parent)==null?void 0:e.call(this),inline:!1,content:"",marks:"",group:"block",draggable:!1,selectable:!0,atom:!0,HTMLAttributes:{class:"drawer"},button:({editor:r,t:i,extension:n})=>{var s;return{component:ao,componentProps:{action:()=>!0,isActive:()=>!1,disabled:!1,editor:r,icon:"PencilRuler",tooltip:i("editor.drawer.tooltip"),upload:(s=n==null?void 0:n.options)==null?void 0:s.upload}}}}},addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),width:{default:null,parseHTML:r=>{const i=r.querySelector("img"),n=i==null?void 0:i.getAttribute("width");return n?Number.parseInt(n,10):320},renderHTML:r=>({width:r.width})},height:{default:null,parseHTML:r=>{const i=r.querySelector("img"),n=i==null?void 0:i.getAttribute("height");return n?Number.parseInt(n,10):212},renderHTML:r=>({height:r.height})},align:{default:"center",parseHTML:r=>r.getAttribute("align"),renderHTML:r=>({align:r.align})}}},addNodeView(){return R.ReactNodeViewRenderer(lo)},addCommands(){return{setDrawer:(e,r)=>({commands:i,editor:n})=>r?i.insertContent({type:this.name,attrs:e}):i.insertContentAt(n.state.selection.anchor,{type:this.name,attrs:e}),setAlignImageDrawer:e=>({commands:r})=>r.updateAttributes(this.name,{align:e})}},renderHTML({HTMLAttributes:e}){const{align:r}=e;return["div",{style:r?`text-align: ${r};`:"",class:"imageDrawer"},["img",R.mergeAttributes(this.options.HTMLAttributes,e)]]},parseHTML(){return[{tag:"div[class=imageDrawer]",getAttrs:e=>{const r=e.querySelector("img"),i=r==null?void 0:r.getAttribute("width"),n=r==null?void 0:r.getAttribute("height");return{src:r==null?void 0:r.getAttribute("src"),alt:r==null?void 0:r.getAttribute("alt"),width:i?Number.parseInt(i,10):null,height:n?Number.parseInt(n,10):null,align:(r==null?void 0:r.getAttribute("align"))||e.style.textAlign||null}}}]}});let be=!1;function ho({editor:e,attrs:r,extension:i}){const[n,s]=a.useState(!1),o=a.useRef(null),c=a.useRef(null),{alt:d,align:l}=r,h=i==null?void 0:i.options.upload,u=()=>{(async()=>{const I=document.querySelector("#easydrawer");I&&(o.current=new W.Editor(I,{wheelEventsEnabled:!1,disableZoom:!0}),c.current=W.makeDropdownToolbar(o.current),c.current.addDefaultToolWidgets(),o.current.loadFromSVG(decodeURIComponent(d)))})()};a.useEffect(()=>{n&&setTimeout(()=>{u()},200)},[n]);const x=async()=>{if(o.current){const P=o.current.toSVG(),I=P.outerHTML,y=`drawer-${Xe()}.svg`;let A=_.i(P.outerHTML);if(h){const v=Ae(A,y);A=await h(v)}e==null||e.chain().focus().setDrawer({type:"drawer",src:A,alt:encodeURIComponent(I),width:426,height:212},!!I).run(),e==null||e.commands.setAlignImageDrawer(l)}s(!1)},m=P=>{const I=o.current.toolController.getPrimaryTools()[2],y=c.current.getWidgetById("pen-1");I&&y&&(I.setColor(P),y.serializeState())},f=P=>{const I=o.current.toolController.getPrimaryTools()[2],y=c.current.getWidgetById("pen-1");I&&y&&(I.setThickness(P),y.serializeState())},w=P=>{const I=o.current.toolController.getPrimaryTools()[3],y=c.current.getWidgetById("pen-2");I&&y&&(I.setColor(P),y.serializeState())},p=P=>{const I=c.current.getWidgetById("shape");I&&I.setShapeType(P)},g=P=>{const I=o.current.toolController.getPrimaryTools()[5],y=c.current.getWidgetById("shape");I&&y&&(I.setColor(P),y.serializeState())},H=P=>{const I=o.current.toolController.getPrimaryTools()[5],y=c.current.getWidgetById("shape");I&&y&&(I.setThickness(P),y.serializeState())},N=P=>{const I=o.current.toolController.getPrimaryTools()[5],y=c.current.getWidgetById("shape");I&&y&&(I.setBorderColor(P),y.serializeState())},C=()=>{if(be){for(;o.current.history.redoStackSize>0;)o.current.history.redo();be=!1;return}o.current.history.undo()},b=()=>{be||o.current.history.redo()},k=()=>{if(!be){for(;o.current.history.undoStackSize>0;)C();be=!0}};return t.jsxs(ae,{onOpenChange:s,open:n,children:[t.jsx(le,{asChild:!0,children:t.jsx(O,{action:()=>s(!0),icon:"Pencil",tooltip:"Edit Drawer"})}),t.jsxs(ne,{className:"richtext-z-[99999] !richtext-max-w-[1300px]",children:[t.jsx(oe,{children:"Edit Drawer"}),t.jsxs("div",{style:{height:"100%",borderWidth:1,background:"white",position:"relative"},children:[t.jsx("div",{className:"richtext-size-full",id:"easydrawer"}),t.jsx(yr,{changeBorderColorShape:N,changeColorShape:g,changeShape:p,onClear:k,onRedo:b,onThicknessChange:H,onUndo:C,refEditor:o,setColorHighlight:w,setColorPen:m,setThicknessPen:f})]}),t.jsx(fe,{children:t.jsx(q,{onClick:x,type:"button",children:"Save changes"})})]})]})}function Tr(e,r){const[i,n]=a.useState(void 0);return a.useEffect(()=>{const s=()=>{const o=e.extensionManager.extensions.find(c=>c.name===r);o&&n(o)};return e.on("selectionUpdate",s),e.on("transaction",s),()=>{e.off("selectionUpdate",s),e.off("transaction",s)}},[e,r]),i}const uo={maxWidth:"auto",zIndex:20,appendTo:"parent",moveTransition:"transform 0.1s ease-out"};function xo({item:e,disabled:r,editor:i}){var s;const n=e.component;return n?t.jsx(a.Fragment,{children:e.type==="divider"?t.jsx(Y,{className:"!richtext-mx-1 !richtext-my-2 !richtext-h-[16px]",orientation:"vertical"}):t.jsx(n,{...e.componentProps,disabled:r||((s=e==null?void 0:e.componentProps)==null?void 0:s.disabled),editor:i})}):t.jsx(t.Fragment,{})}function mo(e){return e.type.name==="drawer"}function fo(e){const{lang:r}=S.useLocale(),i=Le(e.editor,ct.name),n=Tr(e.editor,ct.name),s=({editor:c})=>{const{selection:d}=c.view.state,{$from:l,to:h}=d;let u=!1;return c.view.state.doc.nodesBetween(l.pos,h,x=>{if(mo(x))return u=!0,!1}),u},o=a.useMemo(()=>e.disabled?[]:Do(e.editor),[e.disabled,e.editor,r]);return t.jsx(t.Fragment,{children:t.jsx(R.BubbleMenu,{editor:e==null?void 0:e.editor,shouldShow:s,tippyOptions:uo,children:o!=null&&o.length?t.jsx("div",{className:"richtext-pointer-events-auto richtext-w-auto richtext-select-none richtext-rounded-sm !richtext-border richtext-border-neutral-200 richtext-bg-background richtext-px-3 richtext-py-2 richtext-shadow-sm richtext-transition-all dark:richtext-border-neutral-800",children:t.jsx("div",{className:"richtext-relative richtext-flex richtext-h-[26px] richtext-flex-nowrap richtext-items-center richtext-justify-start richtext-whitespace-nowrap",children:o==null?void 0:o.map((c,d)=>c.type==="edit"&&(i!=null&&i.src)?t.jsx(ho,{attrs:i,editor:e.editor,extension:n},`bubbleMenu-drawer-${d}`):t.jsx(xo,{disabled:e.disabled,editor:e.editor,item:c},`bubbleMenu-drawer-${d}`))})}):t.jsx(t.Fragment,{})})})}const go={padding:"0 12px 12px"},po=({width:e,maxWidth:r,height:i,onOk:n,children:s})=>{const{t:o}=S.useLocale(),[c,d]=a.useState({width:"",height:"",maxWidth:""});a.useEffect(()=>{d({width:e,height:i,maxWidth:r})},[i,r,e]);function l(h){h.preventDefault(),h.stopPropagation(),n(c)}return t.jsxs(xe,{modal:!0,children:[t.jsx(me,{asChild:!0,children:s}),t.jsx(ce,{children:t.jsx("div",{style:go,children:t.jsxs("form",{className:"richtext-flex richtext-flex-col richtext-gap-2",onSubmit:l,children:[t.jsx(ee,{className:"mb-[6px]",children:"Width"}),t.jsx("div",{className:"richtext-flex richtext-w-full richtext-max-w-sm richtext-items-center richtext-gap-1.5",children:t.jsx("div",{className:"richtext-relative richtext-items-center richtext-w-full richtext-max-w-sm",children:t.jsx(Z,{type:"number",value:c.width,required:!0,onChange:h=>d({...c,width:h.target.value})})})}),t.jsx(ee,{className:"mb-[6px]",children:"Max Width"}),t.jsx("div",{className:"richtext-flex richtext-w-full richtext-max-w-sm richtext-items-center richtext-gap-1.5",children:t.jsx("div",{className:"richtext-relative richtext-items-center richtext-w-full richtext-max-w-sm",children:t.jsx(Z,{type:"number",value:c.maxWidth,required:!0,onChange:h=>d({...c,maxWidth:h.target.value})})})}),t.jsx(ee,{className:"mb-[6px]",children:"Height"}),t.jsx("div",{className:"richtext-flex richtext-w-full richtext-max-w-sm richtext-items-center richtext-gap-1.5",children:t.jsx("div",{className:"richtext-relative richtext-items-center richtext-w-full richtext-max-w-sm",children:t.jsx(Z,{type:"number",value:c.height,required:!0,onChange:h=>d({...c,height:h.target.value})})})}),t.jsx(q,{type:"submit",className:"richtext-self-end richtext-mt-2",children:o("editor.link.dialog.button.apply")})]})})})]})};function wo({editor:e}){const{t:r}=S.useLocale(),{width:i,height:n,url:s}=Le(e,de.name,{width:0,height:0,url:"",defaultShowPicker:!1}),[o,c]=a.useState(!1),[d,l]=a.useState(""),h=a.useCallback(()=>{c(!1)},[c]);a.useEffect(()=>{o&&l(s)},[o,s]);const u=a.useCallback(()=>{e.chain().updateAttributes(de.name,{url:d}).setNodeSelection(e.state.selection.from).focus().run(),c(!1)},[e,d,c]),x=a.useCallback(()=>{window.open(s,"_blank")},[s]),m=a.useCallback(()=>{c(!0)},[c]),f=a.useCallback(g=>{e.chain().updateAttributes(de.name,g).setNodeSelection(e.state.selection.from).focus().run()},[e]),w=a.useCallback(()=>e.isActive(de.name)&&!s,[e,s]),p=a.useCallback(()=>ke(de.name,e),[e]);return t.jsxs(t.Fragment,{children:[t.jsx(R.BubbleMenu,{className:"bubble-menu",editor:e,pluginKey:"iframe-bubble-menu",shouldShow:w,tippyOptions:{popperOptions:{modifiers:[{name:"flip",enabled:!1}]},placement:"bottom-start",offset:[-2,16],zIndex:9999},children:t.jsxs("div",{className:"richtext-w-auto richtext-px-3 richtext-py-2 richtext-transition-all !richtext-border richtext-rounded-sm richtext-shadow-sm richtext-pointer-events-auto richtext-select-none richtext-border-neutral-200 dark:richtext-border-neutral-800 richtext-bg-background",children:[t.jsx(O,{action:x,icon:"Eye",tooltip:"Visit Link"}),t.jsx(O,{action:m,icon:"Pencil",tooltip:"Open Edit Link"}),t.jsx(po,{width:i,height:n,onOk:f,children:t.jsx(O,{icon:"Settings",tooltip:r("editor.settings")})}),t.jsx(O,{action:p,icon:"Trash2",tooltip:r("editor.delete")})]})}),t.jsxs(ae,{open:o,onOpenChange:c,children:[t.jsx(le,{}),t.jsxs(ne,{children:[t.jsx(jr,{children:t.jsx(oe,{children:"Edit Link Iframe"})}),t.jsx(Z,{value:d,onInput:g=>l(g.target.value),type:"url",autoFocus:!0,placeholder:"Enter link"}),t.jsxs(fe,{children:[t.jsx(q,{onClick:h,children:"Cancel"}),t.jsx(q,{onClick:u,children:"OK"})]})]})]})]})}function vo({editor:e,...r}){const i=Le(e,he.name,{text:"",defaultShowPicker:!1}),{text:n,defaultShowPicker:s}=i,[o,c]=a.useState(""),[d,l]=a.useState(!1),h=a.useCallback(()=>e.isActive(he.name),[e]),u=a.useCallback(()=>ke(he.name,e),[e]),x=a.useCallback(()=>{e.chain().focus().setKatex({text:o}).run(),l(!1)},[e,o]);a.useEffect(()=>{s&&(l(!0),e.chain().updateAttributes(he.name,{defaultShowPicker:!1}).focus().run())},[e,s,l]),a.useEffect(()=>{d&&c(n||"")},[d]);const m=a.useMemo(()=>{try{return lt.renderToString(`${o}`)}catch{return o}},[o]),f=a.useMemo(()=>`${o}`.trim()?t.jsx("span",{contentEditable:!1,dangerouslySetInnerHTML:{__html:m||""}}):null,[o,m]);return t.jsx(R.BubbleMenu,{editor:e,pluginKey:"Katex-bubble-menu",shouldShow:h,tippyOptions:{popperOptions:{modifiers:[{name:"flip",enabled:!1}]},placement:"bottom-start",offset:[-2,16],zIndex:9999,onHidden:()=>{l(!1)}},children:r!=null&&r.disabled?t.jsx(t.Fragment,{}):t.jsx("div",{className:"richtext-p-2 richtext-bg-white !richtext-border richtext-rounded-lg richtext-shadow-sm dark:richtext-bg-black richtext-border-neutral-200 dark:richtext-border-neutral-800",children:d?t.jsxs(t.Fragment,{children:[t.jsx(Ie,{value:o,onChange:w=>c(w.target.value),autoFocus:!0,placeholder:"Formula text",rows:3,defaultValue:n,style:{marginBottom:8}}),f&&t.jsx("div",{className:"richtext-my-[10px] richtext-p-[10px] richtext-rounded-[6px] !richtext-border-[1px] richtext-whitespace-nowrap richtext-overflow-auto",children:f}),t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-justify-between richtext-gap-[6px]",children:[t.jsx(q,{onClick:x,className:"richtext-flex-1",children:"Submit"}),t.jsx("a",{href:"https://katex.org/docs/supported",target:"_blank",rel:"noreferrer noopener",children:t.jsx(j.HelpCircle,{size:16})})]})]}):t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-justify-center richtext-gap-[6px]",children:[t.jsx(O,{tooltip:"Edit",action:()=>l(!d),children:t.jsx(j.Pencil,{size:16})}),t.jsx(O,{tooltip:"Delete",action:u,children:t.jsx(j.Trash2,{size:16})})]})})})}const _t=`graph TB
a-->b`,bo=({editor:e,attrs:r,extension:i})=>{const{alt:n,align:s}=r,[o,c]=a.useState(decodeURIComponent(n??_t)),[d,l]=a.useState(""),[h,u]=a.useState(!1),x=a.useRef(null),m=i==null?void 0:i.options.upload,f=async g=>{try{const{svg:H}=await Ve.render("mermaid-svg",g);l(H)}catch{l("")}},w=()=>{Ve.initialize({darkMode:!1,startOnLoad:!1,fontSize:12,theme:"base"}),f(o)};a.useEffect(()=>{h&&w()},[h]),a.useEffect(()=>{h&&f(o)},[o]);const p=async()=>{if(o!==""){if(o){const g=x.current.querySelector("svg"),{width:H,height:N}=g.getBoundingClientRect(),C=`mermaid-${Xe()}.svg`;let b=_.i(g.outerHTML);if(m){const k=Ae(b,C);b=await m(k)}e==null||e.chain().focus().setMermaid({type:"mermaid",src:b,alt:encodeURIComponent(o),width:H,height:N},!!o).run(),e==null||e.commands.setAlignImageMermaid(s)}u(!1)}};return t.jsxs(ae,{onOpenChange:u,open:h,children:[t.jsx(le,{asChild:!0,children:t.jsx(O,{action:()=>u(!0),icon:"Pencil",tooltip:"Edit Mermaid"})}),t.jsxs(ne,{className:"richtext-z-[99999] !richtext-max-w-[1300px]",children:[t.jsx(oe,{children:"Edit Mermaid"}),t.jsx("div",{style:{height:"100%",border:"1px solid hsl(var(--border))"},children:t.jsxs("div",{className:"richtext-flex richtext-gap-[10px] richtext-rounded-[10px] richtext-p-[10px]",children:[t.jsx(Ie,{autoFocus:!0,className:"richtext-flex-1",defaultValue:_t,onChange:g=>c(g.target.value),placeholder:"Text",required:!0,rows:10,value:o,style:{color:"hsl(var(--richtext-foreground))"}}),t.jsx("div",{className:"richtext-flex richtext-flex-1 richtext-items-center richtext-justify-center richtext-rounded-[10px] richtext-p-[10px]",dangerouslySetInnerHTML:{__html:d},ref:x,style:{height:"100%",border:"1px solid hsl(var(--border))",minHeight:500,background:"#fff"}})]})}),t.jsx(fe,{children:t.jsx(q,{onClick:p,type:"button",children:"Save changes"})})]})]})},jo={maxWidth:"auto",zIndex:20,appendTo:"parent",moveTransition:"transform 0.1s ease-out"};function Co({item:e,disabled:r,editor:i}){var s;const n=e.component;return n?t.jsx(a.Fragment,{children:e.type==="divider"?t.jsx(Y,{className:"!richtext-mx-1 !richtext-my-2 !richtext-h-[16px]",orientation:"vertical"}):t.jsx(n,{...e.componentProps,disabled:r||((s=e==null?void 0:e.componentProps)==null?void 0:s.disabled),editor:i})}):t.jsx(t.Fragment,{})}function yo(e){return e.type.name==="mermaid"}function To(e){const{lang:r}=S.useLocale(),i=Le(e.editor,ot.name),n=Tr(e.editor,ot.name),s=({editor:c})=>{const{selection:d}=c.view.state,{$from:l,to:h}=d;let u=!1;return c.view.state.doc.nodesBetween(l.pos,h,x=>{if(yo(x))return u=!0,!1}),u},o=a.useMemo(()=>e.disabled?[]:Oo(e.editor),[e.disabled,e.editor,r]);return t.jsx(t.Fragment,{children:t.jsx(R.BubbleMenu,{editor:e==null?void 0:e.editor,shouldShow:s,tippyOptions:jo,children:o!=null&&o.length?t.jsx("div",{className:"richtext-pointer-events-auto richtext-w-auto richtext-select-none richtext-rounded-sm !richtext-border richtext-border-neutral-200 richtext-bg-background richtext-px-3 richtext-py-2 richtext-shadow-sm richtext-transition-all dark:richtext-border-neutral-800",children:t.jsx("div",{className:"richtext-relative richtext-flex richtext-h-[26px] richtext-flex-nowrap richtext-items-center richtext-justify-start richtext-whitespace-nowrap",children:o==null?void 0:o.map((c,d)=>c.type==="edit"&&(i!=null&&i.src)?t.jsx(bo,{attrs:i,editor:e.editor,extension:n},`bubbleMenu-mermaid-${d}`):t.jsx(Co,{disabled:e.disabled,editor:e.editor,item:c},`bubbleMenu-mermaid-${d}`))})}):t.jsx(t.Fragment,{})})})}function No({editor:e,disabled:r}){const[i,n]=a.useState(!1),{t:s}=S.useLocale(),o=a.useCallback(({editor:l})=>l.isActive(We.name),[]),c=l=>{e.commands.updateTweet({src:l}),n(!1)},d=a.useCallback(()=>ke(We.name,e),[e]);return t.jsx(t.Fragment,{children:t.jsx(R.BubbleMenu,{editor:e,shouldShow:o,tippyOptions:{popperOptions:{modifiers:[{name:"flip",enabled:!1}]},placement:"bottom-start",offset:[-2,16],zIndex:9999,onHidden:()=>{n(!1)}},children:r?t.jsx(t.Fragment,{}):t.jsx(t.Fragment,{children:i?t.jsx(Cr,{editor:e,onSetLink:c}):t.jsx("div",{className:"richtext-flex richtext-items-center richtext-gap-2 richtext-rounded-lg !richtext-border richtext-border-neutral-200 richtext-bg-white richtext-p-2 richtext-shadow-sm dark:richtext-border-neutral-800 dark:richtext-bg-black",children:t.jsxs("div",{className:"richtext-flex richtext-flex-nowrap",children:[t.jsx(O,{icon:"Pencil",tooltip:s("editor.link.edit.tooltip"),tooltipOptions:{sideOffset:15},action:()=>{n(!0)}}),t.jsx(O,{action:d,icon:"Trash",tooltip:s("editor.delete"),tooltipOptions:{sideOffset:15}})]})})})})})}function So({editor:e,disabled:r,bubbleMenu:i}){const n=e.extensionManager.extensions.map(o=>o.name),s=()=>{var o,c,d,l,h,u,x,m,f,w,p,g,H,N;return[n.includes("columns")&&!((o=i==null?void 0:i.columnConfig)!=null&&o.hidden)?t.jsx(os,{editor:e},"columns"):null,n.includes("table")&&!((c=i==null?void 0:i.tableConfig)!=null&&c.hidden)?t.jsx(Ko,{editor:e,actions:(d=i==null?void 0:i.tableConfig)==null?void 0:d.actions},"table"):null,n.includes("link")&&!((l=i==null?void 0:i.linkConfig)!=null&&l.hidden)?t.jsx(Jo,{disabled:r,editor:e},"link"):null,n.includes(we.name)&&!((h=i==null?void 0:i.imageConfig)!=null&&h.hidden)?t.jsx(rs,{disabled:r,editor:e},"image"):null,n.includes(bt.name)&&!((u=i==null?void 0:i.imageGifConfig)!=null&&u.hidden)?t.jsx(is,{disabled:r,editor:e},"imageGif"):null,n.includes("video")&&!((x=i==null?void 0:i.videoConfig)!=null&&x.hidden)?t.jsx(ns,{disabled:r,editor:e},"video"):null,n.includes("katex")&&!((m=i==null?void 0:i.katexConfig)!=null&&m.hidden)?t.jsx(vo,{disabled:r,editor:e},"katex"):null,n.includes("mermaid")&&!((f=i==null?void 0:i.mermaidConfig)!=null&&f.hidden)?t.jsx(To,{disabled:r,editor:e},"mermaid"):null,n.includes("iframe")&&!((w=i==null?void 0:i.iframeConfig)!=null&&w.hidden)?t.jsx(wo,{disabled:r,editor:e},"iframe"):null,n.includes("twitter")&&!((p=i==null?void 0:i.twitterConfig)!=null&&p.hidden)?t.jsx(No,{disabled:r,editor:e},"twitter"):null,(g=i==null?void 0:i.floatingMenuConfig)!=null&&g.hidden?null:t.jsx(Go,{disabled:r,editor:e},"content"),(H=i==null?void 0:i.textConfig)!=null&&H.hidden?null:t.jsx(Zo,{disabled:r,editor:e},"text"),n.includes("drawer")&&!((N=i==null?void 0:i.drawerConfig)!=null&&N.hidden)?t.jsx(fo,{disabled:r,editor:e},"drawer"):null]};return i!=null&&i.render?i.render({editor:e,disabled:r||!1,bubbleMenu:i},s()):s().filter(Boolean)}function Ht(){return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:t.jsx("path",{fill:"currentColor",d:"M18 14c0-4-6-10.8-6-10.8s-1.33 1.51-2.73 3.52l8.59 8.59c.09-.42.14-.86.14-1.31m-.88 3.12L12.5 12.5L5.27 5.27L4 6.55l3.32 3.32C6.55 11.32 6 12.79 6 14c0 3.31 2.69 6 6 6c1.52 0 2.9-.57 3.96-1.5l2.63 2.63l1.27-1.27z"})})}function Nr(e){const{t:r}=S.useLocale(),{highlight:i=!1,disabled:n=!1,selectedColor:s,setSelectedColor:o,onChange:c,colors:d=S.COLORS_LIST}=e,l=a.useMemo(()=>{const f=d,w=[];for(let p=0;p<f.length;p+=10)w.push(f.slice(p,p+10));return w},[d]),[h,u]=a.useState([]),x=f=>{const w=[...h],p=w.indexOf(f);p!==-1&&w.splice(p,1),w.unshift(f),w.length>10&&w.pop(),u(w)};function m(f){if(f===void 0){o==null||o(f),c==null||c(f);return}/^#([\da-f]{3}){1,2}$/i.test(f)&&(o==null||o(f),c==null||c(f),x(f))}return t.jsxs(xe,{modal:!0,children:[t.jsx(me,{asChild:!0,className:"!richtext-p-0",disabled:n,children:e==null?void 0:e.children}),t.jsx(ce,{align:"start",className:"richtext-size-full richtext-p-2",hideWhenDetached:!0,side:"bottom",children:t.jsxs("div",{className:"richtext-flex richtext-flex-col",children:[i?t.jsxs("div",{className:"rd-1 richtext-flex richtext-cursor-pointer richtext-items-center richtext-gap-[4px] richtext-p-1 hover:richtext-bg-accent",onClick:()=>m(void 0),children:[t.jsx(Ht,{}),t.jsx("span",{className:"richtext-ml-1 richtext-text-sm",children:r("editor.nofill")})]}):t.jsxs("div",{className:"rd-1 richtext-flex richtext-cursor-pointer richtext-items-center richtext-gap-[4px] richtext-p-1 hover:richtext-bg-accent",onClick:()=>{m(void 0)},children:[t.jsx(Ht,{}),t.jsx("span",{className:"richtext-ml-1 richtext-text-sm",children:r("editor.default")})]}),l.map((f,w)=>t.jsx("span",{className:"richtext-relative richtext-flex richtext-h-auto richtext-w-full richtext-p-0 last:richtext-pb-2",children:f.map((p,g)=>t.jsx("span",{className:"richtext-inline-block richtext-size-6 richtext-flex-[0_0_auto] richtext-cursor-pointer richtext-rounded-sm !richtext-border richtext-border-transparent richtext-p-0.5 hover:richtext-border-border hover:richtext-shadow-sm",onClick:()=>m(p),children:t.jsx("span",{className:"richtext-relative richtext-block richtext-size-[18px] richtext-rounded-[2px] richtext-border-transparent",style:{backgroundColor:p},children:p===s?t.jsx("svg",{className:"richtext-absolute -richtext-top-px richtext-left-px richtext-block richtext-size-3",viewBox:"0 0 18 18",style:{fill:"rgb(255, 255, 255)"},children:t.jsx("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})}):t.jsx("svg",{viewBox:"0 0 18 18",style:{fill:"rgb(255, 255, 255)",display:"none"},children:t.jsx("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})})})},`sub-color-${g}`))},w)),t.jsxs("div",{children:[t.jsx("div",{className:"richtext-my-1 richtext-text-sm",children:r("editor.recent")}),t.jsx("span",{className:"richtext-relative richtext-flex richtext-h-auto richtext-w-full richtext-p-0 last:richtext-pb-2",children:h==null?void 0:h.map((f,w)=>t.jsx("span",{className:"richtext-inline-block richtext-size-6 richtext-flex-[0_0_auto] richtext-cursor-pointer richtext-rounded-sm !richtext-border richtext-border-transparent richtext-p-0.5 hover:richtext-border-border hover:richtext-shadow-sm",onClick:()=>m(f),children:t.jsx("span",{className:"richtext-relative richtext-block richtext-size-[18px] richtext-rounded-[2px] richtext-border-transparent",style:{backgroundColor:f},children:t.jsx("svg",{viewBox:"0 0 18 18",style:{fill:"rgb(255, 255, 255)",display:"none"},children:t.jsx("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"})})})},`sub-color-recent-${w}`))})]}),t.jsx(Mo,{setColor:m})]})})]})}function Mo({setColor:e}){const[r,i]=a.useState("#000000"),[n,s]=a.useState(!1),{t:o}=S.useLocale();return a.useEffect(()=>()=>{s(!1)},[]),t.jsxs(xe,{open:n,children:[t.jsx(me,{asChild:!0,children:t.jsxs("div",{className:"richtext-p-1.5 richtext-text-sm hover:richtext-cursor-pointer hover:richtext-bg-accent",onClick:c=>{c.preventDefault(),s(!0)},children:[o("editor.color.more"),"..."]})}),t.jsxs(ce,{children:[t.jsxs("div",{className:"richtext-flex richtext-flex-col richtext-items-center richtext-justify-center",children:[t.jsx(Vr.HexColorPicker,{color:r,onChange:i}),t.jsx(Z,{className:"richtext-mt-[8px] richtext-w-full",type:"text",value:r.slice(1),onChange:c=>{c.preventDefault(),i(`#${c.target.value}`)}})]}),t.jsx(Y,{className:"richtext-my-[10px]"}),t.jsx(q,{className:"richtext-w-full",onClick:c=>{c.preventDefault(),e(r),s(!1)},children:t.jsx(j.Plus,{size:16})})]})]})}function ko({editor:e,disabled:r,toolbar:i}){const{t:n,lang:s}=S.useLocale(),o=a.useMemo(()=>{const h=[...e.extensionManager.extensions].sort((x,m)=>{const f=x.options.sort??-1,w=m.options.sort??-1;return f-w});let u=[];for(const x of h){const{button:m,divider:f=!1,spacer:w=!1,toolbar:p=!0}=x.options;if(!m||!Qr(m)||!p)continue;const g=m({editor:e,extension:x,t:n});if(Array.isArray(g)){const H=g.map((N,C)=>({button:N,divider:C===g.length-1?f:!1,spacer:C===0?w:!1,type:x.type,name:x.name}));u=[...u,...H];continue}u.push({button:g,divider:f,spacer:w,type:x.type,name:x.name})}return u},[e,n,s]),c=l=>t.jsx("div",{className:"richtext-px-1 richtext-py-2 !richtext-border-b",style:{pointerEvents:r?"none":"auto",opacity:r?.5:1},children:t.jsx("div",{className:"richtext-relative richtext-flex richtext-flex-wrap richtext-h-auto richtext-gap-y-1 richtext-gap-x-1",children:l})}),d=o.map((l,h)=>{var x,m;const u=l.button.component;return t.jsxs("div",{className:"richtext-flex richtext-items-center",children:[(l==null?void 0:l.spacer)&&t.jsx(Y,{orientation:"vertical",className:"!richtext-h-[16px] !richtext-mx-[10px]"}),t.jsx(u,{...l.button.componentProps,disabled:r||((m=(x=l==null?void 0:l.button)==null?void 0:x.componentProps)==null?void 0:m.disabled)}),(l==null?void 0:l.divider)&&t.jsx(Y,{orientation:"vertical",className:"!richtext-h-auto !richtext-mx-2"})]},`toolbar-item-${h}`)});return i&&(i!=null&&i.render)?i.render({editor:e,disabled:r||!1},o,d,c):c(d)}function Ao(e){const r=["size-small","size-medium","size-large"],i=["SizeS","SizeM","SizeL"];return r.map((n,s)=>({type:`image-${n}`,component:O,componentProps:{tooltip:S.localeActions.t(`editor.${n.replace("-",".")}.tooltip`),icon:i[s],action:()=>e.commands.updateImage({width:S.IMAGE_SIZE[n]}),isActive:()=>e.isActive("image",{width:S.IMAGE_SIZE[n]})}}))}function Io(e){const r=["size-small","size-medium","size-large"],i=["SizeS","SizeM","SizeL"];return r.map((n,s)=>({type:`image-${n}`,component:O,componentProps:{tooltip:S.localeActions.t(`editor.${n.replace("-",".")}.tooltip`),icon:i[s],action:()=>e.commands.updateImageGif({width:S.IMAGE_SIZE[n]}),isActive:()=>e.isActive("image",{width:S.IMAGE_SIZE[n]})}}))}function Lo(e){const r=["left","center","right"],i={left:"AlignLeft",center:"AlignCenter",right:"AlignRight"};return r.map(n=>({type:`image-${n}`,component:O,componentProps:{tooltip:S.localeActions.t(`editor.textalign.${n}.tooltip`),icon:i[n],action:()=>{var s,o;return(o=(s=e.commands)==null?void 0:s.setAlignImage)==null?void 0:o.call(s,n)},isActive:()=>e.isActive({align:n})||!1,disabled:!1}}))}function Eo(e){const r=["left","center","right"],i={left:"AlignLeft",center:"AlignCenter",right:"AlignRight"};return r.map(n=>({type:`image-${n}`,component:O,componentProps:{tooltip:S.localeActions.t(`editor.textalign.${n}.tooltip`),icon:i[n],action:()=>{var s,o;return(o=(s=e.commands)==null?void 0:s.setAlignImageGif)==null?void 0:o.call(s,n)},isActive:()=>e.isActive({align:n})||!1,disabled:!1}}))}function Ro(e){const r=["left","center","right"],i={left:"AlignLeft",center:"AlignCenter",right:"AlignRight"};return r.map(n=>({type:`image-${n}`,component:O,componentProps:{tooltip:S.localeActions.t(`editor.textalign.${n}.tooltip`),icon:i[n],action:()=>{var s,o;return(o=(s=e.commands)==null?void 0:s.setAlignImageMermaid)==null?void 0:o.call(s,n)},isActive:()=>e.isActive({align:n})||!1,disabled:!1}}))}function Po(e){const r=["left","center","right"],i={left:"AlignLeft",center:"AlignCenter",right:"AlignRight"};return r.map(n=>({type:`image-${n}`,component:O,componentProps:{tooltip:S.localeActions.t(`editor.textalign.${n}.tooltip`),icon:i[n],action:()=>{var s,o;return(o=(s=e.commands)==null?void 0:s.setAlignImageDrawer)==null?void 0:o.call(s,n)},isActive:()=>e.isActive({align:n})||!1,disabled:!1}}))}function zo(e){const r=["size-small","size-medium","size-large"],i=["SizeS","SizeM","SizeL"];return r.map((n,s)=>({type:`video-${n}`,component:O,componentProps:{tooltip:S.localeActions.t(`editor.${n.replace("-",".")}.tooltip`),icon:i[s],action:()=>e.commands.updateVideo({width:S.VIDEO_SIZE[n]}),isActive:()=>e.isActive("video",{width:S.VIDEO_SIZE[n]})}}))}function _o(e){return[{type:"flipX",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.tooltip.flipX"),icon:"FlipX",action:()=>{const r=e.getAttributes("image"),{flipX:i}=r;e.chain().focus(void 0,{scrollIntoView:!1}).updateImage({flipX:!i}).run()}}},{type:"flipY",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.tooltip.flipY"),icon:"FlipY",action:()=>{const r=e.getAttributes("image"),{flipY:i}=r;e.chain().focus(void 0,{scrollIntoView:!1}).updateImage({flipY:!i}).run()}}},...Ao(e),...Lo(e),{type:"remove",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.remove"),icon:"Trash2",action:()=>{const{state:r,dispatch:i}=e.view;_.deleteSelection(r,i)}}}]}function Ho(e){return[...Io(e),...Eo(e),{type:"remove",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.remove"),icon:"Trash2",action:()=>{const{state:r,dispatch:i}=e.view;_.deleteSelection(r,i)}}}]}function Oo(e){return[...Ro(e),{type:"edit",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.edit"),icon:"Pencil",action:()=>!0}},{type:"remove",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.remove"),icon:"Trash2",action:()=>{const{state:r,dispatch:i}=e.view;_.deleteSelection(r,i)}}}]}function Do(e){return[...Po(e),{type:"edit",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.edit"),icon:"Pencil",action:()=>(console.log("AAA"),!0)}},{type:"remove",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.remove"),icon:"Trash2",action:()=>{const{state:r,dispatch:i}=e.view;_.deleteSelection(r,i)}}}]}function Bo(e){return[...zo(e),{type:"remove",component:O,componentProps:{editor:e,tooltip:S.localeActions.t("editor.remove"),icon:"Trash2",action:()=>{const{state:r,dispatch:i}=e.view;_.deleteSelection(r,i)}}}]}function $o(e,r){return S.BUBBLE_TEXT_LIST.reduce((i,n)=>{if(n==="divider"&&i.length>0)return[...i,{type:"divider",component:void 0,componentProps:{}}];const s=e.extensionManager.extensions.find(o=>o.name===n);return s?[...i,s.configure().options.button({editor:e,t:r,extension:s})]:i},[])}function jt(e,r,i){const n=[],s=e.node(0);i=typeof i=="number"&&i>=0?i:e.sameParent(r)?Math.max(0,e.sharedDepth(r.pos)-1):e.sharedDepth(r.pos);const o=new _.NodeRange(e,r,i),c=o.depth===0?0:s.resolve(o.start).posAtIndex(0);return o.parent.forEach((d,l)=>{const h=c+l,u=h+d.nodeSize;if(h<o.start||h>=o.end)return;const x=new _.SelectionRange(s.resolve(h),s.resolve(u));n.push(x)}),n}class Ct{constructor(r,i){Ee(this,"anchor");Ee(this,"head");this.anchor=r,this.head=i}map(r){return new Ct(r.map(this.anchor),r.map(this.head))}resolve(r){const i=r.resolve(this.anchor),n=r.resolve(this.head);return new ie(i,n)}}class ie extends _.Selection{constructor(i,n,s,o=1){const{doc:c}=i,d=i===n,l=i.pos===c.content.size&&n.pos===c.content.size,h=d&&!l?c.resolve(n.pos+(o>0?1:-1)):n,u=d&&l?c.resolve(i.pos-(o>0?1:-1)):i,x=jt(u.min(h),u.max(h),s);super(h.pos>=i.pos?x[0].$from:x[x.length-1].$to,h.pos>=i.pos?x[x.length-1].$to:x[0].$from,x);Ee(this,"depth");this.depth=s}get $to(){return this.ranges[this.ranges.length-1].$to}eq(i){return i instanceof ie&&i.$from.pos===this.$from.pos&&i.$to.pos===this.$to.pos}map(i,n){const s=i.resolve(n.map(this.anchor)),o=i.resolve(n.map(this.head));return new ie(s,o)}toJSON(){return{type:"nodeRange",anchor:this.anchor,head:this.head}}get isForwards(){return this.head>=this.anchor}get isBackwards(){return!this.isForwards}extendBackwards(){const{doc:i}=this.$from;if(this.isForwards&&this.ranges.length>1){const o=this.ranges.slice(0,-1),c=o[0].$from,d=o[o.length-1].$to;return new ie(c,d,this.depth)}const n=this.ranges[0],s=i.resolve(Math.max(0,n.$from.pos-1));return new ie(this.$anchor,s,this.depth)}extendForwards(){const{doc:i}=this.$from;if(this.isBackwards&&this.ranges.length>1){const o=this.ranges.slice(1),c=o[0].$from,d=o[o.length-1].$to;return new ie(d,c,this.depth)}const n=this.ranges[this.ranges.length-1],s=i.resolve(Math.min(i.content.size,n.$to.pos+1));return new ie(this.$anchor,s,this.depth)}static fromJSON(i,n){return new ie(i.resolve(n.anchor),i.resolve(n.head))}static create(i,n,s,o,c=1){return new this(i.resolve(n),i.resolve(s),o,c)}getBookmark(){return new Ct(this.anchor,this.head)}}function Vo(e){const r=e.cloneNode(!0),i=[e,...Array.from(e.getElementsByTagName("*"))],n=[r,...Array.from(r.getElementsByTagName("*"))];return i.forEach((s,o)=>{n[o].style.cssText=function(c){let d="";const l=getComputedStyle(c);for(let h=0;h<l.length;h+=1)d+=`${l[h]}:${l.getPropertyValue(l[h])};`;return d}(s)}),r}function Oe(e,r){return window.getComputedStyle(e)[r]}function Fo(e=0,r=0,i=0){return Math.min(Math.max(e,r),i)}function Ot(e){e.parentNode!==null&&e.parentNode!==void 0&&e.parentNode.removeChild(e)}function Sr(e){const{x:r,y:i,direction:n,editor:s}=e;let o=null,c=null,d=null,l=r;for(;c===null&&l<window.innerWidth&&l>0;){const h=document.elementsFromPoint(l,i),u=h.findIndex(m=>m.classList.contains("ProseMirror")),x=h.slice(0,u);if(x.length>0){const m=x[0];if(o=m,d=s.view.posAtDOM(m,0),d>=0){c=s.state.doc.nodeAt(Math.max(d-1,0)),(c===null||c.isText)&&(c=s.state.doc.nodeAt(Math.max(d-1,0))),c||(c=s.state.doc.nodeAt(Math.max(d,0)));break}}n==="left"?l-=1:l+=1}return{resultElement:o,resultNode:c,pos:d!==null?d:null}}function Wo(e,r){const{doc:i}=r.view.state,n=Sr({editor:r,x:e.clientX,y:e.clientY,direction:"right"});if(!n.resultNode||n.pos===null)return[];const s=e.clientX,o=function(u,x,m){const f=Number.parseInt(Oe(u.dom,"paddingLeft"),10),w=Number.parseInt(Oe(u.dom,"paddingRight"),10),p=Number.parseInt(Oe(u.dom,"borderLeftWidth"),10),g=Number.parseInt(Oe(u.dom,"borderLeftWidth"),10),H=u.dom.getBoundingClientRect();return{left:Fo(x,H.left+f+p,H.right-w-g),top:m}}(r.view,s,e.clientY),c=r.view.posAtCoords(o);if(!c)return[];const{pos:d}=c;if(!i.resolve(d).parent)return[];const l=i.resolve(n.pos),h=i.resolve(n.pos+1);return jt(l,h,0)}function Dt(e,r){const i=e.resolve(r),{depth:n}=i;return n===0?r:i.pos-i.parentOffset-1}function Bt(e,r){const i=e.nodeAt(r),n=e.resolve(r);let{depth:s}=n,o=i;for(;s>0;){const c=n.node(s);s-=1,s===0&&(o=c)}return o}function $t(e,r){let i=r;for(;i&&i.parentNode&&i.parentNode!==e.dom;)i=i.parentNode;return i}const Mr=new _.PluginKey("dragHandle");function qo({pluginKey:e=Mr,element:r,editor:i,tippyOptions:n,onNodeChange:s}){const o=document.createElement("div");let c=null,d=!1,l=null,h=-1;return r.addEventListener("dragstart",u=>{const{view:x}=i;if(!u.dataTransfer)return;const{empty:m,$from:f,$to:w}=x.state.selection,p=Wo(u,i),g=jt(f,w,0),H=g.some(A=>p.find(v=>v.$from===A.$from&&v.$to===A.$to)),N=m||!H?p:g;if(N.length===0)return;const{tr:C}=x.state,b=document.createElement("div"),k=N[0].$from.pos,P=N[N.length-1].$to.pos,I=ie.create(x.state.doc,k,P),y=I.content();N.forEach(A=>{const v=Vo(x.nodeDOM(A.$from.pos));b.append(v)}),b.style.position="absolute",b.style.top="-10000px",document.body.append(b),u.dataTransfer.clearData(),u.dataTransfer.setDragImage(b,0,0),x.dragging={slice:y,move:!0},C.setSelection(I),x.dispatch(C),document.addEventListener("drop",()=>Ot(b),{once:!0}),setTimeout(()=>{r&&(r.style.pointerEvents="none")},0)}),r.addEventListener("dragend",()=>{r&&(r.style.pointerEvents="auto")}),new _.Plugin({key:typeof e=="string"?new _.PluginKey(e):e,state:{init:()=>({locked:!1}),apply(u,x){const m=u.getMeta("lockDragHandle"),f=u.getMeta("hideDragHandle");if(m!==void 0&&(d=m),f&&c)return c.hide(),d=!1,l=null,h=-1,s==null||s({editor:i,node:null,pos:-1}),x;if(u.docChanged&&h!==-1&&r&&c){const w=u.mapping.map(h);w!==h&&(h=w)}return x}},view:u=>{return x(),m(i.view.dom),c=qt(u.dom,{...f(),...n}),{update(b,k){if(!w(r,c)||(r.draggable=!d,!p(b,k)))return;const P=g(b);P&&H(b,P)},destroy(){C()}};function x(){r.draggable=!0,r.style.pointerEvents="auto"}function m(b){var k;(k=b.parentElement)==null||k.appendChild(o),o.appendChild(r),Object.assign(o.style,{pointerEvents:"none",position:"absolute",top:"0",left:"0"})}function f(){return{getReferenceClientRect:null,interactive:!0,trigger:"manual",placement:"left-start",hideOnClick:!1,duration:100,zIndex:10,appendTo:o,content:r,popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",options:{rootBoundary:"document",mainAxis:!1}}]}}}function w(b,k){return b&&k}function p(b,k){return!b.state.doc.eq(k.doc)&&h!==-1}function g(b){let k=b.nodeDOM(h);return k=$t(b,k),k===b.dom||(k==null?void 0:k.nodeType)!==1?null:k}function H(b,k){const P=b.posAtDOM(k,0),I=Bt(i.state.doc,P);if(I===l)return;const y=Dt(i.state.doc,P);l=I,h=y,s==null||s({editor:i,node:l,pos:h}),N(k)}function N(b){c.setProps({getReferenceClientRect:()=>b.getBoundingClientRect()}),c.show()}function C(){c==null||c.destroy(),r&&Ot(o)}},props:{handleDOMEvents:{mouseleave:(u,x)=>{if(d||!m(x))return!1;return f(),w(),!1;function m(p){return p.target&&!o.contains(p.relatedTarget)}function f(){c==null||c.hide()}function w(){l=null,h=-1,s==null||s({editor:i,node:null,pos:-1})}},mousemove:_.debounce((u,x)=>{if(!r||!c||d)return!1;const m=Sr({x:x.clientX,y:x.clientY,direction:"right",editor:i});if(!m.resultElement||m.resultElement===u.dom)return!1;const f=$t(u,m.resultElement);if(f===u.dom||(f==null?void 0:f.nodeType)!==1)return!1;const w=u.posAtDOM(f,0),p=Bt(i.state.doc,w);if(p===l)return!1;const g=Dt(i.state.doc,w);return l=p,h=g,s==null||s({editor:i,node:l,pos:h}),c.setProps({getReferenceClientRect:()=>f.getBoundingClientRect()}),c.show(),!1},100)}}})}function Go(e){var y,A,v;const{pluginKey:r=Mr}=e,{t:i}=S.useLocale(),[n,s]=a.useState(null),[o,c]=a.useState(-1),d=a.useRef(null),l=a.useRef(null),[h,u]=a.useState(!1),x=e.editor.extensionManager.extensions.some(T=>T.name==="textAlign"),m=e.editor.extensionManager.extensions.some(T=>T.name==="indent"),f=e.editor.extensionManager.extensions.some(T=>T.name==="clear");a.useEffect(()=>{d.current&&!e.editor.isDestroyed&&(l.current=qo({editor:e.editor,element:d.current,pluginKey:"ContentItemMenu",tippyOptions:{offset:[-2,16],zIndex:99,moveTransition:"transform 0.15s ease-out"},onNodeChange:k}),e.editor.registerPlugin(l.current))},[e.editor,d]);function w(){const T=e.editor.chain();T.setNodeSelection(o).unsetAllMarks(),(n==null?void 0:n.type.name)!=="paragraph"&&T.setParagraph(),T.run()}function p(){e.editor.chain().focus().setNodeSelection(o).run(),document.execCommand("copy")}function g(){e.editor.commands.setNodeSelection(o);const{$anchor:T}=e.editor.state.selection,B=T.node(1)||e.editor.state.selection.node;e.editor.chain().setMeta("hideDragHandle",!0).insertContentAt(o+((n==null?void 0:n.nodeSize)||0),B.toJSON()).run()}function H(T){e.editor.commands.setTextAlign(T)}function N(){const T=nt(e.editor.state.tr,o,1);T.setMeta("hideDragHandle",!0),e.editor.view.dispatch&&e.editor.view.dispatch(T)}function C(){const T=nt(e.editor.state.tr,o,-1);e.editor.view.dispatch&&e.editor.view.dispatch(T)}function b(){e.editor.chain().setMeta("hideDragHandle",!0).setNodeSelection(o).deleteSelection().run()}function k(T){T.node&&s(T.node),c(T.pos)}function P(){var T;if(o!==-1){const B=(n==null?void 0:n.nodeSize)||0,D=o+B,z=(n==null?void 0:n.type.name)==="paragraph"&&((T=n==null?void 0:n.content)==null?void 0:T.size)===0,M=z?o+2:D+2;e.editor.chain().command(({dispatch:$,tr:F,state:X})=>$?(z?F.insertText("/",o,o+1):F.insert(D,X.schema.nodes.paragraph.create(null,[X.schema.text("/")])),$(F)):!0).focus(M).run()}}a.useEffect(()=>(h?e.editor.commands.setMeta("lockDragHandle",!0):e.editor.commands.setMeta("lockDragHandle",!1),()=>{e.editor.commands.setMeta("lockDragHandle",!1)}),[h]),a.useEffect(()=>()=>{l.current&&(e.editor.unregisterPlugin(r),l.current=null)},[]),a.useEffect(()=>{var T;(T=e.editor)!=null&&T.isDestroyed&&l.current&&(e.editor.unregisterPlugin(r),l.current=null)},[(y=e.editor)==null?void 0:y.isDestroyed]);const I=T=>{e!=null&&e.disabled||u(T)};return t.jsx("div",{ref:d,className:`drag-handle richtext-duration-200 richtext-ease-in-out [transition-property:top,_left] ${e==null?void 0:e.className}`,style:{opacity:e!=null&&e.disabled?0:1},children:t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-gap-0.5 richtext-duration-200 richtext-ease-in-out [transition-property:top,_left]",children:[t.jsx(q,{className:"!richtext-size-7 richtext-cursor-grab",disabled:e==null?void 0:e.disabled,onClick:P,size:"icon",type:"button",variant:"ghost",children:t.jsx(U,{className:"richtext-text-lg richtext-text-neutral-600 dark:richtext-text-neutral-200",name:"Plus"})}),t.jsxs(rr,{onOpenChange:I,open:h,children:[t.jsxs("div",{className:"richtext-relative richtext-flex richtext-flex-col",children:[t.jsxs(ft,{children:[t.jsx(gt,{asChild:!0,disabled:e==null?void 0:e.disabled,children:t.jsx(q,{className:"richtext-relative richtext-z-[1] !richtext-size-7 richtext-cursor-grab",disabled:e==null?void 0:e.disabled,size:"icon",type:"button",variant:"ghost",onMouseUp:T=>{T.preventDefault(),!(e!=null&&e.disabled)&&u(!0)},children:t.jsx(U,{className:"richtext-text-sm richtext-text-neutral-600 dark:richtext-text-neutral-200",name:"Grip"})})}),t.jsx(Ue,{children:i("editor.draghandle.tooltip")})]}),t.jsx(ir,{className:"richtext-absolute richtext-left-0 richtext-top-0 richtext-z-0 richtext-size-[28px]"})]}),t.jsxs(dt,{align:"start",className:"richtext-w-48",side:"bottom",sideOffset:0,children:[t.jsxs(re,{className:"richtext-flex richtext-gap-3 richtext-bg-opacity-10 hover:richtext-bg-red-400 hover:richtext-bg-opacity-20 focus:richtext-bg-red-400 focus:richtext-bg-opacity-30 focus:richtext-text-red-500 dark:hover:richtext-bg-opacity-20 dark:hover:richtext-text-red-500",onClick:b,children:[t.jsx(U,{name:"Trash2"}),t.jsx("span",{children:i("editor.remove")})]}),f?t.jsxs(re,{className:"richtext-flex richtext-gap-3",onClick:w,children:[t.jsx(U,{name:"PaintRoller"}),t.jsx("span",{children:i("editor.clear.tooltip")})]}):null,t.jsxs(re,{className:"richtext-flex richtext-gap-3",onClick:p,children:[t.jsx(U,{name:"Clipboard"}),t.jsx("span",{children:i("editor.copyToClipboard")})]}),t.jsxs(re,{className:"richtext-flex richtext-gap-3",onClick:g,children:[t.jsx(U,{name:"Copy"}),t.jsx("span",{children:i("editor.copy")})]}),x||m?t.jsx(ht,{}):null,x?t.jsxs(At,{children:[t.jsxs(rt,{className:"richtext-flex richtext-gap-3",children:[t.jsx(U,{name:"AlignCenter"}),t.jsx("span",{children:i("editor.textalign.tooltip")})]}),t.jsx(kt,{children:t.jsxs(it,{children:[t.jsxs(re,{className:"richtext-flex richtext-gap-3",onClick:()=>H("left"),children:[t.jsx(U,{name:"AlignLeft"}),t.jsx("span",{children:i("editor.textalign.left.tooltip")})]}),t.jsxs(re,{className:"richtext-flex richtext-gap-3",onClick:()=>H("center"),children:[t.jsx(U,{name:"AlignCenter"}),t.jsx("span",{children:i("editor.textalign.center.tooltip")})]}),t.jsxs(re,{className:"richtext-flex richtext-gap-3",onClick:()=>H("right"),children:[t.jsx(U,{name:"AlignRight"}),t.jsx("span",{children:i("editor.textalign.right.tooltip")})]})]})})]}):null,m?t.jsxs(At,{children:[t.jsxs(rt,{className:"richtext-flex richtext-gap-3",children:[t.jsx(U,{name:"IndentIncrease"}),t.jsx("span",{children:i("editor.indent")})]}),t.jsx(kt,{children:t.jsxs(it,{children:[t.jsxs(re,{className:"richtext-flex richtext-gap-3",disabled:((A=n==null?void 0:n.attrs)==null?void 0:A.indent)>=Fe.max,onClick:N,children:[t.jsx(U,{name:"IndentIncrease"}),t.jsx("span",{children:i("editor.indent.tooltip")})]}),t.jsxs(re,{className:"richtext-flex richtext-gap-3",disabled:((v=n==null?void 0:n.attrs)==null?void 0:v.indent)<=Fe.min,onClick:C,children:[t.jsx(U,{name:"IndentDecrease"}),t.jsx("span",{children:i("editor.outdent.tooltip")})]})]})})]}):null]})]})]})})}const Uo={maxWidth:"auto",zIndex:20,appendTo:"parent",moveTransition:"transform 0.1s ease-out"};function Xo({item:e,disabled:r,editor:i}){var s;const n=e.component;return n?t.jsx(n,{...e.componentProps,disabled:r||((s=e==null?void 0:e.componentProps)==null?void 0:s.disabled),editor:i}):t.jsx(t.Fragment,{})}function Zo(e){const{t:r,lang:i}=S.useLocale(),n=({editor:o})=>{const{selection:c}=o.view.state,{$from:d,to:l}=c;return d.pos===l?!1:c instanceof _.TextSelection},s=a.useMemo(()=>e.disabled||!(e!=null&&e.editor)?[]:$o(e.editor,r),[e.disabled,e.editor,i,r]);return t.jsx(R.BubbleMenu,{editor:e==null?void 0:e.editor,shouldShow:n,tippyOptions:Uo,children:s!=null&&s.length?t.jsx("div",{className:"richtext-pointer-events-auto richtext-w-auto richtext-select-none richtext-rounded-sm !richtext-border richtext-border-neutral-200 richtext-bg-background richtext-px-3 richtext-py-2 richtext-shadow-sm richtext-transition-all dark:richtext-border-neutral-800",children:t.jsx("div",{className:"richtext-relative richtext-flex richtext-h-[26px] richtext-flex-nowrap richtext-items-center richtext-justify-start richtext-gap-[4px] richtext-whitespace-nowrap",children:s==null?void 0:s.map((o,c)=>(o==null?void 0:o.type)==="divider"?t.jsx(Y,{className:"!richtext-mx-1 !richtext-my-2 !richtext-h-[16px]",orientation:"vertical"},`bubbleMenu-divider-${c}`):t.jsx(Xo,{disabled:e.disabled,editor:e.editor,item:o},`bubbleMenu-text-${c}`))})}):t.jsx(t.Fragment,{})})}function Ko({editor:e,disabled:r,actions:i}){var g,H,N,C,b,k,P,I,y,A,v,T,B,D,z,M,$,F;const n=({editor:X})=>R.isActive(X.view.state,"table"),{t:s}=S.useLocale();function o(){e.chain().focus().addColumnBefore().run()}function c(){e.chain().focus().addColumnAfter().run()}function d(){e.chain().focus().deleteColumn().run()}function l(){e.chain().focus().addRowBefore().run()}function h(){e.chain().focus().addRowAfter().run()}function u(){e.chain().focus().deleteRow().run()}function x(){e.chain().focus().mergeCells().run()}function m(){e==null||e.chain().focus().splitCell().run()}function f(){e.chain().focus().deleteTable().run()}function w(X){e.chain().focus().setTableCellBackground(X).run()}const p=()=>{var Mt;const{view:X,state:{selection:{from:te}}}=e,ge=X.domAtPos(te).node;if(!ge)return new DOMRect(-1e3,-1e3,0,0);const St=(Mt=ge==null?void 0:ge.closest)==null?void 0:Mt.call(ge,".tableWrapper");return St?St.getBoundingClientRect():new DOMRect(-1e3,-1e3,0,0)};return t.jsx(R.BubbleMenu,{editor:e,pluginKey:"table",shouldShow:n,updateDelay:0,tippyOptions:{offset:[0,8],popperOptions:{modifiers:[{name:"flip",enabled:!1}]},maxWidth:"auto",getReferenceClientRect:p,plugins:[qt.sticky],sticky:"popper"},children:r?t.jsx(t.Fragment,{}):t.jsxs("div",{className:"richtext-flex richtext-size-full richtext-min-w-32 richtext-flex-row richtext-items-center richtext-gap-0.5 richtext-rounded-lg !richtext-border richtext-border-border richtext-bg-background richtext-p-2 richtext-leading-none richtext-shadow-sm",children:[t.jsx(O,{action:o,disabled:!((H=(g=e==null?void 0:e.can())==null?void 0:g.addColumnBefore)!=null&&H.call(g)),icon:"BetweenHorizonalEnd",tooltip:s("editor.table.menu.insertColumnBefore"),"tooltip-options":{sideOffset:15}}),t.jsx(O,{action:c,disabled:!((C=(N=e==null?void 0:e.can())==null?void 0:N.addColumnAfter)!=null&&C.call(N)),icon:"BetweenHorizonalStart",tooltip:s("editor.table.menu.insertColumnAfter"),"tooltip-options":{sideOffset:15}}),t.jsx(O,{action:d,disabled:!((k=e==null?void 0:(b=e.can()).deleteColumn)!=null&&k.call(b)),icon:"DeleteColumn",tooltip:s("editor.table.menu.deleteColumn"),"tooltip-options":{sideOffset:15}}),t.jsx(Y,{className:"!richtext-mx-1 !richtext-my-2 !richtext-h-[16px]",orientation:"vertical"}),t.jsx(O,{action:l,disabled:!((I=e==null?void 0:(P=e.can()).addRowBefore)!=null&&I.call(P)),icon:"BetweenVerticalEnd",tooltip:s("editor.table.menu.insertRowAbove"),"tooltip-options":{sideOffset:15}}),t.jsx(O,{action:h,disabled:!((A=(y=e==null?void 0:e.can())==null?void 0:y.addRowAfter)!=null&&A.call(y)),icon:"BetweenVerticalStart",tooltip:s("editor.table.menu.insertRowBelow"),"tooltip-options":{sideOffset:15}}),t.jsx(O,{action:u,disabled:!((T=(v=e==null?void 0:e.can())==null?void 0:v.deleteRow)!=null&&T.call(v)),icon:"DeleteRow",tooltip:s("editor.table.menu.deleteRow"),"tooltip-options":{sideOffset:15}}),t.jsx(Y,{className:"!richtext-mx-1 !richtext-my-2 !richtext-h-[16px]",orientation:"vertical"}),t.jsx(O,{action:x,disabled:!((D=(B=e==null?void 0:e.can())==null?void 0:B.mergeCells)!=null&&D.call(B)),icon:"TableCellsMerge",tooltip:s("editor.table.menu.mergeCells"),"tooltip-options":{sideOffset:15}}),t.jsx(O,{action:m,disabled:!((M=(z=e==null?void 0:e.can())==null?void 0:z.splitCell)!=null&&M.call(z)),icon:"TableCellsSplit",tooltip:s("editor.table.menu.splitCells"),"tooltip-options":{sideOffset:15}}),t.jsx(Y,{className:"!richtext-mx-1 !richtext-my-2 !richtext-h-[16px]",orientation:"vertical"}),t.jsx(pr,{action:w,editor:e,tooltip:s("editor.table.menu.setCellsBgColor"),tooltipOptions:{sideOffset:15}}),t.jsx(O,{action:f,disabled:!((F=($=e==null?void 0:e.can())==null?void 0:$.deleteTable)!=null&&F.call($)),icon:"Trash2",tooltip:s("editor.table.menu.deleteTable"),"tooltip-options":{sideOffset:15}}),i&&i.map((X,te)=>t.jsx(O,{...X},te))]})})}function Yo(e){const{t:r}=S.useLocale();return t.jsxs("div",{className:"richtext-flex richtext-items-center richtext-gap-2 richtext-p-2 richtext-bg-white !richtext-border richtext-rounded-lg richtext-shadow-sm dark:richtext-bg-black richtext-border-neutral-200 dark:richtext-border-neutral-800",children:[t.jsx("a",{href:e==null?void 0:e.link,target:"_blank",rel:"noopener noreferrer",className:"richtext-text-sm richtext-underline richtext-break-all",children:_.truncate(e==null?void 0:e.link,{length:50,omission:"…"})}),(e==null?void 0:e.link)&&t.jsx(Y,{orientation:"vertical",className:"!richtext-h-4"}),t.jsxs("div",{className:"richtext-flex richtext-flex-nowrap",children:[t.jsx(O,{icon:"Pencil",tooltip:r("editor.link.edit.tooltip"),action:()=>{e==null||e.onEdit()},tooltipOptions:{sideOffset:15}}),t.jsx(O,{icon:"Unlink",tooltip:r("editor.link.unlink.tooltip"),action:()=>{e==null||e.onClear()},tooltipOptions:{sideOffset:15}})]})]})}function Jo({editor:e,disabled:r}){const[i,n]=a.useState(!1),s=a.useMemo(()=>{const{href:l}=e.getAttributes("link");return l},[e]),o=a.useCallback(({editor:l})=>l.isActive("link"),[]),c=(l,h,u)=>{e.chain().extendMarkRange("link").insertContent({type:"text",text:h,marks:[{type:"link",attrs:{href:l,target:u?"_blank":""}}]}).setLink({href:l}).focus().run(),n(!1)},d=a.useCallback(()=>{e.chain().extendMarkRange("link").unsetLink().focus().run(),n(!1)},[e]);return t.jsx(t.Fragment,{children:t.jsx(R.BubbleMenu,{editor:e,shouldShow:o,tippyOptions:{popperOptions:{modifiers:[{name:"flip",enabled:!1}]},placement:"bottom-start",offset:[-2,16],zIndex:9999,onHidden:()=>{n(!1)}},children:r?t.jsx(t.Fragment,{}):t.jsx(t.Fragment,{children:i?t.jsx(wr,{onSetLink:c,editor:e}):t.jsx(Yo,{editor:e,onClear:d,onEdit:()=>{n(!0)},link:s})})})})}const yt={maxWidth:"auto",zIndex:20,appendTo:"parent",moveTransition:"transform 0.1s ease-out"};function Tt({item:e,disabled:r,editor:i}){var s;const n=e.component;return n?t.jsx(a.Fragment,{children:e.type==="divider"?t.jsx(Y,{className:"!richtext-mx-1 !richtext-my-2 !richtext-h-[16px]",orientation:"vertical"}):t.jsx(n,{...e.componentProps,disabled:r||((s=e==null?void 0:e.componentProps)==null?void 0:s.disabled),editor:i})}):t.jsx(t.Fragment,{})}function Qo(e){return e.type.name===we.name}function es(e){return e.type.name===bt.name}function ts(e){return e.type.name===vt.name}function rs(e){const{lang:r}=S.useLocale(),i=({editor:s})=>{const{selection:o}=s.view.state,{$from:c,to:d}=o;let l=!1;return s.view.state.doc.nodesBetween(c.pos,d,h=>{if(Qo(h))return l=!0,!1}),l},n=a.useMemo(()=>e.disabled?[]:_o(e.editor),[e.disabled,e.editor,r]);return t.jsx(t.Fragment,{children:t.jsx(R.BubbleMenu,{editor:e==null?void 0:e.editor,shouldShow:i,tippyOptions:yt,children:n!=null&&n.length?t.jsx("div",{className:"richtext-pointer-events-auto richtext-w-auto richtext-select-none richtext-rounded-sm !richtext-border richtext-border-neutral-200 richtext-bg-background richtext-px-3 richtext-py-2 richtext-shadow-sm richtext-transition-all dark:richtext-border-neutral-800",children:t.jsx("div",{className:"richtext-relative richtext-flex richtext-h-[26px] richtext-flex-nowrap richtext-items-center richtext-justify-start richtext-whitespace-nowrap",children:n==null?void 0:n.map((s,o)=>t.jsx(Tt,{disabled:e.disabled,editor:e.editor,item:s},`bubbleMenu-image-${o}`))})}):t.jsx(t.Fragment,{})})})}function is(e){const{lang:r}=S.useLocale(),i=({editor:s})=>{const{selection:o}=s.view.state,{$from:c,to:d}=o;let l=!1;return s.view.state.doc.nodesBetween(c.pos,d,h=>{if(es(h))return l=!0,!1}),l},n=a.useMemo(()=>e.disabled?[]:Ho(e.editor),[e.disabled,e.editor,r]);return t.jsx(t.Fragment,{children:t.jsx(R.BubbleMenu,{editor:e==null?void 0:e.editor,shouldShow:i,tippyOptions:yt,children:n!=null&&n.length?t.jsx("div",{className:"richtext-pointer-events-auto richtext-w-auto richtext-select-none richtext-rounded-sm !richtext-border richtext-border-neutral-200 richtext-bg-background richtext-px-3 richtext-py-2 richtext-shadow-sm richtext-transition-all dark:richtext-border-neutral-800",children:t.jsx("div",{className:"richtext-relative richtext-flex richtext-h-[26px] richtext-flex-nowrap richtext-items-center richtext-justify-start richtext-whitespace-nowrap",children:n==null?void 0:n.map((s,o)=>t.jsx(Tt,{disabled:e.disabled,editor:e.editor,item:s},`bubbleMenu-image-gif-${o}`))})}):t.jsx(t.Fragment,{})})})}function ns(e){const{lang:r}=S.useLocale(),i=({editor:s})=>{const{selection:o}=s.view.state,{$from:c,to:d}=o;let l=!1;return s.view.state.doc.nodesBetween(c.pos,d,h=>{if(ts(h))return l=!0,!1}),l},n=a.useMemo(()=>e.disabled?[]:Bo(e.editor),[e.editor,e.disabled,r]);return t.jsx(t.Fragment,{children:t.jsx(R.BubbleMenu,{editor:e==null?void 0:e.editor,shouldShow:i,tippyOptions:yt,children:n!=null&&n.length?t.jsx("div",{className:"richtext-pointer-events-auto richtext-w-auto richtext-select-none richtext-rounded-sm !richtext-border richtext-border-neutral-200 richtext-bg-background richtext-px-3 richtext-py-2 richtext-shadow-sm richtext-transition-all dark:richtext-border-neutral-800",children:t.jsx("div",{className:"richtext-relative richtext-flex richtext-h-[26px] richtext-flex-nowrap richtext-items-center richtext-justify-start richtext-whitespace-nowrap",children:n==null?void 0:n.map((s,o)=>t.jsx(Tt,{disabled:e.disabled,editor:e.editor,item:s},`bubbleMenu-video-${o}`))})}):t.jsx(t.Fragment,{})})})}function os({editor:e}){const{t:r}=S.useLocale(),i=a.useCallback(()=>e.isActive(Se.name),[e]),n=a.useCallback(()=>ke(Se.name,e),[e]),s=a.useCallback(()=>e.chain().focus().addColBefore().run(),[e]),o=a.useCallback(()=>e.chain().focus().addColAfter().run(),[e]),c=a.useCallback(()=>e.chain().focus().deleteCol().run(),[e]);return t.jsx(R.BubbleMenu,{pluginKey:"columns-bubble-menu",editor:e,shouldShow:i,tippyOptions:{popperOptions:{modifiers:[{name:"flip",enabled:!1}]},placement:"bottom-start",offset:[-2,16],zIndex:9999},children:t.jsxs("div",{className:"richtext-w-auto richtext-px-3 richtext-py-2 richtext-transition-all !richtext-border richtext-rounded-sm richtext-shadow-sm richtext-pointer-events-auto richtext-select-none richtext-border-neutral-200 dark:richtext-border-neutral-800 richtext-bg-background",children:[t.jsx(O,{action:s,icon:"ColumnAddLeft",tooltip:r("editor.table.menu.insertColumnBefore")}),t.jsx(O,{action:o,icon:"ColumnAddRight",tooltip:r("editor.table.menu.insertColumnAfter")}),t.jsx(O,{action:c,icon:"DeleteColumn",tooltip:r("editor.table.menu.deleteColumn")}),t.jsx(O,{action:n,icon:"Trash2",tooltip:r("editor.table.menu.delete_column")})]})})}function ss({editor:e,extensions:r}){const{t:i}=S.useLocale(),n=a.useMemo(()=>{var s,o,c;return(c=(o=(s=r==null?void 0:r.find(d=>d.name==="base-kit"))==null?void 0:s.options)==null?void 0:o.characterCount)==null?void 0:c.limit},[r]);return n?t.jsx("div",{className:"richtext-flex richtext-items-center richtext-justify-between richtext-p-3 richtext-border-t",children:t.jsx("div",{className:"richtext-flex richtext-flex-col",children:t.jsx("div",{className:"richtext-flex richtext-justify-end richtext-gap-3 richtext-text-sm",children:t.jsxs("span",{children:[e.storage.characterCount.characters(),"/",n," ",i("editor.characters")]})})})}):t.jsx("div",{className:"richtext-flex richtext-items-center richtext-justify-between richtext-p-3 richtext-border-t",children:t.jsx("div",{className:"richtext-flex richtext-flex-col",children:t.jsx("div",{className:"richtext-flex richtext-justify-end richtext-gap-3 richtext-text-sm",children:t.jsxs("span",{children:[e.storage.characterCount.characters()," ",i("editor.characters")]})})})})}function cs(){const{toasts:e}=ur();return t.jsxs(si,{children:[e.map(({id:r,title:i,description:n,action:s,...o})=>t.jsxs(ar,{...o,children:[t.jsxs("div",{className:"richtext-grid richtext-gap-1",children:[i&&t.jsx(dr,{children:i}),n&&t.jsx(hr,{children:n})]}),s,t.jsx(lr,{})]},r)),t.jsx(cr,{})]})}const as=`
.reactjs-tiptap-editor, 
.richtext-dialog-content {
  button,
  input:where([type=button]),
  input:where([type=reset]),
  input:where([type=submit]) {
    -webkit-appearance: button;
    background-color: transparent;
    background-image: none;
  }

  input,
  optgroup,
  select,
  textarea {
    font-family: inherit;
    font-feature-settings: inherit;
    font-variation-settings: inherit;
    font-size: 100%;
    font-weight: inherit;
    line-height: inherit;
    letter-spacing: inherit;
    color: inherit;
  }

  button {
    font-family: inherit;
    font-feature-settings: inherit;
    font-variation-settings: inherit;
    font-size: 100%;
    font-weight: inherit;
    line-height: inherit;
    letter-spacing: inherit;
    color: inherit;
  }

  *,
  ::before,
  ::after {
    box-sizing: border-box;
    border-width: 0;
    border-style: solid;
    border-color: hsl(var(--richtext-border));
  }

  background-color: hsl(var(--richtext-background));
  color: hsl(var(--richtext-foreground));

  hr {
    height: 0;
    color: inherit;
    border-top-width: 1px;
  }

  a {
    color: inherit;
    text-decoration: inherit;
  }

  b,
  strong {
    font-weight: bolder;
  }

  code,
  kbd,
  samp,
  pre {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;
    font-feature-settings: normal;
    font-variation-settings: normal;
    font-size: 1em;
  }

  table {
    text-indent: 0;
    border-color: inherit;
    border-collapse: collapse;
  }

  input, textarea {
    border-width: 1px;
  }

  textarea {
    resize: vertical;
  }

  input::placeholder,
  textarea::placeholder {
    opacity: 1;
    color: #9ca3af;
  }

  button, input, textarea {
    cursor: pointer;
    color: inherit;
  }

  img,
  svg,
  video,
  canvas,
  audio,
  iframe,
  embed,
  object {
    display: block;
    vertical-align: middle;
  }

  img,
  video {
    max-width: 100%;
    height: auto;
  }
}

div[data-radix-popper-content-wrapper],
div[data-tippy-root] {
  *,
  ::before,
  ::after {
    box-sizing: border-box;
    border-width: 0;
    border-style: solid;
    border-color: hsl(var(--richtext-border));
  }

  background-color: hsl(var(--richtext-background));
  color: hsl(var(--richtext-foreground));

  button, input, textarea {
    cursor: pointer;
    color: inherit;
  }
}
`,ls=a.memo(({children:e,id:r})=>{const[,i]=Yt(c=>c.value),[,n]=Jt(c=>c.value),s=c=>{i({value:c.detail})},o=c=>{n({value:c.detail})};return a.useEffect(()=>{const c=ye(se.EDIT(r),s),d=ye(se.UPDATE_THEME(r),o);return()=>{c(),d()}},[]),t.jsx(t.Fragment,{children:e})});function ds({children:e,id:r}){return t.jsx(Xr,{children:t.jsx(Zr,{children:t.jsx(ls,{id:r,children:e})})})}const Vt="data-rc-order",Ft="data-rc-priority",hs="rc-util-key",at=new Map;function us(e,r){if(!e)return!1;if(e.contains)return e.contains(r);let i=r;for(;i;){if(i===e)return!0;i=i.parentNode}return!1}function kr({mark:e}={}){return e?e.startsWith("data-")?e:`data-${e}`:hs}function Nt(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function xs(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function Ar(e){return[...(at.get(e)||e).children].filter(r=>r.tagName==="STYLE")}function Ir(e,r={}){const{csp:i,prepend:n,priority:s=0}=r,o=xs(n),c=o==="prependQueue",d=document.createElement("style");d.setAttribute(Vt,o),c&&s&&d.setAttribute(Ft,`${s}`),i!=null&&i.nonce&&(d.nonce=i==null?void 0:i.nonce),d.innerHTML=e;const l=Nt(r),{firstChild:h}=l;if(n){if(c){const u=Ar(l).filter(x=>{if(!["prepend","prependQueue"].includes(x.getAttribute(Vt)))return!1;const m=Number(x.getAttribute(Ft)||0);return s>=m});if(u.length>0)return l.insertBefore(d,u.at(-1).nextSibling),d}h.before(d)}else l.append(d);return d}function Lr(e,r={}){const i=Nt(r);return Ar(i).find(n=>n.getAttribute(kr(r))===e)}function ms(e,r={}){const i=Lr(e,r);i&&i.remove()}function fs(e,r){const i=at.get(e);if(!i||!us(document,i)){const n=Ir("",r),{parentNode:s}=n;at.set(e,s),n.remove()}}function gs(e,r,i={}){var c,d,l;const n=Nt(i);fs(n,i);const s=Lr(r,i);if(s)return(c=i.csp)!=null&&c.nonce&&s.nonce!==((d=i.csp)==null?void 0:d.nonce)&&(s.nonce=(l=i.csp)==null?void 0:l.nonce),s.innerHTML!==e&&(s.innerHTML=e),s;const o=Ir(e,i);return o.setAttribute(kr(i),r),o}function ps(e,r){const{content:i,extensions:n,useEditorOptions:s={}}=e,o=a.useId(),c=a.useMemo(()=>{const x=_.differenceBy(n,n,"name");return[...n.map(f=>{const w=n.find(p=>p.name===f.name);return w?f.configure(w.options):f}),...x].map((f,w)=>f.configure({sort:w}))},[n]),d=_.throttle(x=>{var f;const m=h(x,e.output);(f=e==null?void 0:e.onChangeContent)==null||f.call(e,m)},S.EDITOR_UPDATE_WATCH_THROTTLE_WAIT_TIME),l=R.useEditor({extensions:c,content:i,onUpdate:({editor:x})=>{d&&d(x)},...s});a.useImperativeHandle(r,()=>({editor:l})),a.useEffect(()=>{document.documentElement.classList.toggle("dark",e.dark),fn.setTheme(o,e.dark?"dark":"light")},[e.dark]),a.useEffect(()=>{l==null||l.setEditable(!(e!=null&&e.disabled)),Kr.setDisable(o,!(e!=null&&e.disabled))},[l,e==null?void 0:e.disabled]),a.useEffect(()=>((e==null?void 0:e.resetCSS)!==!1&&gs(as,"react-tiptap-reset"),()=>{ms("react-tiptap-reset")}),[e==null?void 0:e.resetCSS]);function h(x,m){return e!=null&&e.removeDefaultWrapper?m==="html"?x.isEmpty?"":x.getHTML():m==="json"?x.isEmpty?{}:x.getJSON():m==="text"?x.isEmpty?"":x.getText():"":m==="html"?x.getHTML():m==="json"?x.getJSON():m==="text"?x.getText():""}a.useLayoutEffect(()=>{l&&(l.id=o)},[o,l]),a.useEffect(()=>()=>{var x;(x=l==null?void 0:l.destroy)==null||x.call(l)},[]);const u=tr(l,"characterCount");return l?t.jsxs("div",{className:"reactjs-tiptap-editor",children:[t.jsx(ds,{id:o,children:t.jsx(di,{delayDuration:0,disableHoverableContent:!0,children:t.jsx("div",{className:"richtext-overflow-hidden richtext-rounded-[0.5rem] richtext-bg-background richtext-shadow richtext-outline richtext-outline-1",children:t.jsxs("div",{className:"richtext-flex richtext-max-h-full richtext-w-full richtext-flex-col",children:[!(e!=null&&e.hideToolbar)&&t.jsx(ko,{disabled:!!(e!=null&&e.disabled),editor:l,toolbar:e.toolbar}),t.jsx(R.EditorContent,{className:`richtext-relative ${(e==null?void 0:e.contentClass)||""}`,editor:l}),u&&t.jsx(ss,{editor:l,extensions:n}),!(e!=null&&e.hideBubble)&&t.jsx(So,{bubbleMenu:e==null?void 0:e.bubbleMenu,disabled:e==null?void 0:e.disabled,editor:l})]})})})}),t.jsx(cs,{})]}):t.jsx(t.Fragment,{})}const ws=a.forwardRef(ps);exports.ActionButton=O;exports.Button=q;exports.ColorPicker=Nr;exports.Column=wt;exports.Drawer=ct;exports.DropdownMenu=rr;exports.DropdownMenuCheckboxItem=nr;exports.DropdownMenuContent=dt;exports.DropdownMenuSeparator=ht;exports.DropdownMenuShortcut=or;exports.DropdownMenuTrigger=ir;exports.EVENTS=se;exports.ExportPdf=fr;exports.ExportWord=gr;exports.HighlightActionButton=pr;exports.IconComponent=U;exports.Iframe=de;exports.Image=we;exports.ImageGif=bt;exports.IndentProps=Fe;exports.Input=Z;exports.Katex=he;exports.Label=ee;exports.LinkEditBlock=wr;exports.MenuDown=mr;exports.Mermaid=ot;exports.MultiColumn=Se;exports.Popover=xe;exports.PopoverContent=ce;exports.PopoverTrigger=me;exports.RichTextEditor=ws;exports.Switch=ut;exports.Toggle=mt;exports.Tooltip=ft;exports.TooltipContent=Ue;exports.TooltipTrigger=gt;exports.Twitter=We;exports.Video=vt;exports.actionDialogImage=vr;exports.cn=L;exports.createIndentCommand=$i;exports.deleteNode=ke;exports.dispatchEvent=Ge;exports.ensureNameValueOptions=ti;exports.extractFileExtension=qi;exports.extractFilename=Wi;exports.getDatasetAttribute=$e;exports.getShortcutKey=Zt;exports.getShortcutKeys=Kt;exports.hasExtension=tr;exports.icons=pt;exports.listenEvent=ye;exports.normalizeFileSize=Gi;exports.normalizeFileType=Ui;exports.useEditableEditor=Qt;exports.useToast=ur;
